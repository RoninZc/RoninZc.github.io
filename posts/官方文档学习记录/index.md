# Rustå®˜æ–¹æ–‡æ¡£å­¦ä¹ è®°å½•


## å¸¸ç”¨å‘½ä»¤

* rustc

  &gt; rustc xxx.rs // ç¼–è¯‘Rustç¨‹åº

* cargo

  &gt; cargo build // ç¼–è¯‘Rusté¡¹ç›®ï¼Œå¦‚blockåœ¨æ›´æ–°lockæ–‡ä»¶ï¼Œå¯æ‰§è¡Œ ```rm -rf ~/.cargo/.package-cache```
  &gt;
  &gt; cargo run // ç«‹åˆ»è¿è¡ŒRusté¡¹ç›®
  &gt;
  &gt; cargo doc --open // ç”Ÿæˆå¹¶æ‰“å¼€é¡¹ç›®æ–‡æ¡£

## å¸¸è§æ¦‚å¿µ

### å˜é‡å’Œå¯å˜æ€§

* ä½¿ç”¨`let xxx` å£°æ˜Žä¸€ä¸ªå˜é‡ï¼Œæ­¤æ—¶è¿™ä¸ªå˜é‡æ˜¯ä¸å¯å˜çš„ï¼Œä½†æ˜¯å¯ä»¥è¢«**éšè—**
* ä½¿ç”¨`let mut xxx` å£°æ˜Žä¸€ä¸ªå¯å˜å˜é‡ï¼Œæ­¤æ—¶å˜é‡å¯ä»¥è¢«é‡æ–°èµ‹å€¼
* ä½¿ç”¨`const XXX`å£°æ˜Žä¸€ä¸ªå¸¸é‡ï¼Œå¸¸é‡ä¸å¯è¢«é‡æ–°èµ‹å€¼

#### éšè—

â€‹ é‡å¤ä½¿ç”¨`let`å®šä¹‰ä¸€ä¸ªä¸Žä¹‹å‰å˜é‡åŒåçš„å˜é‡ï¼Œæˆ‘ä»¬ç§°ç¬¬ä¸€ä¸ªå˜é‡è¢«ç¬¬äºŒä¸ªå˜é‡éšè—äº†ï¼Œæ­¤æ—¶ä½¿ç”¨è¯¥åç§°çš„å˜é‡ä¼šä½¿ç”¨ç¬¬äºŒä¸ªå˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥é‡å¤ä½¿ç”¨`let`æ¥å¤šæ¬¡éšè—ã€‚

```rust
fn main() {
  let x = 5;
  let x = x &#43; 1;
  {
    let x = x * 2;
    println!(&#34;block inner x:{}&#34;, x);
  }
  println!(&#34;block outer x:{}&#34;, x);
}
```

ä¸Šé¢ä¾‹å­ä¼šè¾“å‡ºï¼š

```tex
block inner x:12
block outer x:6
```

â€‹ è¿™ä¸ªç¨‹åºé¦–å…ˆå°† `x` ç»‘å®šåˆ°å€¼ `5` ä¸Šã€‚æŽ¥ç€é€šè¿‡ `let x =` éšè— `x`ï¼ŒèŽ·å–åˆå§‹å€¼å¹¶åŠ  `1`ï¼Œè¿™æ · `x` çš„å€¼å°±å˜æˆ `6` äº†ã€‚ç„¶åŽï¼Œåœ¨å†…éƒ¨ä½œç”¨åŸŸå†…ï¼Œç¬¬ä¸‰ä¸ª `let` è¯­å¥ä¹Ÿéšè—äº† `x`ï¼Œå°†ä¹‹å‰çš„å€¼ä¹˜ä»¥ `2`ï¼Œ`x` å¾—åˆ°çš„å€¼æ˜¯ `12`ã€‚å½“è¯¥ä½œç”¨åŸŸç»“æŸæ—¶ï¼Œå†…éƒ¨ shadowing çš„ä½œç”¨åŸŸä¹Ÿç»“æŸäº†ï¼Œ`x` åˆè¿”å›žåˆ° `6`ã€‚

### æ•°æ®ç±»åž‹

#### æ ‡é‡ç±»åž‹

##### æ•´åž‹

|  é•¿åº¦   |  æœ‰ç¬¦å·   |  æ— ç¬¦å·  |
| :-----: | :-------: | :------: |
|  8-bit  | ```i8```  | ```u8``` |
| 16-bit  | ```i16``` | ```u16``` |
| 32-bit  | ```i32``` | ```u32``` |
| 64-bit  | ```i64```  | ```u64``` |
| 128-bit | ```i128```  | ```u128``` |
|  arch   | ```isize```  | ```usize``` |

##### æµ®ç‚¹åž‹

â€‹ Rust çš„æµ®ç‚¹æ•°ç±»åž‹æ˜¯ `f32` å’Œ `f64`ï¼Œåˆ†åˆ«å  32 ä½å’Œ 64 ä½ã€‚é»˜è®¤ç±»åž‹æ˜¯ `f64`

##### å¸ƒå°”åž‹

â€‹ Rust ä¸­çš„å¸ƒå°”ç±»åž‹æœ‰ä¸¤ä¸ªå¯èƒ½çš„å€¼ï¼š`true` å’Œ `false`ã€‚Rust ä¸­çš„å¸ƒå°”ç±»åž‹ä½¿ç”¨ `bool` è¡¨ç¤ºã€‚

##### å­—ç¬¦åž‹

â€‹ Rust çš„ `char` ç±»åž‹çš„å¤§å°ä¸ºå››ä¸ªå­—èŠ‚(four bytes)ï¼Œå¹¶ä»£è¡¨äº†ä¸€ä¸ª Unicode æ ‡é‡å€¼ï¼ˆæ„å‘³ç€ä½ å¯ä»¥ä½¿ç”¨emojiï¼‰ã€‚

#### å¤åˆç±»åž‹

##### å…ƒç»„ç±»åž‹

ç›¸å½“äºŽæŠŠä¸€ä¸ªæˆ–è€…å¤šä¸ªç±»åž‹çš„å€¼ç»„åˆæˆä¸€ä¸ªç±»åž‹ã€‚å…ƒç»„çš„é•¿åº¦æ˜¯å›ºå®šçš„ï¼šä¸€æ—¦å£°æ˜Žã€‚å…¶é•¿åº¦ä¸ä¼šæ”¹å˜ã€‚

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨åœ†æ‹¬å·ä¸­é€—å·åˆ†å‰²çš„å€¼åˆ—è¡¨æ¥åˆ›å»ºä¸€ä¸ªå…ƒç»„ã€‚

```rust
fn main() {
  let one: (i32, f64, u8) = (500, 6.4 ,1);
  let one = (500, 6.4 ,1);
}
```

åŒæ—¶å¯ä»¥å¯¹å…ƒç»„è¿›è¡Œè§£æž„ï¼Œæˆ–è€…åªç”¨ç‚¹å·ï¼ˆ`.`ï¼‰è·Ÿç€å€¼çš„ç´¢å¼•ï¼ˆä»Ž0å¼€å§‹ï¼‰ç›´æŽ¥è®¿é—®

```rust
fn main() {
  let one = (500, 6.4 ,1);
  let (x, y, z) = one;
  println(&#34;x:{} y:{} z:{}&#34;,x, y, z);
  println(&#34;x:{} y:{} z:{}&#34;,one.0, one.1, one.2);
}
```

##### æ•°ç»„ç±»åž‹

å¦ä¸€ä¸ªåŒ…å«å¤šä¸ªå€¼çš„æ–¹å¼æ˜¯ **æ•°ç»„**ï¼ˆ*array*ï¼‰ã€‚ä¸Žå…ƒç»„ä¸åŒï¼Œæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ çš„ç±»åž‹å¿…é¡»ç›¸åŒã€‚Rust ä¸­çš„æ•°ç»„ä¸Žä¸€äº›å…¶ä»–è¯­è¨€ä¸­çš„æ•°ç»„ä¸åŒï¼Œå› ä¸º Rust ä¸­çš„æ•°ç»„æ˜¯å›ºå®šé•¿åº¦çš„ï¼šä¸€æ—¦å£°æ˜Žï¼Œå®ƒä»¬çš„é•¿åº¦ä¸èƒ½å¢žé•¿æˆ–ç¼©å°ã€‚

å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä¸¤ç§æ–¹å¼æ¥å£°æ˜Žæ•°ç»„ï¼š

```rust
fn main() {
  let a = [1, 2, 3, 4, 5];
  // å½“ä½ æƒ³å®šä¹‰ç±»åž‹æˆ–è€…é•¿åº¦æ—¶å¯ä½¿ç”¨ä¸‹é¢è¿™ç§æ–¹å¼
  // åœ¨æ–¹æ‹¬å·ä¸­åŒ…å«æ¯ä¸ªå…ƒç´ çš„ç±»åž‹ï¼ŒåŽè·Ÿåˆ†å·ï¼Œå†åŽè·Ÿæ•°ç»„å…ƒç´ çš„æ•°é‡
  let a: [i64; 5] = [1, 2, 3, 4, 5];
}
```

### å‡½æ•°

Rust ä¸­çš„å‡½æ•°å®šä¹‰ä»¥ `fn` å¼€å§‹å¹¶åœ¨å‡½æ•°ååŽè·Ÿä¸€å¯¹åœ†æ‹¬å·ã€‚å¤§æ‹¬å·å‘Šè¯‰ç¼–è¯‘å™¨å“ªé‡Œæ˜¯å‡½æ•°ä½“çš„å¼€å§‹å’Œç»“å°¾ã€‚

åœ¨å‡½æ•°ç­¾åä¸­ï¼Œ**å¿…é¡»** å£°æ˜Žæ¯ä¸ªå‚æ•°çš„ç±»åž‹ã€‚è¿™æ˜¯ Rust è®¾è®¡ä¸­ä¸€ä¸ªç»è¿‡æ…Žé‡è€ƒè™‘çš„å†³å®šï¼šè¦æ±‚åœ¨å‡½æ•°å®šä¹‰ä¸­æä¾›ç±»åž‹æ³¨è§£ï¼Œæ„å‘³ç€ç¼–è¯‘å™¨ä¸éœ€è¦ä½ åœ¨ä»£ç çš„å…¶ä»–åœ°æ–¹æ³¨æ˜Žç±»åž‹æ¥æŒ‡å‡ºä½ çš„æ„å›¾ã€‚åœ¨æœ‰å¤šä¸ªå‚æ•°æ—¶ï¼Œä½¿ç”¨`,`æ¥åˆ†å‰²å¤šä¸ªå‚æ•°ã€‚

å‡½æ•°å¯ä»¥å‘è°ƒç”¨å®ƒçš„ä»£ç è¿”å›žå€¼ã€‚ä½¿ç”¨ï¼ˆ`-&gt;`ï¼‰åŽå£°æ˜Žå®ƒçš„ç±»åž‹ã€‚åœ¨ Rust ä¸­ï¼Œå‡½æ•°çš„è¿”å›žå€¼ç­‰åŒäºŽå‡½æ•°ä½“æœ€åŽä¸€ä¸ªè¡¨è¾¾å¼çš„å€¼ã€‚ä½¿ç”¨ `return` å…³é”®å­—å’ŒæŒ‡å®šå€¼ï¼Œå¯ä»Žå‡½æ•°ä¸­æå‰è¿”å›žï¼›ä½†å¤§éƒ¨åˆ†å‡½æ•°éšå¼çš„è¿”å›žæœ€åŽçš„è¡¨è¾¾å¼ã€‚

```rust
fn five() -&gt; i32 {
    5
}

fn four() -&gt; i32 {
  let a = 4;
  return a;
}

fn main() {
    let x = five();

    println!(&#34;The value of x is: {}&#34;, x);
}
```

#### è¯­å¥å’Œè¡¨è¾¾å¼

Rustæ˜¯ä¸€é—¨åŸºäºŽè¡¨è¾¾å¼ï¼ˆexpression-basedï¼‰çš„è¯­è¨€ã€‚

ä½¿ç”¨`let`å…³é”®å­—åˆ›å»ºå˜é‡å¹¶ç»‘å®šä¸€ä¸ªå€¼æ˜¯ä¸€ä¸ªè¯­å¥ï¼ˆ`let y = 6;`ï¼‰ã€‚

**è¯­å¥ä¸è¿”å›žå€¼**ã€‚ä¸èƒ½æŠŠ`let`è¯­å¥èµ‹å€¼ç»™å¦å¤–ä¸€ä¸ªå˜é‡ï¼ˆ`let x = (let y = 6)`ï¼‰ã€‚

è¡¨è¾¾å¼å¯ä»¥è®¡ç®—å‡ºä¸€ä¸ªå€¼ï¼Œè€ƒè™‘ä¸€ä¸ªæ•°å­¦è¿ç®—ï¼Œæ¯”å¦‚`5&#43;6`ï¼Œè¿™æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼å¹¶è®¡ç®—å‡ºå€¼`11`ã€‚è¡¨è¾¾å¼å¯ä»¥æ˜¯è¯­å¥çš„ä¸€éƒ¨åˆ†ã€‚å‡½æ•°è°ƒç”¨æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ã€‚å®è°ƒç”¨æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ã€‚æˆ‘ä»¬ç”¨æ¥åˆ›å»ºæ–°ä½œç”¨äºŽçš„å¤§æ‹¬å·ï¼ˆä»£ç å—ï¼‰ï¼Œ`{}`ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ã€‚

```rust
fn main() {
  let x = 5;
  let y = {
    let x = 3;
    x &#43; 1
  }
  println!(&#34;x:{} y:{}&#34;)
}
```

è¿™ä¸ªè¡¨è¾¾å¼ï¼š

```rust
{
    let x = 3;
    x &#43; 1
}
```

æ˜¯ä¸€ä¸ªä»£ç å—ï¼Œå®ƒçš„å€¼æ˜¯ `4`ã€‚è¿™ä¸ªå€¼ä½œä¸º `let` è¯­å¥çš„ä¸€éƒ¨åˆ†è¢«ç»‘å®šåˆ° `y` ä¸Šã€‚æ³¨æ„ç»“å°¾æ²¡æœ‰åˆ†å·çš„é‚£ä¸€è¡Œ `x&#43;1`ï¼Œä¸Žä½ è§è¿‡çš„å¤§éƒ¨åˆ†ä»£ç è¡Œä¸åŒã€‚è¡¨è¾¾å¼çš„ç»“å°¾æ²¡æœ‰åˆ†å·ã€‚å¦‚æžœåœ¨è¡¨è¾¾å¼çš„ç»“å°¾åŠ ä¸Šåˆ†å·ï¼Œå®ƒå°±å˜æˆäº†è¯­å¥ï¼Œè€Œè¯­å¥ä¸ä¼šè¿”å›žå€¼ã€‚åœ¨æŽ¥ä¸‹æ¥æŽ¢ç´¢å…·æœ‰è¿”å›žå€¼çš„å‡½æ•°å’Œè¡¨è¾¾å¼æ—¶è¦è°¨è®°è¿™ä¸€ç‚¹ã€‚

### æŽ§åˆ¶æµ

#### ifè¡¨è¾¾å¼

`if` è¡¨è¾¾å¼å…è®¸æ ¹æ®æ¡ä»¶æ‰§è¡Œä¸åŒçš„ä»£ç åˆ†æ”¯ã€‚ä½ æä¾›ä¸€ä¸ªæ¡ä»¶å¹¶è¡¨ç¤º â€œå¦‚æžœæ¡ä»¶æ»¡è¶³ï¼Œè¿è¡Œè¿™æ®µä»£ç ï¼›å¦‚æžœæ¡ä»¶ä¸æ»¡è¶³ï¼Œä¸è¿è¡Œè¿™æ®µä»£ç ã€‚â€

```rust
fn main() {
  let number = 3;
  if number &lt; 5 {
    // xxx
  } else {
    // yyy
  }
}
```

ä»£ç ä¸­çš„æ¡ä»¶**å¿…é¡»**æ˜¯`bool`å€¼ã€‚å¦‚æžœä¸æ˜¯`bool`å€¼ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ä¸ªé”™è¯¯ã€‚

å› ä¸º`if`æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨`let`è¯­å¥çš„å³ä¾§ä½¿ç”¨å®ƒã€‚æ³¨æ„ï¼Œ`if`å’Œ`else`åˆ†æ”¯çš„ç»“æžœéƒ½å¿…é¡»æ˜¯**ç›¸åŒ**ç±»åž‹

```rust
fn main() {
  let conditioin = true;
  let number = if condition {
    5
  } else {
    6
  };
  println!(&#34;number:{}&#34;, number);
}
```

### å¾ªçŽ¯

Rust ä¸­æœ‰ä¸‰ç§å¾ªçŽ¯ï¼š`loop`ã€`while`å’Œ`for`ã€‚

#### loopè¡¨è¾¾å¼

`loop`å°±æ˜¯ä¸€ä¸ªæ— é™å¾ªçŽ¯ï¼Œéœ€è¦æ˜¾å¼çš„è°ƒç”¨`break`æ¥é€€å‡ºè¿™ä¸ªå¾ªçŽ¯ã€‚

å¦‚æžœå­˜åœ¨åµŒå¥—å¾ªçŽ¯ï¼Œæ­¤æ—¶å•ç‹¬åªç”¨`break` å’Œ `continue`åªåº”ç”¨äºŽæ­¤æ—¶è¯­å¥æœ€å†…å±‚çš„å¾ªçŽ¯ã€‚å¯ä»¥åœ¨å¾ªçŽ¯ä¸ŠæŒ‡å®šä¸€ä¸ª**å¾ªçŽ¯æ ‡ç­¾**ï¼Œç„¶åŽå°†æ ‡ç­¾ä¸Ž`break` å’Œ `continue`ä¸€èµ·ä½¿ç”¨ï¼Œæ­¤æ—¶è¿™äº›å…³é”®å­—ç”Ÿæ•ˆçš„åˆ™æ˜¯å·²æ ‡è®°çš„å¾ªçŽ¯ã€‚

```rust
fn main() {
  let mut count = 0;
  &#39;counting_up: loop {
    let mut remaining = 10;
    
    loop {
   println!(&#34;remaining = {}&#34;, remaining);
      if remaining == 9 {
    break;
      }
      if count == 2 {
        break &#39;counting_up;
      }
      remaining -= 1;
    }
    count &#43;= 1;
  }
  println!(&#34;End count = {}&#34;, count);
}
```

`loop`çš„å¦å¤–ä¸€ä¸ªç”¨æ³•æ˜¯é‡è¯•å¯èƒ½ä¼šå¤±è´¥çš„æ“ä½œï¼Œæ¯”å¦‚æ£€æŸ¥çº¿ç¨‹æ˜¯å¦å®Œæˆäº†ä»»åŠ¡ã€‚å¦‚æžœå°†è¿”å›žå€¼åŠ å…¥ä½ ç”¨æ¥åœæ­¢å¾ªçŽ¯çš„`break`è¡¨è¾¾å¼ï¼Œå®ƒä¼šè¢«åœæ­¢çš„å¾ªçŽ¯è¿”å›žã€‚

```rust
fn main() {
    let mut counter = 0;

    let result = loop {
        counter &#43;= 1;

        if counter == 10 {
            break counter * 2;
        }
    };

    println!(&#34;The result is {}&#34;, result);
}
```

#### whileæ¡ä»¶å¾ªçŽ¯

å½“æ¡ä»¶ä¸ºçœŸï¼Œæ‰§è¡Œå¾ªçŽ¯ã€‚å½“æ¡ä»¶ä¸å†ä¸ºçœŸï¼Œåˆ™åœæ­¢å¾ªçŽ¯ã€‚è¿™ä¸ªå¾ªçŽ¯ç±»åž‹å¯ä»¥é€šè¿‡ç»„åˆ `loop`ã€`if`ã€`else` å’Œ `break` æ¥å®žçŽ°ã€‚æˆ–è€…ç›´æŽ¥ä½¿ç”¨`while`ã€‚

```rust
fn main() {
    let mut number = 3;

    while number != 0 {
        println!(&#34;{}!&#34;, number);

        number = number - 1;
    }

    println!(&#34;LIFTOFF!!!&#34;);
}
```

#### foréåŽ†é›†åˆ

å¯ä»¥ä½¿ç”¨ `for` å¾ªçŽ¯æ¥å¯¹ä¸€ä¸ªé›†åˆçš„æ¯ä¸ªå…ƒç´ æ‰§è¡Œä¸€äº›ä»£ç ã€‚

```rust
fn main() {
    let a = [10, 20, 30, 40, 50];

    for element in a.iter() {
        println!(&#34;the value is: {}&#34;, element);
    }
}
```

Rustçš„å¾ªçŽ¯ä¸åƒâ€œCé£Žæ ¼â€çš„å¾ªçŽ¯

```c
for (x = 0; x &lt; 10; x&#43;&#43;) {
  printf(&#34;%d\n&#34;, x);
}
```

ç›¸åï¼ŒRustæ˜¯è¿™æ ·çš„

```rust
for x in 0..10 {
  println!(&#34;{}&#34;, x);
}
// å½“ä½ éœ€è¦ x &lt;= 10 è¿™ç§ç±»åž‹çš„æ—¶å€™
for x in 0..=10 {
  println!(&#34;{}&#34;, x);
}
```

å½“ä½ éœ€è¦çŸ¥é“å½“å‰å·²ç»å¾ªçŽ¯å¤šå°‘æ¬¡æ—¶ï¼Œå¯ä»¥ä½¿ç”¨`.enumerate()`å‡½æ•°

```rust
for (i,j) in (5..10).enumerate() {
    println!(&#34;i = {} and j = {}&#34;, i, j);
}
```

è¾“å‡ºï¼š

&gt; ```text
&gt; i = 0 and j = 5
&gt; i = 1 and j = 6
&gt; i = 2 and j = 7
&gt; i = 3 and j = 8
&gt; i = 4 and j = 9
&gt; ```

### æ‰€æœ‰æƒ

é¦–å…ˆï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹æ‰€æœ‰æƒçš„è§„åˆ™ã€‚å½“æˆ‘ä»¬é€šè¿‡ä¸¾ä¾‹è¯´æ˜Žæ—¶ï¼Œè¯·è°¨è®°è¿™äº›è§„åˆ™ï¼š

&gt; 1. Rust ä¸­çš„æ¯ä¸€ä¸ªå€¼éƒ½æœ‰ä¸€ä¸ªè¢«ç§°ä¸ºå…¶ **æ‰€æœ‰è€…**ï¼ˆ*owner*ï¼‰çš„å˜é‡ã€‚
&gt; 2. å€¼åœ¨ä»»ä¸€æ—¶åˆ»æœ‰ä¸”åªæœ‰ä¸€ä¸ªæ‰€æœ‰è€…ã€‚
&gt; 3. å½“æ‰€æœ‰è€…ï¼ˆå˜é‡ï¼‰ç¦»å¼€ä½œç”¨åŸŸï¼Œè¿™ä¸ªå€¼å°†è¢«ä¸¢å¼ƒã€‚

#### å˜é‡ä½œç”¨åŸŸ

å˜é‡ `s` ç»‘å®šåˆ°äº†ä¸€ä¸ªå­—ç¬¦ä¸²å­—é¢å€¼ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²å€¼æ˜¯ç¡¬ç¼–ç è¿›ç¨‹åºä»£ç ä¸­çš„ã€‚è¿™ä¸ªå˜é‡ä»Žå£°æ˜Žçš„ç‚¹å¼€å§‹ç›´åˆ°å½“å‰ **ä½œç”¨åŸŸ** ç»“æŸæ—¶éƒ½æ˜¯æœ‰æ•ˆçš„ã€‚ç¤ºä¾‹ 4-1 çš„æ³¨é‡Šæ ‡æ˜Žäº†å˜é‡ `s` åœ¨ä½•å¤„æ˜¯æœ‰æ•ˆçš„ã€‚

```rust
{                      // s åœ¨è¿™é‡Œæ— æ•ˆ, å®ƒå°šæœªå£°æ˜Ž
    let s = &#34;hello&#34;;   // ä»Žæ­¤å¤„èµ·ï¼Œs æ˜¯æœ‰æ•ˆçš„

    // ä½¿ç”¨ s
}                      // æ­¤ä½œç”¨åŸŸå·²ç»“æŸï¼Œs ä¸å†æœ‰æ•ˆ
```

#### å†…å­˜ä¸Žåˆ†é…

é¦–å…ˆæˆ‘ä»¬è¦çŸ¥é“å˜é‡çš„ä¸¤ç§å†…å­˜åˆ†é…ä½ç½®ï¼š`å †`å’Œ`æ ˆ`ã€‚è¿™ä¸ªæ¦‚å¿µå†æ­¤ä¸åšèµ˜è¿°ã€‚

å½“æˆ‘ä»¬å£°æ˜Žä¸€ä¸ªå˜é‡çš„ç±»åž‹ï¼Œå®ƒçš„å†…å­˜åˆ†é…åœ¨**å †**ä¸Šï¼Œæˆ‘è¿™ä¹ æƒ¯å°†å…¶æˆä¸º**å¼•ç”¨ç±»åž‹**ï¼Œå¦‚æžœå®ƒçš„å†…å­˜åˆ†é…åœ¨**æ ˆ**ä¸Šï¼Œåˆ™ç§°ä¸º**å€¼ç±»åž‹**ã€‚

å€¼ç±»åž‹ï¼Œå¦‚`i32`ã€`f64`ã€‚å¼•ç”¨ç±»åž‹ï¼Œå¦‚`string`ï¼š

```rust
fn main() {
  let x = 1;// i32 å€¼ç±»åž‹
  let str = String::from(&#34;hello world!&#34;);// string å¼•ç”¨ç±»åž‹
}
```

å€¼ç±»åž‹çš„ä¼ é€’æ–¹å¼éƒ½æ˜¯copy

```rust
fn main() {
  let x = 1;
  let y = x;
}
```

æ­¤æ—¶ `x`ã€`y`éƒ½åœ¨æ ˆä¸Šæ‹¥æœ‰å±žäºŽè‡ªå·±çš„å†…å­˜ç©ºé—´ã€‚

è€Œå¼•ç”¨ç±»åž‹çš„ä¼ é€’æ–¹å¼åˆ™ä¸ä¸€æ ·ã€‚

```rust
fn main() {
  let x = String::from(&#34;hello world!&#34;);// x èŽ·å¾— string çš„æ‰€æœ‰æƒ
  let y = x;// string çš„æ‰€æœ‰æƒäº¤ç»™äº† y
  // æ­¤æ—¶ x ä¸Ž y çš„åœ°å€å…±åŒæŒ‡å‘å †çš„åŒä¸€ä¸ªåœ°æ–¹
  // æˆ‘ä»¬åªæ‹·è´äº†å…¶é•¿åº¦å’Œå®¹é‡ä¿¡æ¯ï¼Œå…¶åœ¨å †ä¸Šçš„æŒ‡é’ˆæ˜¯ç›¸åŒçš„
  // å¦‚æžœæƒ³æ‹·è´å…¶åœ¨å †ä¸Šçš„æ•°æ®
  let z = y.clone();// z clone äº†ä¸€ä¸ª yï¼Œæ²¡æœ‰èŽ·å¾— string çš„æ‰€æœ‰æƒ
  // æ­¤æ—¶åˆ™æ˜¯ z ä¸Ž y æ˜¯åœ°å€å®Œå…¨ä¸åŒçš„ä¸¤ä¸ªå˜é‡
  // å¦‚æžœæˆ‘ä»¬åœ¨è¿™ä½¿ç”¨ let z = x.clone() åˆ™å¯¹å¾—åˆ°ä¸€ä¸ªé”™è¯¯ï¼Œå› ä¸ºRustç¦æ­¢ä½ ä½¿ç”¨æ— æ•ˆçš„å¼•ç”¨
}
```

é‚£å¦‚æžœæ˜¯åœ¨å‡½æ•°é‡Œå‘¢ï¼Ÿ

```rust
fn main() {
  let str = String::from(&#34;hello world!&#34;);// str è¿›å…¥ä½œç”¨åŸŸ
  
  test_one(str);// str æ‰€æœ‰æƒç§»åŠ¨åˆ°å‡½æ•°å†…
  // strå†æ­¤ä¸åœ¨æœ‰æ•ˆ
  
  let x = 12;// x è¿›å…¥ä½œç”¨åŸŸ
  
  test_two(x);// x copy è¿›å…¥å‡½æ•°å†…
  // x æ˜¯copyçš„,æ‰€ä»¥ x åœ¨æ­¤ä¾ç„¶æœ‰æ•ˆ
}// xç§»é™¤ä½œç”¨åŸŸã€‚ str æ‰€æœ‰æƒå·²ç»ç§»äº¤ï¼Œä¸åšæ“ä½œ

fn test_one(some_string: String) {// some_string è¿›å…¥ä½œç”¨åŸŸ
  println!(&#34;{}&#34;, some_string);
}// some_string ç¦»å¼€ä½œç”¨åŸŸï¼Œè°ƒç”¨ `drop` æ–¹æ³•é‡Šæ”¾å†…å­˜

fn test_two(some_integer: i32) {// some_integer è¿›å…¥ä½œç”¨åŸŸ
  println!(&#34;{}&#34;, some_integer);
}// some_integer ç¦»å¼€ä½œç”¨åŸŸï¼Œä¸ä¼šæœ‰ç‰¹æ®Šæ“ä½œ

```

å‡½æ•°çš„è¿”å›žå€¼ä¹Ÿå¯ä»¥è½¬ç§»æ‰€æœ‰æƒã€‚

### å¼•ç”¨ä¸Žå€Ÿç”¨

è§„åˆ™

* åœ¨ä»»æ„ç»™å®šæ—¶é—´ï¼Œ**è¦ä¹ˆ** åªèƒ½æœ‰ä¸€ä¸ªå¯å˜å¼•ç”¨ï¼Œ**è¦ä¹ˆ** åªèƒ½æœ‰å¤šä¸ªä¸å¯å˜å¼•ç”¨ã€‚
* å¼•ç”¨å¿…é¡»æ€»æ˜¯æœ‰æ•ˆçš„ã€‚

å¦‚æžœæˆ‘ä»¬åªæ˜¯æƒ³ä½¿ç”¨ä¸€ä¸ªå˜é‡ï¼Œè€Œä¸æ˜¯èŽ·å–è¿™ä¸ªå˜é‡çš„æ‰€æœ‰æƒã€‚æˆ‘ä»¬åˆ™éœ€è¦ä½¿ç”¨å¼•ç”¨è¿™ä¸ªæ“ä½œã€‚

```rust
fn main() {
    let s1 = String::from(&#34;hello&#34;);

    let len = calculate_length(&amp;s1);

    println!(&#34;The length of &#39;{}&#39; is {}.&#34;, s1, len);
}

fn calculate_length(s: &amp;String) -&gt; usize {
    s.len()
}
```

æˆ‘ä»¬åœ¨è¿™é‡ŒèŽ·å¾—çš„æ˜¯`s1`çš„å¼•ç”¨ï¼Œå¹¶æ²¡æœ‰èŽ·å–`s1`çš„æ‰€æœ‰æƒã€‚æ‰€ä»¥ä¸Šè¿°ä»£ç å¯ä»¥æ­£å¸¸çš„è¿è¡Œã€‚

ä½¿ç”¨çš„`&amp;`ç¬¦å·å°±æ˜¯**å¼•ç”¨**ï¼Œå®ƒå…è®¸ä½ ä½¿ç”¨å€¼ä½†ä¸èŽ·å–å…¶æ‰€æœ‰æƒã€‚å°±åƒå…¶ä»–è¯­è¨€ç±»ä¼¼ï¼ŒèŽ·å–ä¸€ä¸ªå˜é‡çš„åœ°å€ï¼Œä¹Ÿå°±æ˜¯æŒ‡é’ˆã€‚

å› ä¸ºæ²¡æœ‰èŽ·å–åˆ°æ‰€æœ‰æƒï¼Œæ‰€ä»¥å½“å¼•ç”¨ç¦»å¼€ä½œç”¨åŸŸæ—¶ï¼Œä¸ä¼šå°†å†…å­˜é‡Šæ”¾ã€‚ä½†æ˜¯è¿™é‡Œçš„å¼•ç”¨åªèƒ½ä½¿ç”¨è¢«å¼•ç”¨çš„å˜é‡ï¼Œå½“æˆ‘ä»¬æƒ³ä¿®æ”¹è¿™ä¸ªå˜é‡æ—¶ï¼Œåˆ™ä¼šå‘çŽ°ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚æ­£å¦‚å˜é‡é»˜è®¤ä¸å¯å˜ä¸€æ ·ï¼Œå¼•ç”¨é»˜è®¤ä¹Ÿæ˜¯ä¸å¯æ”¹å˜çš„ã€‚

```rust
fn main() {
    let s = String::from(&#34;hello&#34;);

    change(&amp;s);
}

fn change(some_string: &amp;String) {
    some_string.push_str(&#34;, world&#34;);
}

error[E0596]: cannot borrow immutable borrowed content `*some_string` as mutable
 --&gt; error.rs:8:5
  |
7 | fn change(some_string: &amp;String) {
  |                        ------- use `&amp;mut String` here to make mutable
8 |     some_string.push_str(&#34;, world&#34;);
  |     ^^^^^^^^^^^ cannot borrow as mutable
```

å¦‚æžœæˆ‘ä»¬æƒ³ä¿®æ”¹ä¸€ä¸ªå¼•ç”¨çš„å€¼ï¼Œæˆ‘ä»¬åªéœ€åšä¸€ä¸ªå°è°ƒæ•´ï¼š

```rust
fn main() {
    let mut s = String::from(&#34;hello&#34;);

    change(&amp;mut s);
}

fn change(some_string: &amp;mut String) {
    some_string.push_str(&#34;, world&#34;);
}

```

è¿™é‡Œä½¿ç”¨`&amp;mut`èŽ·å–åˆ°çš„æ˜¯ `s`çš„å¯å˜å¼•ç”¨ï¼Œè¿™å°±æ¸…é™¤çš„è¡¨æ˜Žï¼Œæˆ‘éœ€è¦ä¿®æ”¹è¿™ä¸ªå¼•ç”¨çš„å€¼ã€‚ä¸è¿‡å¯å˜å¼•ç”¨æœ‰ä¸€ä¸ªå¾ˆå¤§çš„é™åˆ¶ã€‚

&gt; **åœ¨åŒä¸€æ—¶é—´åªèƒ½æœ‰ä¸€ä¸ªå¯¹æŸä¸€ç‰¹å®šæ•°æ®çš„å¯å˜å¼•ç”¨**

è¿™ä¸ªé™åˆ¶çš„å¥½å¤„æ˜¯ Rust å¯ä»¥åœ¨ç¼–è¯‘æ—¶å°±é¿å…æ•°æ®ç«žäº‰ã€‚

ä¸å¯å˜å¼•ç”¨å¯ä»¥å­˜åœ¨å¤šä¸ªï¼Œä½†ä¸èƒ½åŒæ—¶ä¸Žå¯å˜å¼•ç”¨å­˜åœ¨ã€‚åŽŸå› ä¹Ÿå¾ˆæ˜Žæ˜¾ï¼Œè°ä¹Ÿä¸æƒ³è‡ªå·±å¼•ç”¨çš„å˜é‡åœ¨æŸä¸€æ—¶é—´è¢«ä¿®æ”¹ã€‚

è¿™ç§æ¦‚å¿µå’Œ**è¯»å†™é”**ç±»ä¼¼ã€‚å¯ä»¥æ‹¥æœ‰å¤šä¸ªè¯»é”ï¼ˆä¸å¯å˜å¼•ç”¨ï¼‰ï¼Œåªèƒ½å­˜åœ¨ä¸€ä¸ªå†™é”å¹¶ä¸Žè¯»é”äº’æ–¥ï¼ˆå¯å˜å¼•ç”¨ï¼‰ã€‚å½“äº†è§£è¿™ä¸ªæ¦‚å¿µä¹‹åŽå°±å¾ˆå¥½ç†è§£äº†ã€‚

æ³¨æ„ä¸€ä¸ªå¼•ç”¨çš„ä½œç”¨åŸŸä»Žå£°æ˜Žçš„åœ°æ–¹å¼€å§‹ä¸€ç›´æŒç»­åˆ°æœ€åŽä¸€æ¬¡ä½¿ç”¨ä¸ºæ­¢ã€‚ä¾‹å¦‚ä»¥ä¸‹ä»£ç æ˜¯å¯ä»¥ç¼–è¯‘çš„ï¼š

```rust
let mut s = String::from(&#34;hello&#34;);

let r1 = &amp;s; // æ²¡é—®é¢˜
let r2 = &amp;s; // æ²¡é—®é¢˜
println!(&#34;{} and {}&#34;, r1, r2);
// æ­¤ä½ç½®ä¹‹åŽ r1 å’Œ r2 ä¸å†ä½¿ç”¨ï¼Œä½œç”¨åŸŸä¹Ÿå†æ­¤ç»“æŸ

let r3 = &amp;mut s; // æ²¡é—®é¢˜ r1ï¼Œr2çš„ä½œç”¨åŸŸå·²ç»ç»“æŸ
println!(&#34;{}&#34;, r3);
```

ä¸å¯å˜å¼•ç”¨ `r1` å’Œ `r2` çš„ä½œç”¨åŸŸåœ¨ `println!` æœ€åŽä¸€æ¬¡ä½¿ç”¨ä¹‹åŽç»“æŸï¼Œè¿™ä¹Ÿæ˜¯åˆ›å»ºå¯å˜å¼•ç”¨ `r3` çš„åœ°æ–¹ã€‚å®ƒä»¬çš„ä½œç”¨åŸŸæ²¡æœ‰é‡å ï¼Œæ‰€ä»¥ä»£ç æ˜¯å¯ä»¥ç¼–è¯‘çš„ã€‚ç¼–è¯‘å™¨åœ¨ä½œç”¨åŸŸç»“æŸä¹‹å‰åˆ¤æ–­ä¸å†ä½¿ç”¨çš„å¼•ç”¨çš„èƒ½åŠ›è¢«ç§°ä¸ºéžè¯æ³•ä½œç”¨åŸŸç”Ÿå‘½å‘¨æœŸï¼ˆNon-Lexical Lifetimesï¼Œç®€ç§°NLLï¼‰ã€‚ä½ å¯ä»¥åœ¨ [The Edition Guide](https://doc.rust-lang.org/edition-guide/rust-2018/ownership-and-lifetimes/non-lexical-lifetimes.html) ä¸­é˜…è¯»æ›´å¤šå…³äºŽå®ƒçš„ä¿¡æ¯ã€‚

### ç»“æž„ä½“

å®šä¹‰ç»“æž„ä½“ï¼Œéœ€è¦ä½¿ç”¨ `struct` å…³é”®å­—å¹¶ä¸ºæ•´ä¸ªç»“æž„ä½“æä¾›ä¸€ä¸ªåå­—ã€‚ç»“æž„ä½“çš„åå­—éœ€è¦æè¿°å®ƒæ‰€ç»„åˆçš„æ•°æ®çš„æ„ä¹‰ã€‚æŽ¥ç€ï¼Œåœ¨å¤§æ‹¬å·ä¸­ï¼Œå®šä¹‰æ¯ä¸€éƒ¨åˆ†æ•°æ®çš„åå­—å’Œç±»åž‹ï¼Œæˆ‘ä»¬ç§°ä¸º **å­—æ®µ**ï¼ˆ*field*ï¼‰ã€‚ä¾‹å¦‚ï¼Œç¤ºä¾‹ 5-1 å±•ç¤ºäº†ä¸€ä¸ªå­˜å‚¨ç”¨æˆ·è´¦å·ä¿¡æ¯çš„ç»“æž„ä½“ï¼š

```rust
struct User {
    username: String,
    email: String,
    sign_in_count: u64,
    active: bool,
}
```

å½“å˜é‡åä¸Žå­—æ®µåç›¸åŒæ—¶ï¼Œå¯ä»¥ç®€å†™

```rust
fn build_user(email: String, username: String) -&gt; User {
    User {
        email,
        username,
        active: true,
        sign_in_count: 1,
    }
}
```

æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ç»“æž„ä½“æ›´æ–°è¯­æ³•

```rust
let user2 = User {
    email: String::from(&#34;another@example.com&#34;),
    ..user1
};
```

åœ¨è¿™é‡Œ`..user1`å¿…é¡»æ”¾åœ¨æœ€åŽï¼Œå…¶ä»–å­—æ®µå®žé™…æ˜¯ä½¿ç”¨`=`çš„èµ‹å€¼ï¼Œæ‰€ä»¥è¦æ³¨æ„æ‰€æœ‰æƒçš„ç§»åŠ¨ã€‚

æˆ‘ä»¬è¿˜å¯ä»¥åˆ›å»ºæ²¡æœ‰å­—æ®µçš„å…ƒç»„ç»“æž„ä½“ï¼Œä½¿ç”¨`.`æŽ¥ä¸Šç´¢å¼•æ¥è®¿é—®å•ç‹¬çš„å€¼ã€‚

```rust
struct Color(i32, i32, i32);
struct Point(i32, i32, i32);

let black = Color(0, 0, 0);
let origin = Point(0, 0, 0);
```

æˆ–è€…åˆ›å»ºä¸€ä¸ªæ²¡æœ‰ä»»ä½•å­—æ®µçš„ç»“æž„ä½“ï¼ˆç±»å•å…ƒç»“æž„ä½“ï¼‰

å•å…ƒç»“æž„ä½“å¸¸å¸¸åœ¨ä½ æƒ³è¦åœ¨æŸä¸ªç±»åž‹ä¸Šå®žçŽ° trait ä½†ä¸éœ€è¦åœ¨ç±»åž‹ä¸­å­˜å‚¨æ•°æ®çš„æ—¶å€™å‘æŒ¥ä½œç”¨ã€‚

```rust
struct AlwaysEqual;

let subject = AlwaysEqual;
```

todo å­—æ®µçš„ç”Ÿå‘½å‘¨æœŸ

#### æ‰“å°ç»“æž„ä½“

```rust
#[derive(Debug)]
struct Rectangle {
  width: u32,
  height: u32,
}

fn main() {
 let rect1 = Rectangle { width: 30, height: 50 };
  println!(&#34;{:#?}&#34;, rect1);
  println!(&#34;{:#?}&#34;, rect1);
  dbg!(&amp;rect1);
}
```

åˆ†åˆ«è¾“å‡ºï¼š

```tex
Rectangle {
    width: 30,
    height: 30,
}
Rectangle {
    width: 30,
    height: 30,
}
[src/main.rs:15] &amp;rect1 = Rectangle {
    width: 30,
    height: 30,
}
```

#### ç»™`struct`ç»‘å®šæ–¹æ³•

å®šä¹‰æ–¹æ³•

```rust
#[derive(Debug)]
struct Rectangle {
    width: u32,
    height: u32,
}

impl Rectangle {
    fn area(&amp;self) -&gt; u32 {
        self.width * self.height        
    }
}
fn main() {
    let rect1 = Rectangle {
        width: 30,
        height: 30,
    };
    println!(&#34;è¿™ä¸ªé•¿æ–¹ä½“çš„é¢ç§¯æ˜¯ï¼š{}&#34;, rect1.area());
}
```

ä¸ºäº†ä½¿å‡½æ•°å®šä¹‰åœ¨`Rectangle`çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ª`impl`å—ã€‚åœ¨è¿™ä¸ªå—ä¸­çš„æ‰€æœ‰å†…å®¹éƒ½ä¸Ž`Rectangle`ç›¸å…³è”ã€‚

åœ¨`area`çš„å‡½æ•°å‰é¢ä¸Šï¼Œä½¿ç”¨`&amp;self`æ¥ä»£æ›¿`rectangle: &amp;Rectangle`ï¼Œ`&amp;self`å…¶å®žæ˜¯`self: &amp;Self`çš„ç¼©å†™ã€‚åœ¨ä¸€ä¸ª`impl`å—ä¸­ï¼Œæ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»æœ‰ä¸€ä¸ªåä¸º`self`çš„`Self`ç±»åž‹çš„å‚æ•°ï¼Œæ‰€ä»¥Ruståœ¨è¿™é‡Œæä¾›äº†`self`è¿™ä¸ªåå­—æ¥ç¼©å†™ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨`&amp;`æ¥è¡¨ç¤ºåªæ˜¯å€Ÿç”¨è¿™ä¸ªç¤ºä¾‹ï¼Œå¹¶æ²¡æœ‰èŽ·å–æ‰€æœ‰æƒã€‚åŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿä¸€æ ·å¯ä»¥èŽ·å–æ‰€æœ‰æƒï¼Œæˆ–è€…å¯å˜å€Ÿç”¨ã€‚

&gt; é‚£æˆ‘ä»¬çš„`&amp;`è¿ç®—ç¬¦åŽ»å“ªé‡Œäº†å‘¢ï¼Ÿ
&gt;
&gt; `area()`å‡½æ•°çš„å‚æ•°æ˜¯`&amp;self`ï¼Œä½†æ˜¯æˆ‘ä»¬è°ƒç”¨çš„åœ°æ–¹å¹¶æ²¡æœ‰å€Ÿç”¨`rect1`ï¼›é‚£æ˜¯Rustæœ‰ä¸€ä¸ªå«åš**è‡ªåŠ¨å¼•ç”¨å’Œè§£å¼•ç”¨**çš„åŠŸèƒ½ã€‚æ–¹æ³•è°ƒç”¨æ˜¯Rustä¸­å°‘æ•°å‡ ä¸ªæ‹¥æœ‰è¿™ç§è¡Œä¸ºçš„åœ°æ–¹ã€‚
&gt;
&gt; è¿™æ ·æˆ‘ä»¬çš„ä»£ç å®žé™…æ˜¯è¿™æ ·å·¥ä½œçš„ï¼š
&gt;
&gt; ```rust
&gt; rect1.area();
&gt; (&amp;rect1).area();
&gt; ```
&gt;
&gt; è¿™æ ·çœ‹èµ·æ¥ç¬¬ä¸€ç§æ–¹å¼ç®€æ´çš„å¤šã€‚

#### å…³è”å‡½æ•°

æ‰€æœ‰åœ¨`impl`å—ä¸­å®šä¹‰çš„å‡½æ•°è¢«ç§°ä¸º**å…³è”å‡½æ•°**ã€‚æˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªä¸ä»¥`self`ä¸ºç¬¬ä¸€å‚æ•°çš„å…³è”å‡½æ•°ï¼ˆå®ƒä¸æ˜¯æ–¹æ³•ï¼‰ï¼Œæˆ‘ä»¬å·²ç»ä½¿ç”¨è¿‡è¿™æ ·çš„å‡½æ•°äº†ï¼Œ`String::from()`ã€‚é€šå¸¸è¿™æ ·çš„å‡½æ•°è¢«æˆ‘ä»¬ç”¨ä½œä¸ºè¿”å›žä¸€ä¸ªç»“æž„ä½“æ–°å®žä¾‹çš„æž„é€ å‡½æ•°ã€‚

```rust
impl Rectangle {
    fn square(size: u32) -&gt; Rectangle {
        Rectangle { width: size, height: size }
    }
}

fn main() {
  let sq = Rectangle::square(3);
}
```

### æžšä¸¾

åœ¨ Rust ä¸­æˆ‘ä»¬ä½¿ç”¨`enum`æ¥å®šä¹‰ä¸€ä¸ªæžšä¸¾ç±»åž‹ã€‚

```rust
enum IpAddrKind {
  V4,
  V6,
}
```

åœ¨ä¸Šè¿°ä»£ç ä¸­å®šä¹‰äº†ä¸€ä¸ª`IpAddrKind`æžšä¸¾æ¥åˆ—å‡ºå¯èƒ½çš„ IP åœ°å€ç±»åž‹ï¼Œ`V4`å’Œ`V6`ã€‚è¿™ä¸¤ç§ç±»åž‹è¢«ç§°ä¸ºæžšä¸¾çš„**æˆå‘˜**ã€‚

æˆ‘ä»¬å¯ä»¥åƒè¿™æ ·åˆ›å»º`IpAddrKind`ä¸¤ä¸ªä¸åŒæˆå‘˜çš„å®žä¾‹ã€‚

```rust
let four = IpAddrKind::V4;
let six = IpAddrKind::V6;

fn route(ip_type: IpAddrKind) {}

route(four);
route(six);
```

å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»»æ„æˆå‘˜æ¥è°ƒç”¨`route`å‡½æ•°ã€‚

æžšä¸¾çš„æˆå‘˜ä¹Ÿå¯ä»¥å…³è”ä¸€ä¸ªå€¼ã€‚

```rust
enum IpAddr {
  V4(String),
  V6(String),
}

let home =  IpAddr::V4(String::from(&#34;127.0.0.1&#34;));
let loopback =  IpAddr::V4(String::from(&#34;::1&#34;));
```

æˆ–è€…å…³è”ä¸Šä¸€ä¸ªå…ƒç»„ã€‚

```rust
enum IpAddr {
  V4(u8, u8, u8, u8),
  V6(String),
}

let home =  IpAddr::V4(127, 0, 0, 1);
let loopback =  IpAddr::V4(String::from(&#34;::1&#34;));
```

æˆ‘ä»¬è¿˜å¯ä»¥å¯¹æžšä¸¾ç±»åž‹å…³è”ä¸Šæ–¹æ³•ã€‚

```rust
impl IpAddr {
 fn call(&amp;self) {
   dbg!(self)
 }
}
```

æˆ‘ä»¬å°±å¯ä»¥ç›´æŽ¥ä½¿ç”¨`home.call()`æ¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚

##### todo option

### ç›¸å…³æŽ§åˆ¶æµè¿ç®—ç¬¦

#### `match`è¿ç®—ç¬¦

å¦‚æžœæœ‰å…¶ä»–è¯­è¨€åŸºç¡€çš„è¯ï¼Œçœ‹åˆ°`match`è¿™ä¸ªå…³é”®å­—ï¼Œåº”è¯¥èƒ½è”æƒ³åˆ°`switch`ã€‚å®ƒçš„ç”¨æ³•å’Œ`switch`æ˜¯å·®ä¸å¤šçš„ï¼Œåªæ˜¯æœ‰ä¸€äº›ç»†èŠ‚ä¸åŒã€‚è¿™é‡Œæˆ‘ä»¬ç”¨ä¸Šé¢çš„`IpAddr`ç»‘å®šçš„æ–¹æ³•`call`ä¸¾ä¾‹ï¼š

```rust
fn call(&amp;self) {
  match self {
    IpAddr::V4(a, b, c, d) =&gt; println!(&#34;{}:{}:{}:{}&#34;, a, b, c, d),
    IpAddr::V6(str) =&gt; println!(&#34;{}&#34;, str),
  }
}
```

å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†`match`åŒ¹é…äº†`self`è¿™ä¸ªå˜é‡ï¼Œåœ¨ case é‡Œæˆ‘ä»¬ç”¨ä¸Šäº†`IpAddr::V4(a, b, c, d)`ï¼Œä½¿ç”¨äº†`a b c d`å››ä¸ªå˜é‡æ¥åˆ†åˆ«åŒ¹é…ç»‘å®šä¸Šçš„`V4(u8, u8, u8, u8)`4ä¸ªå€¼ã€‚è€Œåœ¨`IpAddr::V6(str)`ä½¿ç”¨äº†`str`æ¥æŽ¥æ”¶ç»‘å®šçš„`String`è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ ¹æ®ä¸åŒçš„ç±»åž‹åœ¨åšå‡ºä¸åŒçš„æ“ä½œäº†ã€‚

ä½†æ˜¯æ³¨æ„ Rust é»˜è®¤éœ€è¦æˆ‘ä»¬å¤„ç†`match`åŽå˜é‡çš„æ‰€æœ‰å¯èƒ½æƒ…å†µï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸‹è¿°ä»£ç æ˜¯ä¸æ­£ç¡®çš„ï¼š

```rust
fn call(&amp;self) {
  match self {
    IpAddr::V4(a, b, c, d) =&gt; println!(&#34;{}:{}:{}:{}&#34;, a, b, c, d),
  }
}
```

Rust ä¼šæç¤ºæˆ‘ä»¬å°‘äº†`IpAddr::V6`çš„`case`ã€‚

ä¸Šè¿°ä¾‹å­åªæœ‰2ç§æƒ…å†µï¼Œé‚£å¦‚æžœæ˜¯10ç§ï¼Ÿ20ç§å‘¢ï¼Ÿå¦‚æžœçœŸçš„å…¨éƒ¨éƒ½è¦åˆ—å‡ºæ¥çš„è¯ï¼Œé‚£æœªå…å¤ªè ¢äº†ã€‚æ‰€ä»¥ Rust å’Œå…¶ä»–è¯­è¨€ä¸€æ ·ï¼Œæä¾›äº†ç±»ä¼¼`default`çš„åŠŸèƒ½ï¼Œä½¿ç”¨çš„å…³é”®å­—æ˜¯`_ï¼Œ`æˆ‘ä»¬æ¥çœ‹çœ‹ä¾‹å­ã€‚

```rust
fn call(&amp;self) {
  match self {
    IpAddr::V4(a, b, c, d) =&gt; println!(&#34;{}:{}:{}:{}&#34;, a, b, c, d),
    _ =&gt; (),
  }
}
```

æ³¨æ„å¿…é¡»è¦æ˜¾å¼è°ƒç”¨`_ =&gt; ()` Rust**ä¸ä¼šé»˜è®¤ç»™ä½ åŠ ä¸Š**ã€‚è¿™æ ·çš„è¯å°±å¯ä»¥å¿½ç•¥æŽ‰`V6`çš„åŒ¹é…äº†ã€‚

#### `if let`ç®€å•æŽ§åˆ¶æµ

æƒ³ä¸Šé¢çš„ä¾‹å­ï¼Œåªæœ‰2ç§æƒ…å†µï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ˜¾å¼çš„ç”¨`_`åŽ»å¿½ç•¥åŒ¹é…ï¼Œå®žåœ¨æ˜¯è¿‡äºŽå†—é•¿ï¼Œæ‰€ä»¥ Rustç»™äº†æˆ‘ä»¬å¦å¤–ä¸€ç§æ–¹å¼æ¥å¤„ç†è¿™ç§æƒ…å†µã€‚

```rust
fn call(&amp;self) {
 if let IpAddr::V4(a, b, c, d) = self {
    println!(&#34;{}:{}:{}:{}&#34;, a, b, c, d);
  }
}
```

è¿™æ ·æˆ‘ä»¬å°±ä¸ç”¨å†ç”¨é‚£ä¹ˆå†—é•¿çš„æ–¹å¼æ¥ç¼–å†™äº†ã€‚

### package / crate / module

&gt; `cargo new`ä¼šç”Ÿæˆé¡¹ç›®çš„é›å½¢ï¼Œæä¾›äº† `src/main.rs`he `src/lib.rs`æ–‡ä»¶ï¼Œéšç€é¡¹ç›®å¤æ‚åº¦çš„å¢žé•¿ï¼Œä»£ç é‡ä¹Ÿä¼šéšä¹‹å¢žé•¿ï¼Œå¦‚æžœé ä¸€ä¸ªæ–‡ä»¶æ¥ç»´æŠ¤ä¸€å¤§å †ä»£ç ï¼Œè‚¯å®šæ˜¯ä¸åˆé€‚çš„ã€‚ä¸€èˆ¬éƒ½ä¼šä½¿ç”¨`æ¨¡å—`æ¥æ‹†åˆ†æ–‡ä»¶ã€‚

åœ¨è¿™é‡Œå­¦ä¹ ä¸€ä¸‹`rust`ä¸­ä»£ç çš„ç»„ç»‡æ–¹å¼ï¼Œä¸»è¦æ¶‰åŠåˆ°ä¸€ä¸‹å‡ ä¸ªåè¯ï¼š

* packageï¼š`Cargo`ä¸­çš„æ¦‚å¿µï¼Œç”¨äºŽç®¡ç†`crate`
* crateï¼šæ¨¡å—çš„é›†åˆï¼Œç¼–è¯‘å•ä½ï¼Œæœ‰`bin`å’Œ`lib`ä¸¤ç§ï¼Œåˆ†åˆ«æ˜¯å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå’Œä¾›ä»–äººè°ƒç”¨
* moduleï¼šç”¨æˆ·åœ¨`crate`å†…ç»„ç»‡ä»£ç 
* workspaceï¼šé¡¹ç›®å¤æ‚æ—¶ï¼Œç®¡ç†å¤šä¸ª`package`

#### package

ä½¿ç”¨`cargo new`å‘½ä»¤ä¼šåˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ª`package`ï¼Œé‡Œé¢å¸¦æœ‰ä¸€ä¸ª`Cargo.toml`æ–‡ä»¶ï¼Œç”¨äºŽå®šä¹‰`package`ã€æ‰€éœ€å¤–éƒ¨ä¾èµ–ï¼Œä»¥åŠå¦‚ä½•ç¼–è¯‘`crate`ç­‰

#### crate

`Rust`é‡Œæœ‰ä¸¤ç§`crate`ï¼Œ`lib`ç±»åž‹å’Œ`bin`ç±»åž‹ï¼Œå¹¶ä¸”é»˜è®¤ä»¥æ–‡ä»¶åä¸ºæ ‡å‡†å¤„ç†`crate`:

* `src/main.rs`ï¼šè¡¨ç¤ºè¯¥`crate`æ—¶ä¸€ä¸ª`bin`ç±»åž‹å¤§`crate`
* `src/lib.rs`ï¼šè¡¨ç¤ºè¯¥`crate`æ—¶ä¸€ä¸ª`lib`ç±»åž‹çš„`crate`

å¹¶ä¸”ï¼Œä¸€ä¸ª`package`ä¸­çš„`crate`è¿˜æœ‰å¦‚ä¸‹ä¸Žçº¦æŸï¼š

* å¯ä»¥æœ‰å¤šä¸ª`bin`ç±»åž‹çš„`crate`
* åªèƒ½æœ‰0ä¸ªæˆ–è€…1ä¸ª`lib`ç±»åž‹çš„`crate`

ä»¥ä¸Šä¸¤æ¡çº¦æŸå¹¶ä¸äº’æ–¥ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªé¡¹ç›®ä¸‹å¯ä»¥æœ‰ä¸€ä¸ª`lib`å’Œå¤šä¸ª`bin`ç±»åž‹çš„`crate`ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥ç¼–è¯‘å‡ºå¤šä¸ªå¯æ‰§è¡Œæ–‡ä»¶

åªæ˜¯å¦‚æžœæœ‰å¤šä¸ª`bin`ç±»åž‹çš„`crate`ï¼Œä¸€ä¸ª`src/main.rs`å°±ä¸å¤Ÿäº†ï¼Œéœ€è¦æ”¾åˆ°`src/bin`ä¸‹ï¼Œæ¯ä¸ª`crate`ä¸€ä¸ªæ–‡ä»¶

#### mod

å½“é¡¹ç›®é€æ¸è†¨èƒ€åŽï¼Œå¯ä»¥å¯¹ä»£ç ä»¥`mod`ã€Œæ–‡ä»¶/æ–‡ä»¶å¤¹ã€ä¸ºå•ä½è¿›è¡Œæ‹†åˆ†ï¼Œè€Œä¸æ˜¯æŠŠæ‰€æœ‰ä»£ç éƒ½å†™åœ¨`src/main.rs`æˆ–è€…`src/lib.rs`é‡Œ

ä»¥`lib`ç±»åž‹çš„`crate`ä¸ºä¾‹ï¼Œè¯¥ç±»åž‹çš„`crate`å…¥å£åœ¨`src/lib.rs`ï¼Œä¹Ÿå°±æ˜¯`crate`çš„æ ¹ã€‚å®šä¹‰ä¸€ä¸ªæ¨¡å—ä¹Ÿå¾ˆç®€å•

```rust
// src/lib.rs
mod testMod {
  fn test() {
    println!(&#34;test&#34;)
  }
}
```

è€Œåœ¨å®žé™…é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ä¸ä¼šåªæœ‰ä¸€ä¸ª`lib.rs`æ–‡ä»¶ï¼Œè€Œæ˜¯ä¼šå°†ä»£ç æŒ‰åŠŸèƒ½è¿›è¡Œæ‹†åˆ†æˆå¤šä¸ªæ¨¡å—

#### æ¨¡å—æ‹†åˆ†

ä¸€èˆ¬æ¥è¯´ï¼Œä¸€ä¸ªæ–‡ä»¶éƒ½ä¼šè¢«çœ‹ä½œä¸ºä¸€ä¸ª`mod`ï¼Œå¹¶ä¸”`mod`å¯ä»¥åµŒå¥—å®šä¹‰ã€‚åµŒå¥—å®šä¹‰çš„`mod`å¯ä»¥å¸è½½ä¸€ä¸ªæ–‡ä»¶é‡Œï¼Œä¹Ÿå¯ä»¥é€šè¿‡æ–‡ä»¶å¤¹çš„å½¢å¼æ¥å®žçŽ°ã€‚å…·ä½“çš„æˆ‘ä»¬æ¥çœ‹å‡ ä¸ªä¾‹å­ã€‚

å‡è®¾å½“å‰é¡¹ç›®æ–‡ä»¶ç»“æž„å¦‚ä¸‹:

```
src
â”œâ”€â”€ lib.rs
â”œâ”€â”€ mod_a
â”‚   â”œâ”€â”€ mod.rs
â”‚   â””â”€â”€ mod_b.rs
â””â”€â”€ mod_c.rs
```

åœ¨è¿™é‡Œå®šä¹‰äº†3ä¸ª`mod`ï¼šmod_aã€mod_b å’Œ mod_cï¼Œå…¶ä¸­`mod_a`ä¸ºæ–‡ä»¶å¤¹å½¢å¼ï¼Œè€Œ`mod_b`å’Œ`mod_c`éƒ½æœ‰å¯¹åº”çš„æ–‡ä»¶ã€‚å…¶ä¸­`mod_b`æ˜¯`mod_a`çš„å­æ¨¡å—ã€‚

æˆ‘ä»¬æ¥çœ‹ä¸‹å„ä¸ªæ¨¡å—ä¹‹é—´å¦‚ä½•å£°æ˜Žå’Œå¼•ç”¨ã€‚

é¦–å…ˆæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹`crate`çš„æ ¹ï¼Œä¹Ÿå°±æ˜¯`lib.rs`

```rust
pub mod mod_a;
mod mod_c;
```

åœ¨è¿™é‡Œå£°æ˜Žäº†ä¸¤ä¸ª`mod`ï¼Œå¦‚æžœéœ€è¦åœ¨`crate`å¤–éƒ¨è®¿é—®ï¼Œéœ€è¦åœ¨`mod`å‰é¢åŠ ä¸Š`pub`å…³é”®å­—ã€‚æ³¨æ„è¿™é‡Œä¸éœ€è¦å£°æ˜Ž`mod_a`çš„å­æ¨¡å—`mod_b`,è¿™ä¸ªéœ€è¦`mod_a`æ¥å£°æ˜Žã€‚

å†æ¥çœ‹ä¸€ä¸‹è¿™ä¸¤ä¸ªmodã€‚å…ˆçœ‹mod_aï¼Œè¿™æ˜¯ä¸€ä¸ªæ–‡ä»¶å¤¹å½¢å¼å­˜åœ¨çš„modï¼ŒæŒ‰cargoè§„å®šï¼Œè¿™æ—¶å€™éœ€è¦åœ¨è¯¥æ–‡ä»¶å¤¹ä¸‹æœ‰ä¸€ä¸ªåä¸ºmod.rsçš„æ–‡ä»¶å®šä¹‰è¯¥modä¸‹çš„å†…å®¹ã€‚è¯¥æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š

```rust
// src/mod_a/mod.rs
pub mod mod_b;
```

å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªæ–‡ä»¶å’Œ`lib.rs`ç±»ä¼¼ï¼Œéƒ½å¯ä»¥å£°æ˜Ž`mod`ã€‚ä½†è¯¥æ–‡ä»¶å£°æ˜Žçš„`mod`å¯ä»¥ä¿å­˜åˆ°`mod.rs`ï¼š

```rust
// src/mod_a/mod_b.rs
use super::super::mod_c;

pub fn test() {
  println!(&#34;i&#39;m mod_b&#34;)
}

fn call_mod_c() {
  mod_c::test();
}
```

æˆ‘ä»¬å†æ¥çœ‹çœ‹`mod_c.rs`çš„ä»£ç ï¼š

```rust
// src/mod_c.rs
use crate::mod_a::mod_b;

pub fn test() {
  mod_b::test();
  println!(&#34;i&#39;m mod_c&#34;);
}
```

é™¤äº†å¦‚ä½•å®šä¹‰`mod`ï¼Œæˆ‘ä»¬è¿˜éœ€è¦çš„æ˜¯å¦‚ä½•å¼•ç”¨å…¶ä»–`mod`çš„å®šä¹‰ã€‚åœ¨`mod_c`ä¸­ï¼Œè¦æƒ³ä½¿ç”¨`mod_b`ï¼Œå¯ä»¥ä½¿ç”¨ï¼š

* ç»å¯¹è·¯å¾„`use crate::mod_a::mod_b`

è€Œåœ¨`mod_b`ä¸­ä½¿ç”¨`mod_c`çš„æ—¶å€™ï¼Œä½¿ç”¨äº†`use super::super::mod_c`è¿™ç§ç›¸å¯¹è·¯å¾„çš„å½¢å¼ã€‚

#### æ·»åŠ `main.rs`

æœ€åŽåœ¨ä¸Šé¢ä»£ç çš„åŸºç¡€ä¸Šæ·»åŠ `main.rs`ï¼Œçœ‹çœ‹ä½œä¸ºå¤–éƒ¨`crate`å¦‚ä½•ä½¿ç”¨ä¸Šé¢çš„`mod_a`

```rust
// src/main.rs
use testlib::mod_a::mod_b;

fn main() {
  println!(&#34;main&#34;)
  mod_b::test();
}
```

åœ¨è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¼•ç”¨è‡ªå·±`lib`çš„æ–¹æ³•ä¸èƒ½ä½¿ç”¨ä¸Šé¢è¯´çš„`ç»å¯¹è·¯å¾„`æˆ–è€…`ç›¸å¯¹è·¯å¾„`è¿™ä¸¤ç§å¼•ç”¨æ–¹å¼ï¼Œå¿…é¡»ä½¿ç”¨è¯¥`crate`çš„åç§°ã€Œä¹Ÿå°±æ˜¯`Cargo.toml`é‡Œçš„åç§°ã€æ¥åº”ç”¨ã€‚å› ä¸º`main`å’Œ`lib`å±žäºŽä¸åŒçš„`crate`

#### pub ä¿®é¥°ç¬¦

è¦æƒ³è®¿é—®å…¶ä»–`mod`ä¸­çš„ç»“æž„ä½“ã€æ–¹æ³•ã€æžšä¸¾ç­‰ï¼Œéœ€è¦å¯¹æ–¹å£°æ˜Žä¸º`pub`ã€‚å¦‚æžœæ˜¯æƒ³æ“ä½œç»“æž„ä½“ä¸­çš„å­—æ®µï¼Œå¯ä»¥æœ‰ä¸€ä¸‹ä¸¤ç§æ–¹æ³•

* æä¾›å¯¹åº”çš„`pub`æ–¹æ³•
* ç›´æŽ¥ä¿®æ”¹å­—æ®µä¸º`pub`

#### use è¯­å¥

è®²äº†è¿™ä¹ˆåšå¦‚ä½•å®šä¹‰`mod`ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹å¦‚ä½•ä½¿ç”¨

åœ¨`crate`å’Œæ¨¡å—ä¸­æˆ‘ä»¬å¯èƒ½å®šä¹‰äº†å‡½æ•°ã€ç»“æž„ä½“ç­‰ï¼Œè¦æƒ³åœ¨å…¶ä»–æ¨¡å—æˆ–è€…`crate`ä¸­ä½¿ç”¨ï¼Œéœ€è¦å°†å…¶å¼•å…¥åˆ°å½“å‰æ–‡ä»¶ä¸­ï¼Œç±»ä¼¼`php`çš„`use`ï¼Œæˆ–è€…`java`ä¸­çš„`import`ï¼Œåœ¨`Rust`ä¸­æˆ‘ä»¬éœ€è¦ä½¿ç”¨`use`

å¦‚ä½•è¡¨ç¤ºè¦è¢«å¼•ç”¨çš„å¯¹è±¡ï¼Œ`Rust`é‡Œç§°ä¹‹ä¸º`path`ï¼Œæˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºæ“ä½œç³»ç»Ÿä¸­çš„æ–‡ä»¶ç›®å½•

`path`æœ‰ä¸¤ç§å½¢å¼ï¼Œä¹Ÿå’Œæ–‡ä»¶ç³»ç»Ÿä¸€æ ·ï¼Œæœ‰ç»å¯¹è·¯å¾„å’Œç›¸å¯¹è·¯å¾„ï¼š

* ç»å¯¹è·¯å¾„å§‹äºŽ`crate`çš„æ ¹ï¼ˆ`src/main.rs` or `src/lib.rs`ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨`crate`åæˆ–è€…`crate`è¿™ä¸ªå­—é¢å€¼è¡¨ç¤º
* ç›¸å¯¹è·¯å¾„å¯ä»¥ä½¿ç”¨å½“å‰æ¨¡å—åï¼Œå½“å‰æ¨¡å—ä¸­å¯ä»¥ä½¿ç”¨çš„å¯¹è±¡ï¼Œ`super`å’Œ`self`ç­‰

`path`ä¸­çš„å±‚çº§ä½¿ç”¨ä¸¤ä¸ªå†’å·`::`ï¼Œç±»ä¼¼æ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–œçº¿.

å‡è®¾æœ‰ä¸€ä¸‹ä»£ç ï¼ˆæ¥è‡ªå®˜æ–¹æ–‡æ¡£ï¼‰ï¼š

```rust
mod front_of_house {
  pub mod hosting {
    pub fn add_to_waitlist() {}
  }
}

pub fn eat_at_restautant() {
  // ç»å¯¹è·¯å¾„
  crate::front_of_house::hosting::add_to_waitlist();
  // ç›¸å¯¹è·¯å¾„
  front_of_house::hosting::add_to_waitlist();
}
```

æœ‰ä¸€äº›é™åˆ¶ä¹Ÿéœ€è¦çŸ¥é“ï¼š

* åœ¨å¤«æ¨¡å—ä¸­ä¸èƒ½ä½¿ç”¨å­æ¨¡å—ä¸­çš„ç§æœ‰é¡¹ç›®
* å­æ¨¡å—å¯ä»¥ä½¿ç”¨çˆ¶æ¨¡å—ä¸­çš„æ‰€æœ‰é¡¹ç›®
* åŒä¸€æ¨¡å—å†…å¯ä»¥ç›´æŽ¥äº’ç›¸ä½¿ç”¨

ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨äº†`super`çš„ä¾‹å­ï¼š

```rust
fn server_order() {}

mod back_of_house() {
  fn fix_incorrect_order() {
    cook_order();
    super::server_order();
  }
  
  fn cook_order() {}
}
```

`fix_incorrect_order`æ–¹æ³•å’Œ`cook_order`åŒå±žäºŽä¸€ä¸ªæ¨¡å—ï¼Œå¯ä»¥ç›´æŽ¥è°ƒç”¨ã€‚`server_order`æ–¹æ³•å’Œ`back_of_house`åŒçº§ï¼Œå› æ­¤éœ€è¦ä½¿ç”¨`super`è®¿é—®åˆ°åŒçº§çš„`server_order`æ–¹æ³•

å¦‚æžœ`use`åŽé¢çš„è·¯å¾„å…·æœ‰å…±åŒçš„çˆ¶è·¯å¾„ï¼Œå¯ä»¥ä½¿ç”¨ç®€åŒ–çš„æ¨¡å¼ã€‚æ¯”å¦‚ï¼š

```rust
use std::io;
use std::cmp::Ordering;
```

å¯ä»¥ç®€åŒ–ä¸ºï¼š

```rust
use std::{cmp::Ordering, io};
```

å¦‚æžœ`use`çš„`mod`ç›´æŽ¥æœ‰çˆ¶å­å…³ç³»ï¼Œä¹Ÿå¯ä»¥åƒä¸Šé¢é‚£æ ·ç®€åŒ–ï¼Œä½¿ç”¨`self`ä»£è¡¨çˆ¶`mod`ã€‚æ¯”å¦‚ï¼š

```rust
use std::io;
use std::io::Write;
```

å¯ä»¥ç®€åŒ–ä¸ºï¼š

```rust
use std::io::{self, Write};
```

å¦‚æžœæƒ³å°†æŸä¸€è·¯å¾„ä¸‹çš„æ‰€æœ‰`pub`çš„`item`éƒ½å¼•å…¥åˆ°å½“å‰æ–‡ä»¶ä¸­ï¼Œå¯ä»¥ä½¿ç”¨`*`

```rust
use std::collections::*;
```

ä¸€èˆ¬ä¼šåœ¨å•å…ƒæµ‹è¯•ä¸­å¸¸ç”¨ï¼Œä¸æŽ¨èåœ¨ä¸šåŠ¡ä»£ç ä¸­ä½¿ç”¨

```rust
#[cfg(test)]
mod tests{
  use super::*;
  #[test]
  fn it_works() {}
}
```

#### å¼•ç”¨å±‚çº§

å¯¹æ¯”ä¸€ä¸‹ä¸¤ç§å¼•ç”¨æ–¹å¼:

```rust
// case 1
use crate::front_of_house::hosting;
hosting::add_to_waitlist();

// case 2
use crate::front_of_house::hosting::add_to_waitlist;
add_to_waitlist();
```

è¿™ä¸¤ç§æ–¹æ³•çš„ç»“æžœéƒ½æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯é˜…è¯»èµ·æ¥ç»™äººçš„æ„Ÿè§‰ä¸ä¸€æ ·ã€‚ä¸€èˆ¬æ¥è¯´æŽ¨èç¬¬ä¸€ä¸ª case ï¼Œè¿™æ ·èƒ½æ˜Žç¡®çš„çŸ¥é“ä½¿ç”¨çš„æ–¹æ³•æ˜¯å¤–éƒ¨ hosting æ¨¡å—çš„æ–¹æ³•ï¼ŒåŽè€…çš„è¯ä¸çŸ¥é“æ˜¯ use è¿›æ¥çš„ï¼Œè¿˜æ˜¯æœ¬æ¨¡å—å®šä¹‰çš„

#### é‡å‘½å

æœ‰æ—¶å€™ä»Žä¸åŒçš„ crate æˆ–è€… mod å¼•å…¥äº†åŒåçš„ itemï¼Œè¿™ä¸ªæ—¶å€™æœ€ç®€å•çš„æ–¹å¼æ˜¯ä½¿ç”¨`as`å…³é”®å­—è¿›è¡Œé‡å‘½åã€‚

```rust
use std::fmt;
use std::io;

fn function1() -&gt; fmt::Result {}
fn function2() -&gt; io::Result&lt;()&gt; {}

###########################

use std::fmt::Result;
use std::io::Result as IoResult;

fn function1() -&gt; Result {}
fn function2() -&gt; IoResult&lt;()&gt; {}
```

#### re-exporting å†å¯¼å‡º

å½“ä½¿ç”¨`use`å…³é”®å­—å°†å¤–éƒ¨ item å¯¼å…¥åˆ°å½“å‰æ–‡ä»¶ä¹‹åŽï¼Œè¿™ä¸ª item åœ¨å½“å‰ä»£ç æ˜¯ private çš„ï¼Œå¦‚æžœä½¿ç”¨`pub use`çš„è¯ï¼Œè¿˜èƒ½è®©ä½¿ç”¨å½“å‰ mod çš„ç¬¬ä¸‰è€…ï¼Œä½¿ç”¨åœ¨è¯¥ mod ä¸­å¼•å…¥çš„ itemã€‚

è¯¥æœºåˆ¶ç§°ä¸º re-exporting ã€‚

#### workspace

workspace ç”¨äºŽç®¡ç†å¤šä¸ªç›¸å…³çš„ packageï¼Œä¸åŒçš„ package æœ‰å„è‡ªçš„ Cargo.tomlï¼Œä½†æ˜¯æ•´ä¸ª workspace å…±äº«ä¸€ä¸ªCargo.lockï¼Œä¹Ÿåªæœ‰ä¸€ä¸ª target ç›®å½•ï¼ˆç¼–è¯‘è¾“å‡ºï¼‰ã€‚

è™½ç„¶ workspace å†…çš„é¡¹ç›®å…±äº«ä¸€ä¸ª Cargo.lockï¼Œä½†æ˜¯ä»–ä»¬ä¹‹é—´é»˜è®¤ä¸äº’ç›¸ä¾èµ–ï¼Œéœ€è¦æ˜¾ç¤ºæ·»åŠ å®ƒä»¬ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚è€Œä¸”åœ¨ä¸€ä¸ªé¡¹ç›®ä¸­æ·»åŠ çš„ä¾èµ–ï¼Œåœ¨å…¶ä»–é¡¹ç›®ä¸­å¦‚æžœæƒ³ä½¿ç”¨ï¼Œè¿˜éœ€è¦å†æ¬¡å£°æ˜Žä¾èµ–æ‰è¡Œã€‚

ä¸è¿‡æ®æˆ‘è§‚å¯Ÿ workspace åŠŸèƒ½æ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«å¼ºå¤§ä¹‹å¤„ï¼Œä¸ä½¿ç”¨è¯¥åŠŸèƒ½ä¹Ÿå¯ä»¥åŒæ—¶ç®¡ç†å‡ ä¸ª Cargo é¡¹ç›®ï¼Œå› æ­¤è¿™é‡Œå°±ä¸å†æ·±å…¥ä»‹ç»äº†ã€‚

### å¸¸è§é›†åˆ

ä¸€èˆ¬æ¥è¯´åœ¨ Rust å¸¸ç”¨çš„é›†åˆ

* `vector`å…è®¸æˆ‘ä»¬ä¸€ä¸ªæŒ¨ç€ä¸€ä¸ªåœ°å­˜å‚¨ä¸€ç³»åˆ—æ•°é‡å¯å˜çš„å€¼
* å­—ç¬¦ä¸²æ˜¯å­—ç¬¦çš„é›†åˆï¼Œ`String`
* å“ˆå¸Œ map å…è®¸æˆ‘ä»¬å°†å€¼ä¸Žä¸€ä¸ªç‰¹å®šçš„é”®ç›¸å…³è”

#### vector

æ–°å»º`vector`

```rust
  let v: Vec&lt;i32&gt; = Vec::new();
  
  let v = vec![1, 2, 3];
```

æ›´æ–°`vector`

```rust
let mut v = Vec::new();

v.push(1);
v.push(2);

let a = v.pop();

```

ç±»ä¼¼äºŽå…¶ä»–ä»»ä½•çš„`struct`ï¼Œvector åœ¨ç¦»å¼€å…¶ä½œç”¨åŸŸæ—¶ä¼šè¢«é‡Šæ”¾ã€‚

è®¿é—®`vector`

```rust
let v = vec![1, 2, 3];

let v1 = &amp;v[1]; // ç´¢å¼•è¯­æ³•
let v2 = v.get(2); // æ–¹æ³•
```

ä½¿ç”¨ç´¢å¼•è¯­æ³•è®¿é—®`vector`ä¼šå¯¼è‡´ç¨‹åº`panic`ï¼Œè€Œä½¿ç”¨ get æ–¹æ³•è®¿é—®æ—¶ ä¼šè¿”å›žä¸€ä¸ª None

åœ¨æ‹¿åˆ° vector ä¸­ä»»æ„ä¸€ä¸ªæœ‰æ•ˆçš„å¼•ç”¨ï¼Œå€Ÿç”¨æ£€æŸ¥å™¨å°†ä¼šçª’æ¯æ‰€æœ‰æƒå’Œå€Ÿç”¨è§„åˆ™ï¼Œæ¥ç¡®ä¿ vector å†…å®¹çš„è¿™ä¸ªå¼•ç”¨å’Œä»»ä½•å…¶ä»–å¼•ç”¨ä¿æŒæœ‰æ•ˆã€‚å½“æˆ‘ä»¬èŽ·å–åˆ°äº† vector çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„ä¸å¯å˜å¼•ç”¨å¹¶åœ¨ vector æœ«å°¾å¢žåŠ ä¸€ä¸ªå…ƒç´ çš„æ—¶å€™ï¼Œç¼–è¯‘æ— æ³•é€šè¿‡ã€‚

```rust
let mut v = vec![1, 2, 3, 4, 5];

let first = &amp;v[0];

v.push(6); // ä¸é€šè¿‡ç¼–è¯‘

println!(&#34;The first element is: {}&#34;, first);
```

ä¸ºä»€ä¹ˆç¬¬ä¸€å…ƒç´ çš„å¼•ç”¨ä¼šå…³å¿ƒåˆ°æœ«å°¾çš„å˜åŒ–ï¼Ÿé‚£æ˜¯å› ä¸º vector å’Œ golang çš„ slice ä¸€æ ·ï¼Œåœ¨å†…éƒ¨çš„ç©ºé—´ä¸è¶³æ—¶ï¼Œä¼šè¿›è¡Œæ‹·è´æ‰©å®¹ï¼Œè¿™æ ·ç¬¬ä¸€ä¸ªå…ƒç´ çš„å¼•ç”¨å°±æŒ‡å‘äº†è¢«é‡Šæ”¾çš„å†…å­˜ã€‚

éåŽ† vector

```rust
let mut v = vec![1, 2, 3];
for i in &amp;v {
  println!(&#34;{}&#34;, i)
}

for i in &amp;mut v {
  *i &#43;= 50;
}

```

åŒæ—¶ vector ä¹Ÿå¯ä»¥ä½¿ç”¨æžšä¸¾æ¥å­˜å‚¨å¤šç§ç±»åž‹çš„å€¼

```rust
enum Test {
  Int(i32),
  Text(String),
}

let row = vec![
  Test::Int(3),
  Test::Text(String::from(&#34;test&#34;))
];
```

#### å­—ç¬¦ä¸²

åˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸²

```rust
let s1 = String::new(); // åˆ›å»ºä¸€ä¸ªç©ºå­—ç¬¦ä¸²

// ä½¿ç”¨åˆå§‹æ•°æ®åˆ›å»ºå­—ç¬¦ä¸²
let s2 = &#34;test&#34;.to_string();
let s3 = String::from(&#34;test&#34;);
```

æ›´æ–°å­—ç¬¦ä¸²

```rust
let mut s = String::from(&#34;foo&#34;);
let mut x = String::from(&#34; bar&#34;);

s.push_str(x);
s.push(&#39;~&#39;);

println!(&#34;x is {}&#34;, x);

let s1 = String::from(&#34;Hello, &#34;);
let s2 = String::from(&#34;world!&#34;);
let s3 = s1 &#43; &amp;s2; // è¿™é‡Œ s1 è¢«ç§»åŠ¨äº†ï¼Œä¸èƒ½ç»§ç»­ä½¿ç”¨
```

æ‰§è¡Œä¸Šè¿°ä»£ç ä¹‹åŽï¼Œ`s`å°†ä¼šåŒ…å«`x`ï¼Œ`x`è¿˜å¯ä»¥ç»§ç»­ä½¿ç”¨ï¼Œå› ä¸º`push_str`æ–¹æ³•ä½¿ç”¨äº†å­—ç¬¦ä¸² sliceï¼Œå› æ­¤æˆ‘ä»¬ä¸éœ€è¦èŽ·å–å‚æ•°çš„æ‰€æœ‰æƒã€‚

ç„¶è€Œç›´æŽ¥ä½¿ç”¨`&#43;`è¿ç®—ç¬¦å°†ä¸¤ä¸ª`String`å€¼åˆå¹¶åˆ°ä¸€ä¸ªæ–°`String`å€¼ä¸­ï¼Œæ­¤æ—¶`s1`åœ¨ç›¸åŠ åŽå¤±åŽ»äº†æ‰€æœ‰æƒã€‚å› ä¸º`&#43;`è°ƒç”¨äº†`add`å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°çœ‹èµ·æ¥åƒè¿™æ ·

```rust
fn add(self, s:  &amp;str) -&gt; String{}
```

è¿™å¹¶ä¸æ˜¯æ ‡å‡†åº“å½“ä¸­å®žé™…çš„ç­¾åï¼Œæ ‡å‡†åº“ä¸­çš„`add`ä½¿ç”¨æ³›åž‹å®šä¹‰ã€‚

é‚£ä¸ºä»€ä¹ˆ`add`æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯`&amp;str`ï¼Œæˆ‘ä»¬åœ¨è°ƒç”¨æ—¶å´æ˜¯`&amp;String`ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ç¼–è¯‘ã€‚

é‚£æ˜¯å› ä¸º Rust ä½¿ç”¨äº†ä¸€ä¸ªè¢«ç§°ä¸º **Deref å¼ºåˆ¶è½¬æ¢** çš„æŠ€æœ¯ï¼Œå¯ä»¥ç†è§£ä¸ºæŠŠ`&amp;s2`å˜æˆäº†`&amp;s2[..]`

å¹¶ä¸”åœ¨ç­¾åä¸­`add`æ–¹æ³•èŽ·å–`self`çš„æ‰€æœ‰æƒï¼Œè¿™æ„å‘³ç€`s1`çš„æ‰€æœ‰æƒå°†è¢«ç§»åŠ¨åˆ°`add`è°ƒç”¨ä¸­ï¼Œä¹‹åŽä¸åœ¨ç”Ÿæ•ˆï¼Œè¿™æ ·çš„å¥½å¤„æ˜¯ä¸ä¼šç”Ÿæˆå¾ˆå¤šæ‹·è´ï¼Œè¿™ä¸ªå®žçŽ°æ¯”æ‹·è´æ›´åŠ é«˜æ•ˆã€‚

å¦‚æžœæƒ³èŽ·å–å¤šä¸ªå­—ç¬¦ç›¸åŠ ï¼š

```rust
let s1 = String::from(&#34;hello&#34;);
let s2 = String::from(&#34; &#34;);
let s3 = String::from(&#34;world&#34;);

let s = format!(&#34;{}{}{}&#34;, s1, s2, s3);
```

ä¸Šè¿°ä»£ç ä¼šå°†`s`è®¾ç½®ä¸º`hello world`ã€‚`format!`ä¸Ž`println!`çš„å·¥ä½œåŽŸç†ç›¸åŒï¼Œå¹¶ä¸”å®ƒä½¿ç”¨ç´¢å¼•ä¸ä¼šèŽ·å–ä»»ä½•å‚æ•°çš„æ‰€æœ‰æƒã€‚

#### ç´¢å¼•å­—ç¬¦ä¸²

åœ¨å¾ˆå¤šè¯­è¨€ä¸­ï¼Œé€šè¿‡ç´¢å¼•æ¥ä¸€ç”¨å­—ç¬¦ä¸²ä¸­çš„å•ç‹¬å­—ç¬¦æ˜¯å¾ˆå¸¸è§çš„æ“ä½œï¼Œæ¯”å¦‚è¯´ `golang`ã€‚ç„¶è€Œåœ¨ Rust ä¸­ï¼Œä¸å…è®¸ä½¿ç”¨ç´¢å¼•è¯­æ³•è®¿é—®`String`çš„ä¸€éƒ¨åˆ†ï¼Œä¼šå‡ºçŽ°é”™è¯¯ã€‚

```rust
let s = String::from(&#34;hello&#34;);
let h = s[0]; // error
```

åŽŸå› åˆ™æ˜¯åœ¨ Rust ä¸­ï¼Œ`String`æ˜¯ä¸€ä¸ª`Vec&lt;u8&gt;`çš„å°è£…ï¼Œç›¸å½“äºŽåœ¨åº•å±‚å­˜å‚¨çš„æ˜¯å­—èŠ‚ï¼Œå’Œå¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€ä¸€æ ·ã€‚ç›´æŽ¥ä½¿ç”¨ç´¢å¼•è¯­æ³•èŽ·å–`String`çš„ä¸€éƒ¨åˆ†ï¼Œç›¸å½“äºŽèŽ·å–`UTF-8`å­—ç¬¦çš„ä¸€ä¸ªå­—èŠ‚ï¼Œè¿™æ ·å¯èƒ½ä¼šè¿”å›žæ„å¤–çš„å€¼ï¼ŒRust æ ¹æœ¬ä¸ä¼šç¼–è¯‘è¿™äº›ä»£ç ã€‚

åœ¨`Golong`ä¸­å¯ä»¥ç›´æŽ¥ç´¢å¼•è®¿é—®ï¼Œé‚£æ˜¯å› ä¸º`Golang`ä¼šé»˜è®¤æŠŠå­—ç¬¦ä¸²æŒ‰ç…§`rune`æ¥ éåŽ†ã€‚

åœ¨ Rust ä¸­ä¹Ÿæœ‰è¿™æ ·çš„æ“ä½œï¼Œåªä¸è¿‡éœ€è¦æ˜¾ç¤ºä½¿ç”¨ï¼š

```rust
for c in &#34;hello world&#34;.chars() {
  println!(&#34;{}&#34;, c);
}
```

è¿™æ ·å¯ä»¥èŽ·å–åˆ°æ¯ä¸ª`UTF-8`ç¼–ç çš„å­—ç¬¦ï¼Œä¹Ÿå°±ç›¸å½“äºŽ `Golang` ä¸­çš„`rune`ã€‚

```rust
fn main() {
    let s = String::from(&#34;ä½ å¥½ä¸–ç•ŒðŸ‘‹&#34;);
    let c = s.chars().nth(10000);
    match c {
        Some(tmp) =&gt; println!(&#34;{}&#34;,tmp),
        None =&gt; (
            println!(&#34;this index is none&#34;)
        ),
    }
}
```

ä¸Šè¿°ä»£ç å¯ä»¥å®‰å…¨çš„ä½¿ç”¨ç´¢å¼•æ¥èŽ·å–å•ä¸ªå­—ç¬¦ã€‚

### Hash Map

#### æ–°å»º

å¯ä»¥ä½¿ç”¨`new`æ¥åˆ›å»ºä¸€ä¸ªç©ºçš„`HashMap`ï¼Œå¹¶ä½¿ç”¨`insert`å¢žåŠ å…ƒç´ ã€‚

```rust
use std::collections::HashMap;

let mut map = HashMap::new();
map.insert(String::from(&#34;hello&#34;), String::form(&#34;world&#34;));
```

æ³¨æ„ï¼Œä½¿ç”¨`HashMap`éœ€è¦å¼•å…¥

#### è®¿é—®

å¯ä»¥ ä½¿ç”¨`get`æ–¹æ³•ä¼ å…¥å¯¹åº”çš„é”®ï¼Œä»Ž`HashMap`ä¸­èŽ·å–å€¼

```rust
let name = String::from(&#34;hello&#34;);
let s = map.get(&amp;name); // s : Option&lt;V&gt;
```

æˆ–è€…ä½¿ç”¨ä¸Ž vector ç±»ä¼¼çš„æ–¹å¼æ¥éåŽ†

```rust
for (key, value) in &amp;map {
  println!(&#34;{}: {}&#34;, key, value);
}
```

#### æ›´æ–°

ç›´æŽ¥ä½¿ç”¨ç›¸åŒçš„é”®é‡æ–°è°ƒç”¨`insert`æ–¹æ³•ï¼Œè¿™æ ·ä¼šç›´æŽ¥æ›¿æ¢æˆæ–°å€¼ã€‚

å½“æˆ‘ä»¬éœ€è¦æ£€æŸ¥å¯¹åº”é”®æ˜¯å¦å­˜åœ¨å€¼æ—¶ï¼Œå¯ä»¥ä½¿ç”¨`entry`æ–¹æ³•

```rust
map.insert(String::from(&#34;Ronin&#34;));
let s = map.entry(String::from(&#34;hello&#34;)).or_insert(&#34;ä¸–ç•Œ&#34;);
*s = farmat!(&#34;{}&#34;, s, String::from(&#34;~&#34;));
```

å¹¶ä¸”`or_insert`æ–¹æ³•è¿”å›žè¿™ä¸ªå€¼çš„å¯å˜å¼•ç”¨`&amp;mut V`ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æŽ¥æ”¹å˜å®ƒã€‚

#### æ‰€æœ‰æƒ

å¯¹äºŽç±»ä¼¼`i32`è¿™æ ·å®žçŽ°äº†`Copy` trait çš„ç±»åž‹ï¼Œå€¼å¯ä»¥ç›´æŽ¥æ‹·è´è¿›`HashMap`ã€‚å¯¹äºŽæ‹¥æœ‰æ‰€æœ‰æƒçš„å€¼ï¼Œå…¶å€¼å°†è¢«ç§»åŠ¨è€Œ`HashMap`ä¼šæˆä¸ºè¿™äº›å€¼çš„æ‰€æœ‰è€…ã€‚æˆ–è€…å°†å€¼çš„å¼•ç”¨ä¼ å…¥`HashMap`ï¼Œä½†æ˜¯éœ€è¦ä¿è¯ç”Ÿå‘½å‘¨æœŸï¼ŒåŽç»­ä¼šäº†è§£ã€‚


---

> ä½œè€…: RoninZc  
> URL: https://ronin-zc.com/posts/%E5%AE%98%E6%96%B9%E6%96%87%E6%A1%A3%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/  

