<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0">
  <channel>
    <title>RSA - æ ‡ç­¾ - &lt;p&gt;RoninZc çš„ä¸ªäººåšå®¢&lt;/p&gt;</title>
    <link>https://ronin-zc.com/tags/rsa/</link>
    <description>RSA - æ ‡ç­¾ - &lt;p&gt;RoninZc çš„ä¸ªäººåšå®¢&lt;/p&gt;</description>
    <generator>Hugo -- gohugo.io</generator><language>zh-CN</language><managingEditor>devroninzc@gmail.com (RoninZc)</managingEditor>
      <webMaster>devroninzc@gmail.com (RoninZc)</webMaster><lastBuildDate>Wed, 03 Mar 2021 13:47:25 &#43;0800</lastBuildDate><atom:link href="https://ronin-zc.com/tags/rsa/" rel="self" type="application/rss+xml" /><item>
  <title>RSA(ä¸ƒ) X.509 è‡ªç­¾åè¯ä¹¦</title>
  <link>https://ronin-zc.com/rsa%E4%B8%83-x.509-%E8%87%AA%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/</link>
  <pubDate>Wed, 03 Mar 2021 13:47:25 &#43;0800</pubDate>
  <author>RoninZc</author>
  <guid>https://ronin-zc.com/rsa%E4%B8%83-x.509-%E8%87%AA%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6/</guid>
  <description><![CDATA[<h1 id="å‰è¨€">å‰è¨€</h1>
<p>ç»§å‰æ–‡<a
  href="https://www.shangyang.me/2017/05/27/encrypt-rsa-x509/"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>RSA(å…­) X.509 CA è¯ä¹¦</a> æ‰€è¿°ï¼Œ<em>X.509 CA</em> è¯ä¹¦æ˜¯ç”± ğ¶ğ´CA è®¤è¯ä¸­å¿ƒç­¾åå¹¶é¢å‘çš„ï¼›ä½†æ˜¯æœ€åï¼Œä½œè€…ç•™ä¸‹äº†è¿™ä¹ˆä¸€ä¸ªç–‘é—®ï¼Œå°±æ˜¯å¦‚æœåœ¨ä¼ä¸šå†…ç½‘ï¼Œæˆ‘åŒæ ·éœ€è¦å¯¹å…¬é’¥è¿›è¡Œè®¤è¯ï¼Œä½†æ˜¯å› ä¸ºä¸éœ€è¦è¿æ¥å¤–ç½‘ï¼Œæ‰€ä»¥å¹¶ä¸éœ€è¦ ğ¶ğ´CA è¯ä¹¦(å› ä¸ºï¼Œğ¶ğ´CA è¯ä¹¦æ¯•ç«Ÿå¼€é”€ä¸è²)ï¼›é‚£ä¹ˆæ˜¯å¦æœ‰è¿™æ ·çš„ä¸€ç§å¯æ›¿ä»£çš„æ–¹æ¡ˆï¼Œåœ¨ä¸ä½¿ç”¨ ğ¶ğ´CA è¯ä¹¦çš„å‰æä¸‹ï¼Œèƒ½å¦ä¿è¯å…¬é’¥çš„åˆæ³•æ€§ï¼Ÿç­”æ¡ˆæ˜¯<code>è‡ªç­¾åè¯ä¹¦</code>ï¼›</p>
<p>å¤‡æ³¨ï¼Œæœ¬æ–‡æ˜¯ä½œè€…çš„åŸåˆ›ä½œå“ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>
<blockquote>
<p>è½¬è½½è‡³<code>https://www.shangyang.me/2017/05/27/encrypt-rsa-selfsigned-certificate/</code></p>
</blockquote>
<h1 id="å®šä¹‰">å®šä¹‰</h1>
<p>çœ‹ä¸‹ wikipedia <a
  href="https://en.wikipedia.org/wiki/Self-signed_certificate"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>https://en.wikipedia.org/wiki/Self-signed_certificate</a> ä¸Šçš„æœ€é‡è¦çš„ä¸€æ®µè§£é‡Š</p>
<blockquote>
<p>In technical terms a self-signed certificate is one signed with its own private key.</p>
</blockquote>
<p>è‡ªç­¾åè¯ä¹¦è¯´ç©¿äº†ï¼Œå°±æ˜¯ä¸€ä¸ªç”±è‡ªå·±çš„ç§é’¥è¿›è¡Œç­¾åçš„è¯ä¹¦ï¼›</p>
<h1 id="ä¸-ca-è¯ä¹¦çš„åŒºåˆ«">ä¸ CA è¯ä¹¦çš„åŒºåˆ«</h1>
<p>é€šè¿‡ <a
  href="https://www.shangyang.me/2017/05/27/encrypt-rsa-x509/"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>RSA(å…­) X.509 CA è¯ä¹¦</a> ç« èŠ‚æˆ‘ä»¬çŸ¥é“ï¼Œè¦ä¿è¯å…¬é’¥çš„åˆæ³•æ€§ï¼Œæˆ‘ä»¬éœ€è¦æŠŠè‡ªå·±çš„å…¬é’¥äº¤ç»™ç¬¬ä¸‰æ–¹ ğ¶ğ´CA æœºæ„ï¼Œé€šè¿‡å®ƒçš„ç§é’¥æ¥è¿›è¡Œç­¾åï¼Œå¹¶ç”Ÿæˆä¸€å¼  ğ¶ğ´CA è¯ä¹¦å¹¶é¢å‘ç»™ç”¨æˆ·ï¼›è€Œä¸ ğ¶ğ´CA è¯ä¹¦ç›¸å¯¹åº”çš„å°±æ˜¯è‡ªç­¾åè¯ä¹¦ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘è‡ªå·±çš„å…¬é’¥ä¸äº¤ç»™ç¬¬ä¸‰æ–¹çš„ ğ¶ğ´CA æœºæ„è¿›è¡Œç­¾åï¼Œè€Œæ˜¯ç›´æ¥ç”±è‡ªå·±çš„ç§é’¥è¿›è¡Œç­¾åï¼Œå¹¶ç”Ÿæˆä¸€å¼ è‡ªç­¾åçš„è¯ä¹¦ï¼›</p>
<h1 id="å¦‚ä½•ç”Ÿæˆ">å¦‚ä½•ç”Ÿæˆ</h1>
<p>è¿™é‡Œæˆ‘ä¸»è¦è®²è§£ä¸€ä¸‹ï¼Œå¦‚æœé€šè¿‡ <em>openssl</em> æ¥ç”Ÿæˆè‡ªç­¾åçš„è¯ä¹¦ï¼Œ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$ openssl req \
</span></span><span class="line"><span class="cl">&gt;        -newkey rsa:2048 -nodes -keyout private.key \
</span></span><span class="line"><span class="cl">&gt;        -x509 -days 365 -out self-signed.crt
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶ååŒæ ·éœ€è¦è¾“å…¥ <a
  href="https://www.shangyang.me/2017/05/27/encrypt-rsa-x509/#%e9%80%9a%e8%bf%87-CSR-%e7%94%b3%e8%af%b7-X509-CA-%e8%af%81%e4%b9%a6"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>CSR ç›¸å…³çš„ä¿¡æ¯</a>æ¥ç”³è¯·ï¼›æœ€åï¼Œä¼šåœ¨æœ¬åœ°ç›®å½•ä¸­ç”Ÿæˆä¸€ä¸ªç§é’¥ <em>private.key</em> å’Œä¸€å¼ è‡ªç­¾åçš„è¯ä¹¦ <em>self-signed.crt</em>ï¼›æ³¨æ„ï¼Œè‡ªç­¾åè¯ä¹¦æ–‡ä»¶çš„åç¼€ä¸º <em>.crt</em>ï¼›ä¸‹é¢æ¥çœ‹çœ‹å„ä¸ªå‚æ•°çš„ç®€è¦è¯´æ˜ï¼Œ</p>
<p><code>-x509</code>å‘Šè¯‰ openssl ç”Ÿæˆä¸€å¼ è‡ªç­¾åçš„è¯ä¹¦ï¼›
<code>-nodes</code>å‘Šè¯‰ openssl åœ¨ç”Ÿæˆç§é’¥çš„æ—¶å€™å¿½ç•¥å¯†ç </p>
<p>å‚è€ƒ
<a
  href="https://www.digitalocean.com/community/tutorials/how-to-create-a-self-signed-ssl-certificate-for-apache-in-ubuntu-16-04"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>How To Create a Self-Signed SSL Certificate for Apache in Ubuntu 16.04</a></p>
<p><a
  href="https://www.digitalocean.com/community/tutorials/openssl-essentials-working-with-ssl-certificates-private-keys-and-csrs"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>OpenSSL Essentials: Working with SSL Certificates, Private Keys and CSRs</a></p>
<h1 id="å†…éƒ¨ç»“æ„">å†…éƒ¨ç»“æ„</h1>
<p>æˆ‘ä»¬æ¥æŸ¥çœ‹ä¸€ä¸‹åˆšæ‰é€šè¿‡ openssl ç”Ÿæˆçš„è‡ªç­¾åè¯ä¹¦ <em>self-signed.crt</em> çš„å†…éƒ¨ç»“æ„ï¼›</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$ openssl x509 -text -noout -in domain.crt
</span></span></code></pre></td></tr></table>
</div>
</div><p>å†…å®¹å¦‚ä¸‹ï¼Œ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Certificate:
</span></span><span class="line"><span class="cl">    Data:
</span></span><span class="line"><span class="cl">        Version: 3 (0x2)
</span></span><span class="line"><span class="cl">        Serial Number:
</span></span><span class="line"><span class="cl">            9f:56:fd:f5:9d:13:2e:d2
</span></span><span class="line"><span class="cl">        Signature Algorithm: sha1WithRSAEncryption
</span></span><span class="line"><span class="cl">        Issuer: C=CN, ST=ChengDu, L=ChengDu, O=HRX, OU=HRX, CN=HRX/emailAddress=comedshang@163.com
</span></span><span class="line"><span class="cl">        Validity
</span></span><span class="line"><span class="cl">            Not Before: May 27 13:42:23 2017 GMT
</span></span><span class="line"><span class="cl">            Not After : May 27 13:42:23 2018 GMT
</span></span><span class="line"><span class="cl">        Subject: C=CN, ST=ChengDu, L=ChengDu, O=HRX, OU=HRX, CN=HRX/emailAddress=comedshang@163.com
</span></span><span class="line"><span class="cl">        Subject Public Key Info:
</span></span><span class="line"><span class="cl">            Public Key Algorithm: rsaEncryption
</span></span><span class="line"><span class="cl">            RSA Public Key: (2048 bit)
</span></span><span class="line"><span class="cl">                Modulus (2048 bit):
</span></span><span class="line"><span class="cl">                    00:e5:06:e7:94:b4:ff:ad:ae:26:9c:2c:76:2e:d2:
</span></span><span class="line"><span class="cl">                    c7:f6:b3:51:9a:15:1f:d6:6f:ee:f7:7b:13:61:b5:
</span></span><span class="line"><span class="cl">                    d5:07:de:6f:e4:78:05:cc:b3:74:fc:c4:ec:7f:07:
</span></span><span class="line"><span class="cl">                    c7:b3:1b:c3:b6:c5:e8:9a:00:48:5c:e3:7c:51:e2:
</span></span><span class="line"><span class="cl">                    34:1d:0e:e0:2f:4f:3d:4a:68:e3:fd:b4:c2:79:7f:
</span></span><span class="line"><span class="cl">                    f3:ac:24:6d:71:d6:44:7a:97:7a:10:e0:5b:2e:1c:
</span></span><span class="line"><span class="cl">                    80:91:71:4c:45:e8:97:2c:5d:30:68:1c:2a:28:96:
</span></span><span class="line"><span class="cl">                    24:1a:a2:40:ad:d8:aa:9b:d8:3b:89:e4:eb:a0:77:
</span></span><span class="line"><span class="cl">                    a4:1f:ab:5f:7d:8e:82:37:1d:c5:f5:9d:d6:5a:19:
</span></span><span class="line"><span class="cl">                    ea:5e:57:35:f9:ba:63:66:f0:4c:48:97:22:8f:2f:
</span></span><span class="line"><span class="cl">                    bf:7f:51:fe:bf:20:01:3c:17:11:9d:82:01:7c:f5:
</span></span><span class="line"><span class="cl">                    31:04:c7:33:10:75:5c:2a:b0:ae:d1:12:fe:6e:b9:
</span></span><span class="line"><span class="cl">                    5b:cf:67:1e:78:b6:ae:87:70:65:f8:c6:88:c6:10:
</span></span><span class="line"><span class="cl">                    7c:58:f5:7e:15:8a:47:97:9c:e1:68:7b:ed:7c:db:
</span></span><span class="line"><span class="cl">                    e5:6a:de:c1:4b:a1:05:6d:da:1e:bf:44:f9:05:6b:
</span></span><span class="line"><span class="cl">                    bb:c3:41:f3:f5:a8:39:7a:2b:eb:ac:d9:61:30:bf:
</span></span><span class="line"><span class="cl">                    0d:56:54:f8:39:b9:fc:01:93:5a:1d:aa:bf:2f:c8:
</span></span><span class="line"><span class="cl">                    30:97
</span></span><span class="line"><span class="cl">                Exponent: 65537 (0x10001)
</span></span><span class="line"><span class="cl">        X509v3 extensions:
</span></span><span class="line"><span class="cl">            X509v3 Subject Key Identifier: 
</span></span><span class="line"><span class="cl">                CB:3C:17:D8:D4:F1:C2:7C:00:57:46:48:1F:9B:A2:4F:DA:9A:92:66
</span></span><span class="line"><span class="cl">            X509v3 Authority Key Identifier: 
</span></span><span class="line"><span class="cl">                keyid:CB:3C:17:D8:D4:F1:C2:7C:00:57:46:48:1F:9B:A2:4F:DA:9A:92:66
</span></span><span class="line"><span class="cl">                DirName:/C=CN/ST=ChengDu/L=ChengDu/O=HRX/OU=HRX/CN=HRX/emailAddress=comedshang@163.com
</span></span><span class="line"><span class="cl">                serial:9F:56:FD:F5:9D:13:2E:D2
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            X509v3 Basic Constraints: 
</span></span><span class="line"><span class="cl">                CA:TRUE
</span></span><span class="line"><span class="cl">    Signature Algorithm: sha1WithRSAEncryption
</span></span><span class="line"><span class="cl">        b1:6e:10:48:3c:4b:d1:4d:6e:5c:14:34:79:89:e0:95:3e:48:
</span></span><span class="line"><span class="cl">        3d:53:6c:65:64:ce:90:e2:da:17:2f:e2:8e:13:6a:1c:e2:d8:
</span></span><span class="line"><span class="cl">        b9:4c:f2:24:19:60:64:ae:66:cb:e6:82:de:a5:22:40:8e:50:
</span></span><span class="line"><span class="cl">        94:4c:5f:87:6e:f6:c4:be:ff:3b:75:eb:3a:f5:eb:aa:47:c4:
</span></span><span class="line"><span class="cl">        5c:14:d9:7d:38:ee:28:8c:96:8f:22:a1:85:63:a9:e3:23:d2:
</span></span><span class="line"><span class="cl">        64:fe:50:dd:ab:4e:53:f6:f7:67:c1:ec:39:89:20:04:f1:3f:
</span></span><span class="line"><span class="cl">        f1:18:5a:ab:77:eb:02:d3:93:34:ca:e8:81:6b:6f:60:5c:9d:
</span></span><span class="line"><span class="cl">        b7:1f:e9:be:cb:9a:b2:73:47:52:d7:d6:89:ce:34:4c:46:3c:
</span></span><span class="line"><span class="cl">        c3:73:9f:93:07:72:41:d4:64:f9:f1:52:56:78:ac:96:fe:da:
</span></span><span class="line"><span class="cl">        b5:c0:b3:8f:e0:5e:8c:a3:bf:21:d7:99:27:ff:65:e4:62:8c:
</span></span><span class="line"><span class="cl">        15:14:8f:bb:04:54:30:4e:5e:32:a8:8c:ab:70:27:14:99:5e:
</span></span><span class="line"><span class="cl">        9b:11:dc:0a:e8:d4:59:8b:98:de:30:b3:5e:f2:8c:e4:b3:2b:
</span></span><span class="line"><span class="cl">        62:07:9a:74:52:c0:e3:54:4c:86:4b:cd:88:f3:6b:1a:c8:66:
</span></span><span class="line"><span class="cl">        d6:ab:1d:c5:12:e2:66:0a:01:a8:3d:0c:f8:d4:ac:1d:74:80:
</span></span><span class="line"><span class="cl">        83:06:3f:6d
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¤‡æ³¨ï¼Œè¦å‚çœ‹å…¶å®ƒè¯ä¹¦ç±»å‹çš„å†…å®¹ï¼Œå‚è€ƒ <a
  href="https://www.digitalocean.com/community/tutorials/openssl-essentials-working-with-ssl-certificates-private-keys-and-csrs#view-certificates"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>https://www.digitalocean.com/community/tutorials/openssl-essentials-working-with-ssl-certificates-private-keys-and-csrs#view-certificates</a></p>
<p>ä¸€äº›ç‰¹æ€§ï¼Œ</p>
<ul>
<li>é¦–å…ˆï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸åƒ ğ¶ğ´CA è¯ä¹¦é‚£æ ·æœ‰å¤šå±‚è¯ä¹¦ç»“æ„ï¼Œè‡ªç­¾åè¯ä¹¦åªæœ‰ä¸€å±‚è¯ä¹¦ç»“æ„ï¼›ä¹Ÿå°±æ˜¯æ²¡æœ‰ Certificate Chain çš„æ¦‚å¿µï¼›</li>
<li>å†æ¬¡ï¼Œå¯ä»¥çœ‹åˆ° <em>Issuer</em> å‘å¸ƒè€…å’Œè¯ä¹¦æ‹¥æœ‰è€… <em>Subject</em> æ˜¯ç›¸åŒçš„ï¼Œéƒ½æ˜¯ <em>C=CN, ST=ChengDu, L=ChengDu, O=HRX, OU=HRX, <a
  href="mailto:CN=HRX/emailAddress=comedshang@163.com"
  
  
  
  
  
>CN=HRX/emailAddress=comedshang@163.com</a></em>ï¼Œè¡¨æ˜è¯ä¹¦çš„ç­¾åæ–¹å’Œè¯ä¹¦è‡ªå·±æ˜¯åŒä¸€ä¸ªæœºæ„(æˆ–è€…è§’è‰²)ï¼Œè¿™ä¹Ÿå°±æ˜¯<code>è‡ªç­¾å</code>å‘½åçš„ç”±æ¥ï¼›</li>
</ul>
<p>å…³é”®å†…å®¹ï¼Œ</p>
<ul>
<li>Subject Public Key Info
è¿™æ®µå†…å®¹å°±æ˜¯å…¬é’¥çš„å†…å®¹äº†ï¼›</li>
<li>Signature Algorithm: sha1WithRSAEncryption
è¿™æ®µå†…å®¹å°±è¡¨ç¤ºå¯¹å…¬é’¥å’Œèº«ä»½ä¿¡æ¯ä¸€èµ·çš„ç­¾åä¿¡æ¯äº†ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œé‡‡ç”¨çš„æ˜¯ ğ‘†ğ»ğ´1SHA1 ç®—æ³•ï¼›</li>
</ul>
<p>æœ€åï¼Œæ¯”è¾ƒé‡è¦çš„æ˜¯ï¼Œå› ä¸ºè¯¥è¯ä¹¦åªæœ‰ä¸€å±‚ï¼Œæ‰€ä»¥ï¼Œè‡ªç­¾åè¯ä¹¦åœ¨é€šè®¯è¿‡ç¨‹ä¸­æ‰®æ¼”çš„ä¹Ÿå°±æ˜¯ Root Certificateï¼Œé€šå¸¸æ˜¯éœ€è¦è¢«åŠ è½½å¦‚å®¢æˆ·ç«¯çš„ trust store ä¸­ï¼›</p>
<h1 id="å¦‚ä½•ä¿è¯å†…ç½‘é€šè®¯çš„å®‰å…¨æ€§">å¦‚ä½•ä¿è¯å†…ç½‘é€šè®¯çš„å®‰å…¨æ€§</h1>
<p>æ¯”å¦‚å†…ç½‘ä¸­ï¼ŒAlice æƒ³å’Œ Bob ä¿æŒå¯é çš„åŠ å¯†é€šè®¯ï¼›</p>
<ul>
<li>
<p>é¦–å…ˆï¼ŒAlice éœ€è¦ç”Ÿæˆç§˜é’¥ ğ¾ğ‘Kp ä»¥åŠè‡ªç­¾åè¯ä¹¦ ğ¶ğ‘ ğ‘’ğ‘™ğ‘“Cself</p>
</li>
<li>
<p>ç„¶åï¼ŒBob é€šè¿‡æŸç§æ–¹å¼å°† Alice çš„ ğ¶ğ‘ ğ‘’ğ‘™ğ‘“Cself åŠ å…¥è‡ªå·±çš„ trust store ä¸­ï¼›
æ³¨æ„ï¼Œå¦‚æœ Bob æ˜¯é€šè¿‡æµè§ˆå™¨è®¿é—®çš„ Alice ç«™ç‚¹ï¼Œé‚£ä¹ˆæµè§ˆå™¨ä¼šæç¤ºï¼Œæ˜¯å¦ç›¸ä¿¡è¯¥è¯ä¹¦ï¼Œå¦‚æœé€‰æ‹©ç›¸ä¿¡ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨å°†è¯¥ ğ¶ğ‘ ğ‘’ğ‘™ğ‘“Cself è¯ä¹¦åŠ å…¥è‡ªå·±çš„ trust store ä¸­ï¼›</p>
</li>
<li>
<p>ä¹‹åï¼ŒæŸä¸ªæ—¶åˆ»ï¼ŒBob å‘ Alice å‘èµ·å®‰å…¨é€šè®¯çš„ä¼šè¯ï¼ŒåŒæ–¹æ¡æ‰‹è¿‡ç¨‹ä¸­ï¼Œ</p>
</li>
<li>
<p>Alice å°† ğ¶â€²ğ‘ ğ‘’ğ‘™ğ‘“Cselfâ€² (X.509 è‡ªç­¾å)è¯ä¹¦å‘é€ç»™ Bob</p>
</li>
<li>
<p>Bob é€šè¿‡ trust store ä¸­ä¹‹å‰é¢„åŠ è½½çš„ ğ¶ğ‘ ğ‘’ğ‘™ğ‘“Cself ä¸­æ‰€æŒ‡æ˜çš„ç­¾åç®—æ³•å¯¹ ğ¶â€²ğ‘ ğ‘’ğ‘™ğ‘“Cselfâ€² è¿›è¡Œç­¾åï¼Œå¾—åˆ°ç­¾å ğ‘†â€²Sâ€²</p>
</li>
<li>
<p>æœ€å Bob ä½¿ç”¨ trust store ä¸­ ğ¶ğ‘ ğ‘’ğ‘™ğ‘“Cself çš„ç­¾å ğ‘†S ä¸ ğ‘†â€²Sâ€² è¿›è¡Œæ¯”è¾ƒï¼Œ</p>
</li>
<li>
<p>è‹¥ç›¸ç­‰ï¼Œåˆ™è¡¨ç¤º Alice å½“å‰å‘é€è¿‡æ¥çš„è¯ä¹¦æ˜¯å¯é çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå…¶èº«ä»½ä¿¡æ¯å’Œå…¬é’¥æ˜¯åˆæ³•çš„ï¼Œæ²¡æœ‰è¢«ä¼ªé€ è¿‡ï¼›</p>
</li>
<li>
<p>è‹¥ä¸ç­‰ï¼Œåˆ™è¡¨ç¤º Alice å½“å‰å‘é€è¿‡æ¥çš„è¯ä¹¦æ˜¯ä¸å¯é çš„ï¼Œå…¶èº«ä»½ä¿¡æ¯æˆ–è€…æ˜¯å…¬é’¥æ˜¯è¢«ç¯¡æ”¹è¿‡çš„ï¼›åº”å½“ç«‹å³åœæ­¢ä¸ Alice çš„é€šè®¯ï¼›è¿™ç§æƒ…å†µä¸‹ï¼Œå¾€å¾€ä¼šæç¤ºæ¡æ‰‹å¤±è´¥ï¼Œè¯ä¹¦ä¸å¯é ï¼›</p>
</li>
</ul>
<p>ä½†åˆ‡è®°ï¼Œåœ¨å…¬ç½‘ä¸­ä½¿ç”¨è‡ªç­¾åè¯ä¹¦çš„ SSL åŠ å¯†é€šè®¯çš„æ–¹å¼æ˜¯ä¸å¯é çš„ï¼Œå…¶æ ¹æœ¬åŸå› æ˜¯ï¼Œå› ä¸ºæ²¡æœ‰å…¬é’¥åŸºç¡€è®¾æ–½çš„æ”¯æŒï¼Œå…¶è‡ªç­¾åè¯ä¹¦å¾ˆå®¹æ˜“è¢«ä¼ªé€ ï¼›è¿™éƒ¨åˆ†å†…å®¹åœ¨ä¹‹å‰çš„ <a
  href="https://www.shangyang.me/2017/05/25/encrypt-rsa-pki/"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>RSA(äº”) PKI (Public Key Infrastructure) å…¬é’¥åŸºç¡€è®¾æ–½</a> ç­‰ç³»åˆ—æ–‡ç« ä¸­æœ‰è¿‡è¯¦ç»†çš„é˜è¿°ï¼Œæœ‰å…´è¶£çš„è¯»è€…å¯ä»¥ä»è¿™é‡Œå¼€å§‹ï¼›</p>
<h1 id="å¦‚ä½•åŠ å…¥-trust-store">å¦‚ä½•åŠ å…¥ trust store</h1>
<p>å‚è€ƒå¦‚ä¸‹çš„å‡ ç¯‡æ–‡ç« ï¼Œ</p>
<p>openssl with Apache:</p>
<p><a
  href="https://www.digitalocean.com/community/tutorials/how-to-create-a-self-signed-ssl-certificate-for-apache-in-ubuntu-16-04"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>How To Create a Self-Signed SSL Certificate for Apache in Ubuntu 16.04</a></p>
<p><a
  href="https://www.akadia.com/services/ssh_test_certificate.html"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>How to create a self-signed SSL Certificate for Apache</a></p>
<p>java keytool series:</p>
<dl>
<dt>Tomcat SSL Installation Instructions</dt>
<dd><a
  href="https://www.sslshopper.com/tomcat-ssl-installation-instructions.html"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>https://www.sslshopper.com/tomcat-ssl-installation-instructions.html</a></dd>
</dl>
<p>java keytool - Key and Certificate Management Tool: <a
  href="http://docs.oracle.com/javase/1.5.0/docs/tooldocs/solaris/keytool.html"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>http://docs.oracle.com/javase/1.5.0/docs/tooldocs/solaris/keytool.html</a></p>
<p>Import a private key into a Java Key Store: <a
  href="http://commandlinefanatic.com/cgi-bin/showarticle.cgi?article=art049"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>http://commandlinefanatic.com/cgi-bin/showarticle.cgi?article=art049</a></p>
]]></description>
</item><item>
  <title>RSA(å…­) X.509 CA è¯ä¹¦</title>
  <link>https://ronin-zc.com/rsa%E5%85%AD-x.509-ca-%E8%AF%81%E4%B9%A6/</link>
  <pubDate>Wed, 03 Mar 2021 13:46:25 &#43;0800</pubDate>
  <author>RoninZc</author>
  <guid>https://ronin-zc.com/rsa%E5%85%AD-x.509-ca-%E8%AF%81%E4%B9%A6/</guid>
  <description><![CDATA[<h1 id="å‰è¨€">å‰è¨€</h1>
<p>ç”±å‰æ–‡ <a
  href="https://www.shangyang.me/2017/05/25/encrypt-rsa-pki/"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>RSA(äº”) PKI (Public Key Infrastructure) å…¬é’¥åŸºç¡€è®¾æ–½</a>å¯çŸ¥ï¼ŒCA è¯ä¹¦æˆæƒä¸­å¿ƒé¢å‘ç»™ç”¨æˆ·çš„æ˜¯ä¸€å¼  <em>X.509 è¯ä¹¦</em>ï¼›æœ¬ç¯‡æ–‡ç« ï¼Œåšä¸»å°†å¸¦é¢†å¤§å®¶ä¸€æ¢ <em>X.509 è¯ä¹¦</em>çš„ç©¶ç«Ÿï¼›</p>
<p>é‡è¦ï¼šæœ¬æ–‡ä¸ºä½œè€…çš„åŸåˆ›ä½œå“ï¼Œè½¬è½½éœ€æ³¨æ˜å‡ºå¤„ï¼›</p>
<blockquote>
<p>è½¬è½½è‡³<code>https://www.shangyang.me/2017/05/27/encrypt-rsa-selfsigned-certificate/</code></p>
</blockquote>
<h1 id="é€šè¿‡-csr-ç”³è¯·-x509-ca-è¯ä¹¦">é€šè¿‡ CSR ç”³è¯· X509 CA è¯ä¹¦</h1>
<p>è¿™é‡Œå¤§è‡´è®²è§£å¦‚ä½•ç”³è¯· <em>X.509 CA</em> è¯ä¹¦çš„æµç¨‹ï¼Œ</p>
<ol>
<li>ç”¨æˆ·å…ˆåœ¨æœ¬åœ°é€šè¿‡ RSA ç”Ÿæˆä¸€å¯¹å…¬é’¥ ğ¾ğ‘Kp å’Œå¯†é’¥ ğ¾ğ‘ Ksï¼Œ</li>
<li>ç„¶åï¼Œç”¨æˆ·åœ¨æœ¬åœ°ç”Ÿæˆä¸€å¼  ğ¶ğ‘†ğ‘…CSR è¯ä¹¦ï¼Œæ—¢ <a
  href="https://en.wikipedia.org/wiki/Certificate_signing_request"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>Certificate Signing Request</a>
<ul>
<li>éœ€è¦å¡«å†™è¯¸å¦‚ä½ çš„åŸŸåï¼Œå…¬å¸åï¼Œéƒ¨é—¨åç§°ï¼ŒåŸå¸‚åï¼Œåœ°åŒºåï¼Œå›½å®¶åï¼Œç”µå­é‚®ä»¶ç­‰ç­‰è¯æ˜ä½ èº«ä»½çš„ä¿¡æ¯ï¼Œ</li>
<li>æ·»åŠ ç”¨æˆ·å…¬é’¥ ğ¾ğ‘</li>
<li>å°†ä¸Šè¿°ä¿¡æ¯é€šè¿‡ ğ¾ğ‘  è¿›è¡Œç­¾åå¾—åˆ° ğ‘†ğ‘ğ‘ ğ‘Ÿ</li>
<li>å°†ä¸Šè¿°çš„ç­¾å ğ‘†ğ‘ğ‘ ğ‘Ÿã€ğ¾ğ‘ ä»¥åŠèº«ä»½ä¿¡æ¯åˆå¹¶æˆä¸ºä¸€å¼  ğ¶ğ‘†ğ‘… è¯ä¹¦ ;
TODO: éœ€è¦åˆå¹¶ ğ‘†ğ‘ğ‘ ğ‘Ÿ å—ï¼Ÿè¿™ä¸ªè¿˜éœ€è¦è¿›ä¸€æ­¥æ±‚è¯â€¦â€¦</li>
</ul>
</li>
<li>ç”³è¯·è€…é€šè¿‡å‘ CA ä¸­å¿ƒæˆ–è€… RA ä¸­å¿ƒæäº¤ ğ¶ğ‘†ğ‘… è¯ä¹¦ï¼Œç”³è¯· <em>X.509 è¯ä¹¦</em>ï¼›</li>
<li>ğ¶ğ´ ä¸­å¿ƒç”¨å®ƒçš„å¯†é’¥ ğ¾ğ‘ (ğ‘ğ‘)Ks(ca) å¯¹ç”¨æˆ·æäº¤çš„ ğ¶ğ‘†ğ‘… è¯ä¹¦è¿›è¡Œç­¾åï¼Œå°†ç­¾åå’Œ ğ¶ğ‘†ğ‘… åˆå¹¶ç”Ÿæˆä¸€å¼  <em>X.509 è¯ä¹¦</em>ï¼›è¯¦ç»†çš„ç­¾åè¿‡ç¨‹ï¼Œ
<ul>
<li>ğ¶ğ´ ä¸­å¿ƒé€šè¿‡ç­¾åç®—æ³•(æ¯”å¦‚ MD5)å¯¹ ğ¶ğ‘†ğ‘… è¯ä¹¦è¿›è¡Œç­¾åï¼›</li>
<li>ç„¶åé€šè¿‡ ğ¾ğ‘ (ğ‘ğ‘)) å¯¹ä¸Šè¿°çš„ç­¾åè¿›è¡ŒåŠ å¯†ï¼Œå¾—åˆ°åŠ å¯†åçš„ç­¾åï¼›</li>
<li>æœ€åï¼Œå°†åŠ å¯†åçš„ç­¾åå’Œç”¨æˆ·æäº¤çš„ ğ¶ğ‘†ğ‘…åˆå¹¶æˆä¸ºä¸€å¼  <em>X.509 è¯ä¹¦</em>ï¼›</li>
</ul>
</li>
<li>æœ€åå°†è¯¥ <em>X.509 è¯ä¹¦</em> é¢å‘ç»™ç”¨æˆ·ï¼›</li>
</ol>
<p>å¤‡æ³¨ï¼Œå¦‚ä½•ç”Ÿæˆ CSR è¯ä¹¦å¯ä»¥å‚è€ƒ <a
  href="https://www.sslshopper.com/article-most-common-openssl-commands.html"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>https://www.sslshopper.com/article-most-common-openssl-commands.html</a></p>
<h1 id="è¯ä¹¦é“¾-certificate-chain">è¯ä¹¦é“¾ Certificate Chain</h1>
<h2 id="ä»€ä¹ˆæ˜¯è¯ä¹¦é“¾">ä»€ä¹ˆæ˜¯è¯ä¹¦é“¾</h2>
<p><em>X.509 è¯ä¹¦</em> ä¸­å¾€å¾€ä¸æ­¢ä¸€å¼ è¯ä¹¦ï¼Œè€Œæ˜¯ç”±ä¸€ç³»åˆ—çš„è¯ä¹¦æ‰€ç»„æˆçš„è¯ä¹¦é“¾ï¼Œé€šå¸¸åŒ…å«è¿™æ ·ä¸‰å±‚è¯ä¹¦æ‰€æ„æˆçš„è¯ä¹¦é“¾ï¼Œ</p>
<p></p>
<ol>
<li>root certificateï¼Œæ ¹è¯ä¹¦</li>
<li>intermediates certificatesï¼Œä¸€ç³»åˆ—ä¸­é—´è¯ä¹¦</li>
<li>end-user certificateï¼Œç»ˆç«¯ç”¨æˆ·è¯ä¹¦</li>
</ol>
<p>ç›¸ä¿¡å¤§éƒ¨åˆ†è¯»è€…ä¼šå’Œæˆ‘ä¸€æ ·ï¼Œè¿·æƒ‘ï¼Œä¸ºä»€ä¹ˆä¸€å¼  <em>X.509</em> è¯ä¹¦è¦æå¾—è¿™ä¹ˆå¤æ‚ï¼Ÿ</p>
<p>è¿™æ ·åšå…¶å®æ˜¯æœ‰å†å²åŸå› çš„ï¼Œé‚£æ˜¯å› ä¸ºéšç³»ç»Ÿå’Œæµè§ˆå™¨é¢„å®‰è£…çš„æ ¹è¯ä¹¦æ¯•ç«Ÿæ˜¯æœ‰é™çš„ï¼Œå¾€å¾€å°±é‚£ä¹ˆäº›ï¼Œä¸€æ—¦ç³»ç»Ÿå·²ç»å‘å¸ƒï¼Œå¤§éƒ¨åˆ†ç”¨æˆ·ä¹Ÿå·²ç»å®‰è£…å¥½äº†ï¼ŒRoot Certificate æ—¢æ ¹è¯ä¹¦å°±æ²¡æœ‰åŠæ³•å†é€šè¿‡é¢„å®‰è£…çš„æ–¹å¼æ¥è¿›è¡Œæ‰©å……äº†ï¼›ä½†æ˜¯æˆ‘ä»¬çŸ¥é“ï¼Œä¼šæœ‰æ—¥æ–°æœˆå¼‚çš„æ–°çš„ CA å…¬å¸æˆç«‹ï¼Œå¹¶è¢«å…è®¸æˆæƒé¢å‘ <em>X.509</em> è¯ä¹¦ï¼Œæ¯•ç«Ÿï¼Œæˆ‘ä»¬è¦å…è®¸å¸‚åœºçš„å……åˆ†ç«äº‰ï¼Œé‚£ä¹ˆå®ƒä»¬çš„å…¬é’¥å¦‚ä½•é¢„å®‰è£…åˆ°å®¢æˆ·ç«¯çš„æµè§ˆå™¨å’Œæ“ä½œç³»ç»Ÿä¸Šå‘¢ï¼Ÿå¦‚æœä¸èƒ½é¢„å®‰è£…ï¼Œç”±å‰æ–‡<a
  href="https://www.shangyang.me/2017/05/25/encrypt-rsa-pki/#%e5%a6%82%e4%bd%95%e4%bf%9d%e8%af%81%e5%85%ac%e9%92%a5%e4%b8%8d%e8%a2%ab%e7%af%a1%e6%94%b9%e7%9a%84"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>å¦‚ä½•ä¿è¯å…¬é’¥ä¸è¢«ç¯¡æ”¹çš„</a>åˆ†æå¯çŸ¥ï¼Œå®ƒä»¬æ‰€é¢å‘çš„è¯ä¹¦æ˜¯ä¸å¯é çš„ï¼Œæ˜¯å¯ä»¥è¢«ç¯¡æ”¹çš„ï¼›é‚£ä¹ˆå¦‚ä½•è°ƒå’Œè¿™ä¸ªçŸ›ç›¾å‘¢ï¼Ÿè¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ</p>
<p>äºæ˜¯ï¼Œintermediates certificates ä¸­é—´è¯ä¹¦å°±å‡ºç°äº†ï¼Œè¿™äº›è¯ä¹¦å°±æ˜¯è¡¨ç¤ºç”± Root Certificate è¯ä¹¦æ‰€ç­¾åè®¤è¯çš„è¯ä¹¦ï¼Œè¿™æ ·ï¼Œæ–°çš„ CA å…¬å¸æ‰€é¢å‘çš„è¯ä¹¦å¯ä»¥ç”± Root Certificate è¿›è¡Œè®¤è¯ï¼Œä¿è¯å…¶åˆæ³•æ€§å’Œå¯é æ€§ï¼Œè¿™æ ·å°±å……åˆ†å…è®¸äº†æ–°çš„ CA å…¬å¸æˆç«‹å¹¶å‚ä¸ CA è¿™å—å¸‚åœºçš„ç«äº‰äº†ï¼›</p>
<p>ä¸‹é¢ï¼Œå°±ç”¨è¿™ä¹ˆä¸€ä¸ªå½¢è±¡çš„ä¾‹å­æ¥æè¿°ï¼Œæ¯”å¦‚ï¼Œæœ‰ä¸€å¤©ï¼Œä¸­å›½æˆç«‹äº†ä¸€å®¶ ShangYang å…¬å¸ï¼Œè¯¥å…¬å¸çš„ä¸»è¥ä¸šåŠ¡å°±æ˜¯ä¸ºå¹¿å¤§å®¢æˆ·è¿›è¡Œè¯ä¹¦æˆæƒï¼Œå‚ä¸ CA é¢†åŸŸçš„å•†ä¸šç«äº‰ï¼›é‚£ä¹ˆè¿™ä¸ªæ—¶å€™å‘¢ï¼Œæˆ‘éœ€è¦å‘æŒç®¡ Root Certificate çš„æœºæ„æäº¤ç”³è¯·ï¼Œè¯·å®ƒç­¾åæˆ‘çš„ CA å…¬é’¥ (è¯´å¥½çš„å¸‚åœºå……åˆ†ç«äº‰å‘¢ï¼ŸRoot Certificate æœºæ„ä¸å°±æ˜¯èµ¤è£¸è£¸çš„å„æ–­æœºæ„ï¼Ÿè°çŸ¥é“å‘¢..)ï¼Œç”Ÿæˆä¸€å¼  intermediates certificate ä¸­é—´è¯ä¹¦ï¼›è¿™æ ·ï¼Œç”± ShangYang å…¬å¸æ‰€ç­¾åçš„è¯ä¹¦å°±å¾—åˆ°äº† Root Certificate çš„è®¤è¯ï¼Œé‚£ä¹ˆç”±è¯¥å…¬å¸æ‰€é¢å‘çš„ <em>X.509</em> è¯ä¹¦å°±æ˜¯åˆæ³•ï¼Œæ­£è§„çš„äº†ï¼›</p>
<p>ç”±æ­¤ï¼Œæˆ‘ä»¬ä¹Ÿèƒ½å¤Ÿå¤§è‡´çŸ¥é“æ•´ä¸ªè¯ä¹¦é“¾çš„éªŒè¯è¿‡ç¨‹äº†ï¼Œè¯ä¹¦é“¾çš„éªŒè¯è¿‡ç¨‹å°†ä¼šåœ¨åç»­<a
  href="/images/RSA/#%e8%af%81%e4%b9%a6%e9%93%be%e7%9a%84%e9%aa%8c%e8%af%81%e8%bf%87%e7%a8%8b"
  
  
  
  
  
>è¯ä¹¦é“¾çš„éªŒè¯è¿‡ç¨‹</a>è¿›è¡Œè¯¦ç»†çš„æè¿°ï¼›</p>
<p>æ€»ç»“ä¸€ä¸‹ï¼Œ</p>
<p>æ ¹è¯ä¹¦æ˜¯è¢«é¢„è£…åˆ°å®¢æˆ·ç«¯ç”µè„‘æˆ–è€…ç”¨æˆ·å…¶å®ƒç»ˆç«¯è®¾å¤‡ä¸Šçš„(æ¯”å¦‚æ‰‹æœº)ï¼Œå®ƒçš„ä½œç”¨ä¸»è¦æ˜¯éªŒè¯ CA è¯ä¹¦ç­¾åçš„åˆæ³•æ€§ï¼Œä¹Ÿå°±æ˜¯ä¿è¯ CA çš„è¯ä¹¦(å« CA çš„å…¬é’¥)çš„åˆæ³•æ€§ï¼›æœ€åï¼Œend-user certificate ç»ˆç«¯ç”¨æˆ·è¯ä¹¦ï¼Œè¯¥è¯ä¹¦ç”± CA çš„è¯ä¹¦ä¿è¯å…¶åˆæ³•æ€§ï¼›æ‰€ä»¥ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œå„ä¸ªè¯ä¹¦çš„éªŒè¯è¿‡ç¨‹æ˜¯ä¸€ç¯æ‰£ä¸€ç¯çš„ï¼Œæ ¹è¯ä¹¦éªŒè¯ CA è¯ä¹¦çš„åˆæ³•æ€§ï¼ŒCA è¯ä¹¦éªŒè¯ç”¨æˆ·è¯ä¹¦çš„åˆæ³•æ€§ï¼›</p>
<h2 id="è¯ä¹¦é“¾ä¸­æ¯ä¸ªè¯ä¹¦æ‰€åŒ…å«çš„å†…å®¹">è¯ä¹¦é“¾ä¸­æ¯ä¸ªè¯ä¹¦æ‰€åŒ…å«çš„å†…å®¹</h2>
<p>æˆ‘ä»¬æ¥çœ‹çœ‹ wikipedia.org çš„ <em>X.509</em> è¯ä¹¦çš„æƒ…å†µï¼Œä»–æ˜¯ç”± GlobalSign æœºæ„é¢å‘çš„ï¼Œ</p>
<h3 id="end-useræˆ–-end-entity-certificate-æ—¢ç»ˆç«¯ç”¨æˆ·è¯ä¹¦">End-user(æˆ– End-entity) certificate æ—¢ç»ˆç«¯ç”¨æˆ·è¯ä¹¦</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Certificate:
</span></span><span class="line"><span class="cl">    Data:
</span></span><span class="line"><span class="cl">        Version: 3 (0x2)
</span></span><span class="line"><span class="cl">        Serial Number:
</span></span><span class="line"><span class="cl">            10:e6:fc:62:b7:41:8a:d5:00:5e:45:b6
</span></span><span class="line"><span class="cl">    Signature Algorithm: sha256WithRSAEncryption
</span></span><span class="line"><span class="cl">        Issuer: C=BE, O=GlobalSign nv-sa, CN=GlobalSign Organization Validation CA - SHA256 - G2
</span></span><span class="line"><span class="cl">        Validity
</span></span><span class="line"><span class="cl">            Not Before: Nov 21 08:00:00 2016 GMT
</span></span><span class="line"><span class="cl">            Not After : Nov 22 07:59:59 2017 GMT
</span></span><span class="line"><span class="cl">        Subject: C=US, ST=California, L=San Francisco, O=Wikimedia Foundation, Inc., CN=*.wikipedia.org
</span></span><span class="line"><span class="cl">        Subject Public Key Info:
</span></span><span class="line"><span class="cl">            Public Key Algorithm: id-ecPublicKey
</span></span><span class="line"><span class="cl">                Public-Key: (256 bit)
</span></span><span class="line"><span class="cl">                pub: 
</span></span><span class="line"><span class="cl">                    04:c9:22:69:31:8a:d6:6c:ea:da:c3:7f:2c:ac:a5:
</span></span><span class="line"><span class="cl">                    af:c0:02:ea:81:cb:65:b9:fd:0c:6d:46:5b:c9:1e:
</span></span><span class="line"><span class="cl">                    ed:b2:ac:2a:1b:4a:ec:80:7b:e7:1a:51:e0:df:f7:
</span></span><span class="line"><span class="cl">                    c7:4a:20:7b:91:4b:20:07:21:ce:cf:68:65:8c:c6:
</span></span><span class="line"><span class="cl">                    9d:3b:ef:d5:c1
</span></span><span class="line"><span class="cl">                ASN1 OID: prime256v1
</span></span><span class="line"><span class="cl">                NIST CURVE: P-256
</span></span><span class="line"><span class="cl">        X509v3 extensions:
</span></span><span class="line"><span class="cl">            X509v3 Key Usage: critical
</span></span><span class="line"><span class="cl">                Digital Signature, Key Agreement
</span></span><span class="line"><span class="cl">            Authority Information Access: 
</span></span><span class="line"><span class="cl">                CA Issuers - URI:http://secure.globalsign.com/cacert/gsorganizationvalsha2g2r1.crt
</span></span><span class="line"><span class="cl">                OCSP - URI:http://ocsp2.globalsign.com/gsorganizationvalsha2g2
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            X509v3 Certificate Policies: 
</span></span><span class="line"><span class="cl">                Policy: 1.3.6.1.4.1.4146.1.20
</span></span><span class="line"><span class="cl">                  CPS: https://www.globalsign.com/repository/
</span></span><span class="line"><span class="cl">                Policy: 2.23.140.1.2.2
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            X509v3 Basic Constraints: 
</span></span><span class="line"><span class="cl">                CA:FALSE
</span></span><span class="line"><span class="cl">            X509v3 CRL Distribution Points: 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                Full Name:
</span></span><span class="line"><span class="cl">                  URI:http://crl.globalsign.com/gs/gsorganizationvalsha2g2.crl
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            X509v3 Subject Alternative Name: 
</span></span><span class="line"><span class="cl">                DNS:*.wikipedia.org, DNS:*.m.mediawiki.org, DNS:*.m.wikibooks.org, DNS:*.m.wikidata.org, DNS:*.m.wikimedia.org, DNS:*.m.wikimediafoundation.org, DNS:*.m.wikinews.org, DNS:*.m.wikipedia.org, DNS:*.m.wikiquote.org, DNS:*.m.wikisource.org, DNS:*.m.wikiversity.org, DNS:*.m.wikivoyage.org, DNS:*.m.wiktionary.org, DNS:*.mediawiki.org, DNS:*.planet.wikimedia.org, DNS:*.wikibooks.org, DNS:*.wikidata.org, DNS:*.wikimedia.org, DNS:*.wikimediafoundation.org, DNS:*.wikinews.org, DNS:*.wikiquote.org, DNS:*.wikisource.org, DNS:*.wikiversity.org, DNS:*.wikivoyage.org, DNS:*.wiktionary.org, DNS:*.wmfusercontent.org, DNS:*.zero.wikipedia.org, DNS:mediawiki.org, DNS:w.wiki, DNS:wikibooks.org, DNS:wikidata.org, DNS:wikimedia.org, DNS:wikimediafoundation.org, DNS:wikinews.org, DNS:wikiquote.org, DNS:wikisource.org, DNS:wikiversity.org, DNS:wikivoyage.org, DNS:wiktionary.org, DNS:wmfusercontent.org, DNS:wikipedia.org
</span></span><span class="line"><span class="cl">            X509v3 Extended Key Usage: 
</span></span><span class="line"><span class="cl">                TLS Web Server Authentication, TLS Web Client Authentication
</span></span><span class="line"><span class="cl">            X509v3 Subject Key Identifier: 
</span></span><span class="line"><span class="cl">                28:2A:26:2A:57:8B:3B:CE:B4:D6:AB:54:EF:D7:38:21:2C:49:5C:36
</span></span><span class="line"><span class="cl">            X509v3 Authority Key Identifier: 
</span></span><span class="line"><span class="cl">                keyid:96:DE:61:F1:BD:1C:16:29:53:1C:C0:CC:7D:3B:83:00:40:E6:1A:7C
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    Signature Algorithm: sha256WithRSAEncryption
</span></span><span class="line"><span class="cl">         8b:c3:ed:d1:9d:39:6f:af:40:72:bd:1e:18:5e:30:54:23:35:
</span></span><span class="line"><span class="cl">         ...
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸Šé¢è¿™å¼ è¯ä¹¦å°±æ˜¯ wikipedia.org çš„ç»ˆç«¯ç”¨æˆ·è¯ä¹¦äº†ï¼Œçœ‹çœ‹å‡ ä¸ªå…³é”®çš„å±æ€§</p>
<ol>
<li>
<p>Subject</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Subject: C=US, ST=California, L=San Francisco, O=Wikimedia Foundation, Inc., CN=*.wikipedia.org
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯ä»¥çœ‹åˆ°è¯¥è¯ä¹¦çš„ä¸»ä½“ç»“æ„ï¼Œè¡¨ç¤ºè¯¥è¯ä¹¦çš„ä¸»ä½“æœºæ„æ˜¯ wikipedia.orgï¼Œä»¥åŠç›¸å…³çš„ä¸€äº›é™„å±ä¿¡æ¯ï¼Œæ¯”å¦‚å›½å®¶ï¼Œåœ°åŸŸï¼Œå…¬å¸åç§°ç­‰ç­‰ï¼›</p>
</li>
<li>
<p>Subject Alternative Name
è¡¨è¿°äº†è¯¥è¯ä¹¦è¿˜å¯ä»¥ç”¨åœ¨å“ªäº›åŸŸåä¸Šï¼Œè¿™é‡Œå®šä¹‰äº†å¥½äº›å…¶å®ƒçš„å¯ç”¨åŸŸåçš„éªŒè¯ä¸Šï¼Œ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">X509v3 Subject Alternative Name: 
</span></span><span class="line"><span class="cl">  DNS:*.wikipedia.org, DNS:*.m.mediawiki.org, DNS:*.m.wikibooks.org, DNS:*.m.wikidata.org, DNS:*.m.wikimedia.org, DNS:*.m.wikimediafoundation.org, DNS:*.m.wikinews.org, DNS:*.m.wikipedia.org, DNS:*.m.wikiquote.org, DNS:*.m.wikisource.org, DNS:*.m.wikiversity.org, DNS:*.m.wikivoyage.org, DNS:*.m.wiktionary.org, DNS:*.mediawiki.org, DNS:*.planet.wikimedia.org, DNS:*.wikibooks.org, DNS:*.wikidata.org, DNS:*.wikimedia.org, DNS:*.wikimediafoundation.org, DNS:*.wikinews.org, DNS:*.wikiquote.org, DNS:*.wikisource.org, DNS:*.wikiversity.org, DNS:*.wikivoyage.org, DNS:*.wiktionary.org, DNS:*.wmfusercontent.org, DNS:*.zero.wikipedia.org, DNS:mediawiki.org, DNS:w.wiki, DNS:wikibooks.org, DNS:wikidata.org, DNS:wikimedia.org, DNS:wikimediafoundation.org, DNS:wikinews.org, DNS:wikiquote.org, DNS:wikisource.org, DNS:wikiversity.org, DNS:wikivoyage.org, DNS:wiktionary.org, DNS:wmfusercontent.org, DNS:wikipedia.org
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>Subject Public Key</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Subject Public Key Info:
</span></span><span class="line"><span class="cl">    Public Key Algorithm: id-ecPublicKey
</span></span><span class="line"><span class="cl">        Public-Key: (256 bit)
</span></span><span class="line"><span class="cl">        pub: 
</span></span><span class="line"><span class="cl">            04:c9:22:69:31:8a:d6:6c:ea:da:c3:7f:2c:ac:a5:
</span></span><span class="line"><span class="cl">            af:c0:02:ea:81:cb:65:b9:fd:0c:6d:46:5b:c9:1e:
</span></span><span class="line"><span class="cl">            ed:b2:ac:2a:1b:4a:ec:80:7b:e7:1a:51:e0:df:f7:
</span></span><span class="line"><span class="cl">            c7:4a:20:7b:91:4b:20:07:21:ce:cf:68:65:8c:c6:
</span></span><span class="line"><span class="cl">            9d:3b:ef:d5:c1
</span></span><span class="line"><span class="cl">        ASN1 OID: prime256v1
</span></span><span class="line"><span class="cl">        NIST CURVE: P-256
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™å°±æ˜¯ç»ˆç«¯ç”¨æˆ·çš„å…¬é’¥ä¿¡æ¯äº†ï¼Œæ³¨æ„ï¼Œè¿™é‡Œçš„å…¬é’¥å¹¶ä¸æ˜¯é‡‡ç”¨çš„ RSA ç®—æ³•ï¼Œè€Œæ˜¯é‡‡ç”¨çš„ DSA ç®—æ³•ï¼Œå…·ä½“å¯å‚è€ƒ <a
  href="https://en.wikipedia.org/wiki/ECDSA"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>ECDSA</a>ï¼›</p>
</li>
<li>
<p>Signature Algorithm
è¿™éƒ¨åˆ†å†…å®¹è¡¨ç¤ºæ‰€ç”¨çš„ç­¾åç®—æ³•ä»¥åŠè¢« CA ä¸­å¿ƒç­¾ååçš„å†…å®¹ï¼Œ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Signature Algorithm: sha256WithRSAEncryption
</span></span><span class="line"><span class="cl">    8b:c3:ed:d1:9d:39:6f:af:40:72:bd:1e:18:5e:30:54:23:35:
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯ä»¥çœ‹åˆ°ï¼Œè¯¥ç­¾åç®—æ³•æ˜¯é‡‡ç”¨çš„ SHA256 ç®—æ³•ï¼Œå¹¶é€šè¿‡ RSA åŠ å¯†(è¿™é‡Œæ˜¯é€šè¿‡ CA çš„ç§é’¥åŠ å¯†)ï¼Œæ‰€ä»¥è¿™é‡Œå¾—åˆ°çš„å…¶å®æ˜¯è¢« CA ç§é’¥åŠ å¯†åçš„ SHA ç­¾åï¼›åé¢å¯¹åº” <em>8b:c3:ed:d1:9d:39:6f:af:40:72:bd:1e:18:5e:30:54:23:35:</em> å°±æ˜¯è¯¥åŠ å¯†åçš„ç­¾åï¼›</p>
</li>
</ol>
<p>ä»å‰é¢çš„ç³»åˆ—æ–‡ç«  <a
  href="https://www.shangyang.me/2017/05/25/encrypt-rsa-pki/"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>RSA(äº”) PKI (Public Key Infrastructure) å…¬é’¥åŸºç¡€è®¾æ–½</a>æˆ‘ä»¬çŸ¥é“ï¼Œç»ˆç«¯ç”¨æˆ·å…¬é’¥ç­¾åæ˜¯éœ€è¦è¢«ç›¸å…³çš„ CA è¯ä¹¦éªŒè¯çš„(æ—¢æ˜¯é€šè¿‡ CA çš„å…¬é’¥è¿›è¡Œè§£å¯†éªŒè¯)ï¼›é‚£ä¹ˆå®ƒæ˜¯å¦‚ä½•æ‰¾åˆ°å¯¹åº”çš„ CA è¯ä¹¦å¹¶è¿›è¡ŒéªŒè¯çš„å‘¢ï¼Ÿé€šè¿‡ç»ˆç«¯ç”¨æˆ·è¯ä¹¦ä¸­çš„ä¸¤ä¸ªå­—æ®µï¼›</p>
<ol>
<li>
<p>Issuer</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Issuer: C=BE, O=GlobalSign nv-sa, CN=GlobalSign Organization Validation CA - SHA256 - G2
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯ä»¥æ˜æ˜¾çš„çœ‹åˆ°ï¼Œè¯¥ç”¨æˆ·ç»ˆç«¯è¯ä¹¦æ˜¯ç”± <strong>GlobalSign</strong> ğ¶ğ´CA ä¸­å¿ƒè¿›è¡ŒéªŒè¯å¹¶ç­¾å‘çš„ã€‚</p>
</li>
<li>
<p>Authority Key Identifier</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">X509v3 Authority Key Identifier: 
</span></span><span class="line"><span class="cl">           keyid:96:DE:61:F1:BD:1C:16:29:53:1C:C0:CC:7D:3B:83:00:40:E6:1A:7C
</span></span></code></pre></td></tr></table>
</div>
</div><p>ğ¶ğ´ä¸­å¿ƒçš„èº«ä»½ ğ¼ğ·</p>
</li>
</ol>
<p>é‚£é¡¾åæ€ä¹‰ï¼Œç»ˆç«¯ç”¨æˆ·è¯ä¹¦å°†ä¼šæ‰¾åˆ°ä¸ <em>Issuer</em> å’Œ <em>Authority Key Identifier</em> ä¸¤è€…éƒ½åŒ¹é…çš„ ğ¶ğ´ è¯ä¹¦æ¥å¯¹å®ƒè¿›è¡ŒéªŒè¯ï¼›å¥½äº†ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬çœ‹çœ‹ ğ¶ğ´ è¯ä¹¦é•¿ä»€ä¹ˆæ ·ï¼Œä¹Ÿå°±æ˜¯ <em>Intermediate certificate</em>ï¼›</p>
<h3 id="intermediate-certificate-æ—¢-ca-è¯ä¹¦">Intermediate certificate æ—¢ CA è¯ä¹¦</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Certificate:
</span></span><span class="line"><span class="cl">    Data:
</span></span><span class="line"><span class="cl">        Version: 3 (0x2)
</span></span><span class="line"><span class="cl">        Serial Number:
</span></span><span class="line"><span class="cl">            04:00:00:00:00:01:44:4e:f0:42:47
</span></span><span class="line"><span class="cl">    Signature Algorithm: sha256WithRSAEncryption
</span></span><span class="line"><span class="cl">        Issuer: C=BE, O=GlobalSign nv-sa, OU=Root CA, CN=GlobalSign Root CA
</span></span><span class="line"><span class="cl">        Validity
</span></span><span class="line"><span class="cl">            Not Before: Feb 20 10:00:00 2014 GMT
</span></span><span class="line"><span class="cl">            Not After : Feb 20 10:00:00 2024 GMT
</span></span><span class="line"><span class="cl">        Subject: C=BE, O=GlobalSign nv-sa, CN=GlobalSign Organization Validation CA - SHA256 - G2
</span></span><span class="line"><span class="cl">        Subject Public Key Info:
</span></span><span class="line"><span class="cl">            Public Key Algorithm: rsaEncryption
</span></span><span class="line"><span class="cl">                Public-Key: (2048 bit)
</span></span><span class="line"><span class="cl">                Modulus:
</span></span><span class="line"><span class="cl">                    00:c7:0e:6c:3f:23:93:7f:cc:70:a5:9d:20:c3:0e:
</span></span><span class="line"><span class="cl">                    ...
</span></span><span class="line"><span class="cl">                Exponent: 65537 (0x10001)
</span></span><span class="line"><span class="cl">        X509v3 extensions:
</span></span><span class="line"><span class="cl">            X509v3 Key Usage: critical
</span></span><span class="line"><span class="cl">                Certificate Sign, CRL Sign
</span></span><span class="line"><span class="cl">            X509v3 Basic Constraints: critical
</span></span><span class="line"><span class="cl">                CA:TRUE, pathlen:0
</span></span><span class="line"><span class="cl">            X509v3 Subject Key Identifier:
</span></span><span class="line"><span class="cl">                96:DE:61:F1:BD:1C:16:29:53:1C:C0:CC:7D:3B:83:00:40:E6:1A:7C
</span></span><span class="line"><span class="cl">            X509v3 Certificate Policies:
</span></span><span class="line"><span class="cl">                Policy: X509v3 Any Policy
</span></span><span class="line"><span class="cl">                  CPS: https://www.globalsign.com/repository/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            X509v3 CRL Distribution Points:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                Full Name:
</span></span><span class="line"><span class="cl">                  URI:http://crl.globalsign.net/root.crl
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            Authority Information Access:
</span></span><span class="line"><span class="cl">                OCSP - URI:http://ocsp.globalsign.com/rootr1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            X509v3 Authority Key Identifier:
</span></span><span class="line"><span class="cl">                keyid:60:7B:66:1A:45:0D:97:CA:89:50:2F:7D:04:CD:34:A8:FF:FC:FD:4B
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    Signature Algorithm: sha256WithRSAEncryption
</span></span><span class="line"><span class="cl">         46:2a:ee:5e:bd:ae:01:60:37:31:11:86:71:74:b6:46:49:c8:
</span></span><span class="line"><span class="cl">         ...
</span></span></code></pre></td></tr></table>
</div>
</div><p><em>Intermidate certificate</em> æ—¢æ˜¯ ğ¶ğ´ è¯ä¹¦ï¼Œæ˜¯ç”¨æ¥éªŒè¯ç”¨æˆ·ç»ˆç«¯è¯ä¹¦(æ—¢ <em>End-entity certificate</em>)çš„ï¼›é€šè¿‡ä¸¤ä¸ªå­—æ®µæ¥åŒ¹é…ç”¨æˆ·ç»ˆç«¯è¯ä¹¦ï¼Œ</p>
<ul>
<li>
<p>ğ¶ğ´ è¯ä¹¦ä¸­çš„ <em>Issuer</em> å’Œç”¨æˆ·ç»ˆç«¯è¯ä¹¦ä¸­çš„ <em>Issuer</em> ç›¸åŒ¹é…</p>
</li>
<li></li>
</ul>
<p>ğ¶ğ´</p>
<p>è¯ä¹¦ä¸­çš„</p>
<p>Subject Key Identifier</p>
<p>ä¸ç”¨æˆ·ç»ˆç«¯è¯ä¹¦ä¸­çš„</p>
<p>Authority Key Identifier</p>
<p>ç›¸åŒ¹é…ï¼›</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">X509v3 Subject Key Identifier:
</span></span><span class="line"><span class="cl">              96:DE:61:F1:BD:1C:16:29:53:1C:C0:CC:7D:3B:83:00:40:E6:1A:7C
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸ ğ¶ğ´ è¯ä¹¦ç›¸åŒ¹é…çš„ç”¨æˆ·ç»ˆç«¯è¯ä¹¦å°†ä¼šè¢«è¯¥ ğ¶ğ´ è¯ä¹¦æ‰€éªŒè¯ï¼›</p>
<h3 id="root-certificate-æ—¢æ ¹è¯ä¹¦">Root Certificate æ—¢æ ¹è¯ä¹¦</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Certificate:
</span></span><span class="line"><span class="cl">    Data:
</span></span><span class="line"><span class="cl">        Version: 3 (0x2)
</span></span><span class="line"><span class="cl">        Serial Number:
</span></span><span class="line"><span class="cl">            04:00:00:00:00:01:15:4b:5a:c3:94
</span></span><span class="line"><span class="cl">    Signature Algorithm: sha1WithRSAEncryption
</span></span><span class="line"><span class="cl">        Issuer: C=BE, O=GlobalSign nv-sa, OU=Root CA, CN=GlobalSign Root CA
</span></span><span class="line"><span class="cl">        Validity
</span></span><span class="line"><span class="cl">            Not Before: Sep  1 12:00:00 1998 GMT
</span></span><span class="line"><span class="cl">            Not After : Jan 28 12:00:00 2028 GMT
</span></span><span class="line"><span class="cl">        Subject: C=BE, O=GlobalSign nv-sa, OU=Root CA, CN=GlobalSign Root CA
</span></span><span class="line"><span class="cl">        Subject Public Key Info:
</span></span><span class="line"><span class="cl">            Public Key Algorithm: rsaEncryption
</span></span><span class="line"><span class="cl">                Public-Key: (2048 bit)
</span></span><span class="line"><span class="cl">                Modulus:
</span></span><span class="line"><span class="cl">                    00:da:0e:e6:99:8d:ce:a3:e3:4f:8a:7e:fb:f1:8b:
</span></span><span class="line"><span class="cl">                    ...
</span></span><span class="line"><span class="cl">                Exponent: 65537 (0x10001)
</span></span><span class="line"><span class="cl">        X509v3 extensions:
</span></span><span class="line"><span class="cl">            X509v3 Key Usage: critical
</span></span><span class="line"><span class="cl">                Certificate Sign, CRL Sign
</span></span><span class="line"><span class="cl">            X509v3 Basic Constraints: critical
</span></span><span class="line"><span class="cl">                CA:TRUE
</span></span><span class="line"><span class="cl">            X509v3 Subject Key Identifier: 
</span></span><span class="line"><span class="cl">                60:7B:66:1A:45:0D:97:CA:89:50:2F:7D:04:CD:34:A8:FF:FC:FD:4B
</span></span><span class="line"><span class="cl">    Signature Algorithm: sha1WithRSAEncryption
</span></span><span class="line"><span class="cl">         d6:73:e7:7c:4f:76:d0:8d:bf:ec:ba:a2:be:34:c5:28:32:b5:
</span></span><span class="line"><span class="cl">         ...
</span></span></code></pre></td></tr></table>
</div>
</div><p><em>Intermediate certificate</em> æ—¢æ˜¯ ğ¶ğ´ è¯ä¹¦å°†ä¼šè¢« <em>Root certificate</em> è¿›è¡ŒéªŒè¯ï¼Œå¹¶ä¸” <em>Root certificate</em> æ˜¯è¯ä¹¦éªŒè¯é“¾ä¸­çš„æœ€åä¸€ç¯ï¼Œæ‰€ä»¥çš„éªŒè¯å°†ä¼šåˆ°æ­¤ä¸ºæ­¢ï¼›é‚£ä¹ˆ ğ¶ğ´ è¯ä¹¦åˆæ˜¯å¦‚ä½•æ‰¾åˆ°å¯¹åº”çš„ <em>Root certificate</em> è¿›è¡ŒéªŒè¯çš„å‘¢ï¼Ÿä¸»è¦é€šè¿‡å¦‚ä¸‹çš„è§„åˆ™è¿›è¡ŒåŒ¹é…</p>
<ol>
<li>ğ¶ğ´ è¯ä¹¦ä¸­çš„ <em>Issuer</em> éœ€è¦ä¸ <em>Root certificate</em> ä¸­çš„ <em>Issuer</em> åŒ¹é…</li>
<li>ğ¶ğ´ è¯ä¹¦ä¸­çš„ <em>Authority Key Identifier</em> å­—æ®µéœ€è¦ä¸ <em>Root certificate</em> è¯ä¹¦ä¸­çš„ <em>Subject Key Identifier</em> å­—æ®µç›¸åŒ¹é…</li>
</ol>
<p>è¿™æ ·ï¼Œä¸ä¹‹åŒ¹é…çš„ ğ¶ğ´ è¯ä¹¦å°†ä¼šç”±è¯¥ <em>Root certificate</em> è¯ä¹¦è¿›è¡ŒéªŒè¯ï¼›</p>
<p>æœ€åï¼Œéœ€è¦å¼ºè°ƒçš„æ˜¯ï¼Œğ¶ğ´ è¯ä¹¦å¹¶ä¸ä¼šéšæµè§ˆå™¨å’Œç³»ç»Ÿçš„å®‰è£…è€Œé¢„å®‰è£…åˆ°ç”¨æˆ·çš„è®¾å¤‡ä¸Šï¼Œ<code>è¢«é¢„å®‰è£…åˆ°ç”¨æˆ·è®¾å¤‡ä¸Šçš„åªæœ‰ Root certificate</code>ï¼›è¿™æ ·å‘¢ï¼Œå°±ä¿è¯äº†ç»ˆç«¯ç”¨æˆ·çš„å…¬é’¥çš„å¯é æ€§å’Œå®‰å…¨æ€§ï¼›å¦å¤–ï¼Œé€šè¿‡ <em>Root certificate</em> ä¼šè¢«å®‰è£…åˆ°ç³»ç»Ÿçš„ <a
  href="https://en.wikipedia.org/wiki/Public_key_certificate#Root_programs"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>trust store</a>ä¸­ï¼Œä¸»æµçš„æœ‰</p>
<ul>
<li><a
  href="https://technet.microsoft.com/en-us/library/cc751157.aspx"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>Microsoft Root Program</a></li>
<li><a
  href="https://www.apple.com/certificateauthority/ca_program.html"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>Apple Root Program</a></li>
<li><a
  href="https://www.mozilla.org/en-US/about/governance/policies/security-group/certs/policy/"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>Mozilla Root Program</a></li>
<li><a
  href="http://www.oracle.com/technetwork/java/javase/javasecarootcertsprogram-1876540.html"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>Oracle Java root program</a></li>
<li>Adobe <a
  href="https://helpx.adobe.com/acrobat/kb/approved-trust-list2.html"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>AATL</a> and <a
  href="https://blogs.adobe.com/documentcloud/eu-trusted-list-now-available-in-adobe-acrobat/"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>EUTL</a> root programs (used for document signing)</li>
</ul>
<p>åç»­æœ‰æ—¶é—´çš„è¯ï¼Œå‡†å¤‡å¯¹ Java çš„ trust store è¿›è¡Œä¸€ä¸‹æ¢³ç†å’Œä»‹ç»ï¼›</p>
<h2 id="è¯ä¹¦é“¾çš„éªŒè¯è¿‡ç¨‹">è¯ä¹¦é“¾çš„éªŒè¯è¿‡ç¨‹</h2>
<p>æœ‰äº†ä¸Šè¿°åˆ†æä»¥åï¼Œè¯ä¹¦é“¾çš„éªŒè¯è¿‡ç¨‹å°±æ˜¾è€Œæ˜“è§äº†</p>
<ul>
<li>End-user certificate é€šè¿‡ ğ¶ğ´ è¯ä¹¦è¿›è¡ŒéªŒè¯</li>
<li>ğ¶ğ´ è¯ä¹¦ç»è¿‡ Root certificate è¯ä¹¦è¿›è¡ŒéªŒè¯</li>
<li>å®Œæ¯•</li>
</ul>
<h1 id="å®è·µ">å®è·µ</h1>
<p>é‚£ä¹ˆè¿™é‡Œä½œè€…å¸¦é¢†å¤§å®¶é€šè¿‡ CSR çš„æ–¹å¼ç”³è¯·ä¸€ä¸ªå…è´¹çš„ CA è¯ä¹¦ï¼Œç°åœ¨é€šè¿‡é˜¿é‡Œäº‘å¯ä»¥å…è´¹ç”³è¯·ä¸€ä¸ªå›ºå®šåŸŸåçš„ Symantec çš„ CA è¯ä¹¦ï¼›</p>
<ol>
<li>
<p>ç™»å½•é˜¿é‡Œäº‘äº§å“ä¸­å¿ƒï¼Œé€‰æ‹©å®‰å…¨ -&gt; CA è¯ä¹¦</p>
</li>
<li>
<p>ç„¶åé€‰æ‹©å…è´¹çš„ DV ç±»å‹çš„è¯ä¹¦</p>
</li>
<li>
<p>è´­ä¹°å¥½äº†ä»¥åï¼Œè¿›å…¥ç®¡ç†åå°ç®¡ç†ï¼Œè¿›å…¥å®‰å…¨ï¼ˆäº‘ç›¾ï¼‰-&gt; è¯ä¹¦æœåŠ¡ï¼Œç„¶åå¯¹è¯ä¹¦è¿›è¡Œè¡¥å…¨è¡¥å…¨æ—¢æ˜¯éœ€è¦ç”¨æˆ·è‡ªå·±æäº¤ CSR ç”³è¯·è¯ä¹¦ï¼›</p>
</li>
<li>
<p>å¡«å†™åŸŸåä¿¡æ¯ï¼Œæ³¨æ„ï¼Œè¿™é‡Œåªèƒ½ç»‘å®šä¸€ä¸ªå”¯ä¸€çš„åŸŸåï¼Œä¸”ä¸èƒ½å†™ä»»ä½•çš„é€šé…ç¬¦</p>
</li>
<li>
<p>ä¸‹ä¸€æ­¥å°†ä¼šå¡«å†™ä¸€äº›ä¸ªäººä¿¡æ¯ï¼Œæ¯”å¦‚å§“åã€æ‰‹æœºå·ç ã€åœ°å€ç­‰è¿™é‡Œè¦å¼ºè°ƒçš„æ˜¯ï¼Œé˜¿é‡Œäº‘éœ€è¦éªŒè¯åŸŸåçš„å½’å±ï¼Œæ—¢éªŒè¯è¯¥åŸŸåçš„ç¡®å½’ä½ æ‰€æœ‰ï¼›å¯ä»¥é€šè¿‡ DNS å’Œ æ–‡ä»¶ çš„ä¸¤ç§æ–¹å¼è¿›è¡ŒéªŒè¯ï¼›è¿™é‡Œå‘¢ï¼Œæˆ‘é€‰æ‹©çš„æ˜¯é€šè¿‡ DNS éªŒè¯ï¼ŒéªŒè¯çš„å¤§è‡´è¿‡ç¨‹æ˜¯ï¼Œé˜¿é‡Œä¼šå‘ä½ çš„ç”³è¯·é‚®ç®±ä¸­å‘é€ä¸€ä»½é‚®ä»¶ï¼Œé‚®ä»¶çš„å†…å®¹ä¸­åŒ…å«äº†å¦‚ä½•éªŒè¯åŸŸåçš„æ–¹æ³•ï¼Œé‡Œé¢åŒ…å«ä¸€æ¡ç”¨äºéªŒè¯çš„ TXT è®°å½•ï¼Œè¿™ä¸ªéœ€è¦åˆ°ä¸ªäººåŸŸåç®¡ç†ä¸­å¿ƒå»é…ç½® TXT è½¬å‘è§„åˆ™å³å¯ï¼›</p>
</li>
<li>
<p>å¥½äº†ï¼Œè¿™ä¸€æ­¥æ˜¯å…³é”®äº†ï¼Œè¿™é‡Œæœ‰ä¸¤ä¸ªé€‰é¡¹ï¼Œç”±ç³»ç»Ÿç”Ÿæˆ CSR æˆ–è€…è‡ªå·±ç”Ÿæˆ CSRï¼Œè¿™é‡Œä¸ºäº†æ¼”ç¤ºè‡ªæäº¤ CSR è¯ä¹¦ç”³è¯·çš„æ–¹å¼ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬é€‰æ‹©è‡ªå·±ç”Ÿæˆ CSR</p>
</li>
<li>
<p>ä½¿ç”¨ openssl å‘½ä»¤ç”Ÿæˆ CSR</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$ openssl req -out CSR.csr -new -newkey rsa:2048 -nodes -keyout private.key
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶åæç¤ºè¾“å…¥å›½å®¶ã€åœ°å€ã€å§“åã€åŸŸåã€é‚®ç®±ç­‰ç­‰ä¿¡æ¯ï¼›å¦‚æœæ˜¯ä¸ºå…¬å¸ç”³è¯·é‚®ç®±ï¼Œé‚£ä¹ˆè¿™é‡Œå¡«å†™å…¬å¸ç›¸å…³ä¿¡æ¯å³å¯ï¼›è¿™é‡Œ<code>å°¤å…¶</code>è¦<code>æ³¨æ„</code>çš„æ˜¯ï¼Œåœ¨è¾“å…¥åŸŸåçš„æ—¶å€™ï¼Œå¿…é¡»ä¸ç¬¬ 4 æ­¥çš„åŸŸåç›¸åŒ¹é…ï¼Œå¦åˆ™ç¬¬ 9 æ­¥å®¡æ ¸ä¸èƒ½é€šè¿‡ï¼Œè¾“å…¥åŸŸåçš„æ—¶å€™ï¼Œæç¤ºè¾“å…¥ <em>Common Name (e.g. server FQDN or YOUR name) []</em> çš„ä¿¡æ¯ï¼›æœ€åä¼šåœ¨æœ¬åœ°ç”Ÿæˆä¸¤ä¸ªæ–‡ä»¶ï¼ŒCSR.csr å’Œ private.key</p>
</li>
<li>
<p>ç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€ CSR.csrï¼Œå¯ä»¥çœ‹åˆ°å¤§è‡´å†…å®¹å¦‚ä¸‹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">-----BEGIN CERTIFICATE REQUEST-----
</span></span><span class="line"><span class="cl">MIIC3DCCAcQCAQAwgZYxCzAJBgNVBAYTAkNOMRAwDgYDVQQIEwdTaWNodWFuMRAw
</span></span><span class="line"><span class="cl">DgYDVQQHEwdDaGVuZ2R1MRQwEgYDVQQKEwtIdWlSb25nWGluZzEUMBIGA1UECxML
</span></span><span class="line"><span class="cl">SHVpUm9uZ1hpbmcxFDASBgNVBAMTC0h1aVJvbmdYaW5nMSEwHwYJKoZIhvcNAQkB
</span></span><span class="line"><span class="cl">FhJodWlyb25neGluZ0BocnguYWkwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEK
</span></span><span class="line"><span class="cl">AoIBAQC7MY7hTjbv7DkGoDTmvQ2toAe8nMTlQGPh+r4VvD+zzEiEudFPEI1cIFLr
</span></span><span class="line"><span class="cl">BLTfSyn9Awv7lgIjhJ4ghDkjAGwHnrTxzvldjfZkpKuBK9H8Vy2t7sorgoxEBF7j
</span></span><span class="line"><span class="cl">VbiiTBtSG6+ZNw8esqt5EECT19aP/RyJp65f8lysHwcHmZmVGaDq/VwQcbyuI6Vs
</span></span><span class="line"><span class="cl">ko/7sSchOAgUWn66oS+xw7mGYR212mQv6Bz0g0L1NVep8Doz8O2pWPHT1ZOdpBDU
</span></span><span class="line"><span class="cl">rzJJxHXzUgKVgYsAgMBAAGgADANBgkqhkiG9w0BAQUFAAOCAQEA
</span></span><span class="line"><span class="cl">V6rSXeGO4Z0q2sZ9gbdUBmpQ8AAdloByhd1BcwHuHt/nfPj59L3CT3EnTEez7cDt
</span></span><span class="line"><span class="cl">RUCbI2FbThBFfjngfTNE3PjsTsheCdAxoV6yRPo7Fpb5AKkhXDra1jjVjsY0maFl
</span></span><span class="line"><span class="cl">N23okpDCMzmUD2peKqumYhdHBw8wB3Y5HZQxxq688DwlHn0bLnylUPk/hDfuMzIs
</span></span><span class="line"><span class="cl">5vLIyDSGQiCwq9sU8wjhQOXqzZ37FgJcZ8GyvaJ3kUWDlLDPIGMiXQ0p4T39/ZaE
</span></span><span class="line"><span class="cl">my/C0JxSLiAKJs3L2f7HfKwUoRZDDnCS0WMdQunvxC4Dd7hyddCij6E1ExnT7EzC
</span></span><span class="line"><span class="cl">kiPq8xiGl2HRGW/JfWC3XA==
</span></span><span class="line"><span class="cl">-----END CERTIFICATE REQUEST-----
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯ä»¥çœ‹åˆ°ï¼Œæ˜¯ä¸€ä¸ªç»è¿‡ Base64 ç¼–ç çš„ PEM æ ¼å¼çš„å†…å®¹ï¼›</p>
</li>
<li>
<p>å°†ä¸Šè¿°å†…å®¹å¤åˆ¶ï¼Œç²˜è´´åˆ°é˜¿é‡Œè¯ä¹¦æœåŠ¡é¡µé¢ï¼Œç‚¹å‡»ä¿å­˜æ³¨æ„ç¬¬ 7 æ­¥çš„æè¿°ï¼Œå¿…é¡»ä¿è¯ CSR ä¸­çš„åŸŸååœ°å€ä¸ç¬¬ 4 æ­¥ç”³è¯·çš„æ—¶å€™å¡«å†™çš„åŸŸååœ°å€ç›¸åŒ¹é…æ‰è¡Œï¼›</p>
</li>
<li>
<p>éªŒè¯åŸŸåçš„å½’å±
ç”±äºç¬¬ 5 æ­¥ä¸­ï¼Œä½œè€…æ˜¯é€‰æ‹©çš„ DNS éªŒè¯çš„æ–¹å¼ï¼Œæ‰€ä»¥ï¼Œç¬¬ 9 æ­¥å®Œæˆä»¥åï¼Œé˜¿é‡Œä¼šå‘é€ä¸€å°é‚®ä»¶åŒ…å«éœ€è¦éªŒè¯çš„ TXT è®°å½•å€¼ï¼Œè¿™é‡Œåªéœ€è¦åˆ°åŸŸåç®¡ç†ä¸­å¿ƒé…ç½®ä¸€ä¸‹ TXT å€¼ï¼Œå³å¯éªŒè¯é€šè¿‡ï¼›åŸŸåç®¡ç†ä¸­å¿ƒé…ç½®å¥½äº†ä»¥åï¼Œå¤§è‡´å†…å®¹å¦‚ä¸‹ï¼Œä¸è¿‡ï¼Œæœ‰æ—¶å€™ï¼Œé‚®ä»¶è¿Ÿè¿Ÿä¸å‘é€ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œä½ å¯ä»¥ç›´æ¥ç‚¹å‡»<code>è¿›åº¦</code>æŒ‰é’®ï¼Œä¹Ÿå¯ä»¥æ˜¾ç¤ºç›¸å…³çš„ TXT è®°å½•ï¼›</p>
</li>
<li>
<p>ç”³è¯·æˆåŠŸï¼Œå½“éªŒè¯é€šè¿‡ä»¥åï¼ŒçŠ¶æ€ä¾¿ä¼šå˜ä¸º<code>å·²ç­¾å‘</code>è¿™ä¸ªæ—¶å€™ï¼Œä½ å°±å¯ä»¥åœ¨è¯ä¹¦ç®¡ç†åå°ä¸­å»ä¸‹è½½è¯¥ CA è¯ä¹¦äº†..</p>
</li>
</ol>
<p>All doneâ€¦</p>
<p>åè®°äº 2018-01-30 1:21 pm
é˜¿é‡Œäº‘ä¸ŠéªŒè¯åŸŸåå½’å±çš„æ­¥éª¤æœ‰å˜åŒ–ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢çš„ç¬¬ 10 æ­¥ï¼Œåœ¨æ·»åŠ ä¸»æœºè®°å½•çš„æ—¶å€™å‰é¢è¦åŠ ä¸Š _dnsauth å‰ç¼€æ‰è¡Œï¼Œå¦‚å›¾

å¹¶ä¸”ä¸å†å‘é‚®ä»¶æç¤ºé…ç½®çŸ¥å·±è®°å½• TXT å€¼äº†ï¼›å¯¹åº”çš„åŸŸåé…ç½®å¦‚ä¸‹ï¼Œ
</p>
<p>æ›´å¤šè¯¦æƒ…å‚è€ƒ <a
  href="https://bbs.aliyun.com/read/573056.html?spm=a2c4e.11155515.0.0.kL3FVf"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>https://bbs.aliyun.com/read/573056.html?spm=a2c4e.11155515.0.0.kL3FVf</a></p>
<h1 id="åç»­">åç»­</h1>
<p>è¿™é‡Œä¸»è¦è®²è§£çš„æ˜¯é€šè¿‡ ğ¶ğ´ ç­¾åçš„è¯ä¹¦ï¼Œé‚£å¦‚æœï¼Œåªæ˜¯å†…ç½‘æœåŠ¡å™¨ï¼Œä¸éœ€è¦è¿æ¥å¤–ç½‘ï¼Œé‚£ä¹ˆï¼Œå®é™…ä¸Šï¼Œæˆ‘ä¹Ÿå°±ç”¨ä¸åˆ°è¿™ç§å…¬å…±çš„åŸºç¡€è®¾æ–½æ¥ä¿è¯æˆ‘çš„è¯ä¹¦çš„åˆæ³•æ€§ï¼›è¿™ä¸ªæ—¶å€™ï¼ŒX.509 è¯ä¹¦è¿˜æä¾›äº†ä¸€ç§è‡ªç­¾åè¯ä¹¦ï¼Œä»€ä¹ˆæ„æ€å‘¢ï¼Ÿå°±æ˜¯è¯´ï¼Œä½ å¯ä»¥è‡ªå·±ç”Ÿæˆ <em>Root certificate</em>ï¼Œç„¶åå°†å®ƒåŠ å…¥ä½ æœ¬æœºçš„ trust store ä¸­ï¼Œç”¨å®ƒæ¥éªŒè¯ä½ çš„è¯ä¹¦çš„åˆæ³•æ€§ï¼Œè¿™å°±æ˜¯è‡ªç­¾åè¯ä¹¦äº†ï¼›è¯¦æƒ…å‚è€ƒ</p>
]]></description>
</item><item>
  <title>RSA(äº”) PKI (Public Key Infrastructure) å…¬é’¥åŸºç¡€è®¾æ–½</title>
  <link>https://ronin-zc.com/rsa%E4%BA%94-pki-public-key-infrastructure-%E5%85%AC%E9%92%A5%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD/</link>
  <pubDate>Wed, 03 Mar 2021 13:45:25 &#43;0800</pubDate>
  <author>RoninZc</author>
  <guid>https://ronin-zc.com/rsa%E4%BA%94-pki-public-key-infrastructure-%E5%85%AC%E9%92%A5%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD/</guid>
  <description><![CDATA[<h1 id="å‰è¨€">å‰è¨€</h1>
<p>åœ¨ä¸Šä¸€ç¯‡ã€Š<a
  href="https://www.shangyang.me/2017/05/24/encrypt-rsa-signature/"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>RSA(å››) ç­¾å Signature</a>ã€‹ç« èŠ‚<a
  href="https://www.shangyang.me/2017/05/24/encrypt-rsa-signature/#%e7%ad%be%e5%90%8d-Signature"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>ç­¾å Signature</a> ä¸­æåˆ°ï¼Œè¦ä½¿ç”¨ç­¾å(Signature)æœºåˆ¶æ¥ä¿è¯ä¿¡æ¯å†ä¼ é€’è¿‡ç¨‹ä¸­æ²¡æœ‰è¢«ç¬¬ä¸‰æ–¹æ‰€ç¯¡æ”¹ï¼Œæœ‰ä¸€ä¸ªå‰æï¼Œå°±æ˜¯å¿…é¡»ä¿è¯ï¼Œåœ¨å…¬é’¥çš„ä¼ é€’è¿‡ç¨‹ä¸­ä¸è¢«ä»–äººç¯¡æ”¹ï¼Œå¦åˆ™ï¼Œæ•´ä¸ªç­¾åæœºåˆ¶å°±å½¢åŒä¸€å¼ ç™½çº¸ï¼Œæ¯«æ— ç”¨å¤„ï¼›é‚£ä¹ˆåˆè¯¥å¦‚ä½•ä¿è¯å…¬é’¥çš„åˆæ³•æ€§ï¼Œä¿è¯å…¬é’¥æœ¬èº«æ²¡æœ‰è¢«ç¯¡æ”¹è¿‡å‘¢ï¼Ÿè¿™å°±æ˜¯ PKI å…¬é’¥åŸºç¡€è®¾æ–½è¦å®Œæˆçš„å·¥ä½œå’Œè¾¾åˆ°çš„ç›®çš„ï¼›</p>
<p>å¤‡æ³¨ï¼Œæœ¬æ–‡æ˜¯ä½œè€…çš„åŸåˆ›ä½œå“ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>
<blockquote>
<p>è½¬è½½è‡³<code>https://www.shangyang.me/2017/05/25/encrypt-rsa-pki/</code></p>
</blockquote>
<h1 id="å…¬é’¥è¢«ç¯¡æ”¹">å…¬é’¥è¢«ç¯¡æ”¹</h1>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ï¼Œåœ¨é€šè®¯è¿‡ç¨‹ä¸­ï¼Œå…¬é’¥æ˜¯å¦‚ä½•è¢«ä»–äººæ‰€ç¯¡æ”¹çš„ï¼Ÿä¹Ÿå°±æ˜¯ Man in Middle Attack æ˜¯æ€ä¹ˆåšåˆ°çš„ï¼Ÿ</p>
<p>å…ˆæ¥çœ‹ä¸€ä¸ªæ­£å¸¸çš„ï¼Œé€šè¿‡å…¬é’¥å’Œç§é’¥åŠ å¯†é€šè®¯çš„åœºæ™¯ï¼Œ</p>
<p></p>
<p>æœåŠ¡å™¨ç«¯ç”Ÿæˆå…¬é’¥å’Œç§é’¥ï¼Œå¹¶å°†å…¬é’¥é€šè¿‡ç½‘ç»œå‘é€ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯ä½¿ç”¨å…¬é’¥åŠ å¯† DES å¯¹ç§°åŠ å¯†å¯†é’¥ï¼Œç„¶åå°† DES å¯†é’¥å‘é€ç»™æœåŠ¡å™¨ç«¯ï¼Œä¹‹åï¼ŒåŒæ–¹ä¾¿å¯ä»¥è¿›è¡ŒåŠ å¯†é€šè®¯äº†ï¼›å¤‡æ³¨ï¼Œè¿™ä¹Ÿæ˜¯åŸºäº RSA åŠ å¯†é€šè®¯çš„åŸºç¡€ï¼›ä½†æ˜¯ï¼Œè¿™æ ·åšï¼Œå¹¶ä¸å¯é ï¼Œä¸‹é¢æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸ªå…¬é’¥è¢«æŒŸæŒå¹¶è¢«ç¯¡æ”¹çš„åœºæ™¯ï¼›</p>
<p></p>
<p>è¿™æ¬¡é€šè®¯çš„æ—¶å€™ï¼Œä¸å¹¸çš„æ˜¯ï¼Œå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨é€šè®¯çš„æ—¶å€™ï¼Œæ­£å¥½ç»è¿‡äº†ä¸€ä¸ªé»‘å®¢çš„è·¯ç”±å™¨ï¼Œé€šè¿‡ç½‘ç»œå—…æ¢ï¼Œå®ƒæˆªè·äº†æœåŠ¡å™¨æ‰€å‘é€çš„å…¬é’¥ï¼Œå¹¶åˆ©ç”¨è‡ªå·±çš„ç§é’¥ï¼Œç”Ÿæˆäº†ä¸€ä¸ªæ–°çš„å…¬é’¥ï¼Œå¹¶æ›¿ä»£åŸæœ‰çš„å…¬é’¥å¹¶å°†è¿™ä¸ªæ–°çš„å…¬é’¥å‘é€ç»™äº†å®¢æˆ·ç«¯ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±æ˜¯å…¬é’¥è¢«æˆªè·ï¼Œè¢«ç¯¡æ”¹çš„è¿‡ç¨‹ï¼›è€Œåï¼Œå®¢æˆ·ç«¯å°†ä½¿ç”¨è¢«ç¯¡æ”¹è¿‡åçš„å…¬é’¥è¿›è¡ŒåŠ å¯†é€šè®¯ï¼Œæ‰€ä»¥ï¼Œå‡¡æ˜¯ç»è¿‡å®¢æˆ·ç«¯åŠ å¯†çš„ä¿¡æ¯ï¼Œå…¨éƒ¨å¯ä»¥è¢«é»‘å®¢çš„ç§é’¥è§£å¯†ï¼Œä¹Ÿå°±å¯¼è‡´äº†ï¼ŒåŠ å¯†é€šè®¯<code>å½»åº•å¤±æ•ˆ</code>ï¼›æ­£æ˜¯åœ¨è¿™ç§èƒŒæ™¯ä¹‹ä¸‹ï¼ŒPKI (Public Key Infrasture) å…¬é’¥åŸºç¡€è®¾æ–½å­•è‚²è€Œç”Ÿï¼›</p>
<p>åè®°ï¼Œå‘ç°è¿˜æ¼äº†ä¸€ç¯ï¼Œé¦–å…ˆè¦çŸ¥é“çš„æ˜¯ï¼Œå½“é€šè¿‡ RSA å»ºç«‹å¥½ SSL é€šè®¯é€šé“ä»¥åï¼Œå®é™…ä¸Šï¼Œä¸ºäº†æ•ˆç‡ï¼Œè¯¥é€šé“ä¸Šæ•°æ®å®é™…ä¸Šæ˜¯é€šè¿‡å¯¹ç§°åŠ å¯†å¯†é’¥ AES è¿›è¡ŒåŠ å¯†ä¼ è¾“çš„ï¼Œæ‰€ä»¥ï¼Œèƒ½å¦ä¿è¯æ•°æ®é€šè®¯çš„å®‰å…¨æ€§çš„é‡ä¸­ä¹‹é‡çš„ç¯èŠ‚å°±æ˜¯ä¿è¯ AES å¯†é’¥åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­çš„å®‰å…¨æ€§ï¼Œæ­£å¦‚ä¸Šå›¾æ‰€æè¿°çš„é‚£æ ·ï¼Œå½“é»‘å®¢æˆªè·åˆ°åŠ å¯†åçš„ AES å¯†é’¥ä»¥åï¼Œé¦–å…ˆéœ€è¦é€šè¿‡é»‘å®¢è‡ªå·±çš„ç§é’¥å¯¹å…¶è§£å¯†ï¼Œç„¶åå†é€šè¿‡é»‘å®¢æ‰€æˆªè·çš„æœåŠ¡å™¨çš„å…¬é’¥å¯¹è¯¥ AES å¯†é’¥è¿›è¡ŒåŠ å¯†ï¼Œç„¶åå†ä¼ è¾“ç»™æœåŠ¡å™¨ç«¯ï¼Œå¦‚æœä¸è¿™æ ·åšçš„è¯ï¼ŒæœåŠ¡å™¨æ˜¯æ— æ³•é€šè¿‡å®ƒè‡ªå·±çš„ç§é’¥è§£å¯†å‡º AES å¯†é’¥çš„ï¼›ï¼ˆåè®°äº 2018-01-30 10:45AMï¼‰</p>
<h1 id="pki">PKI</h1>
<p>PKI çš„æ ¸å¿ƒèŒè´£å°±æ˜¯é€šè¿‡ä¸€äº›åˆ—çš„æªæ–½ä¿è¯å…¬é’¥çš„åˆæ³•æ€§ï¼Œé‚£ä¹ˆå®ƒæ˜¯å¦‚ä½•ä¿è¯å…¬é’¥ä¸è¢«ç¯¡æ”¹ï¼Œæ˜¯åˆæ³•çš„å‘¢ï¼Ÿ</p>
<h2 id="å¦‚ä½•ä¿è¯å…¬é’¥ä¸è¢«ç¯¡æ”¹çš„">å¦‚ä½•ä¿è¯å…¬é’¥ä¸è¢«ç¯¡æ”¹çš„</h2>
<p>æ¯”å¦‚ Alice é€šè¿‡ RSA ç”Ÿæˆäº†å…¬é’¥ ğ¾ğ‘Kp å’Œå¯†é’¥ ğ¾ğ‘ Ksï¼Œå¥¹éœ€è¦ä¸ Bob è¿›è¡Œç½‘ç»œé€šè®¯ï¼Œè€Œä¸”å¥¹å¿…é¡»é€šè¿‡ç½‘ç»œå°†å…¬é’¥ ğ¾ğ‘Kp å‘é€ç»™ Bobï¼›é‚£ä¹ˆ PKI æ˜¯å¦‚ä½•ä¿è¯æ­¤å…¬é’¥ ğ¾ğ‘Kp åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ä¸è¢«ç¯¡æ”¹çš„å‘¢ï¼Ÿ</p>
<p>ç®€è€Œè¨€ä¹‹ï¼ŒPKI çš„ç­–ç•¥å°±æ˜¯é€šè¿‡ä¸€ä¸ªç¬¬ä¸‰æ–¹æœºæ„ ğ‘€Mï¼Œè¯¥æœºæ„ ğ‘€M ä¹Ÿæœ‰è‡ªå·±çš„å…¬é’¥ ğ¾ğ‘(ğ‘š)Kp(m) å’Œå¯†é’¥ ğ¾ğ‘ (ğ‘š)Ks(m)ï¼›</p>
<p><strong>é¦–å…ˆé€šè¿‡è¯¥æœºæ„ ğ‘€M è¿›è¡Œå¦‚ä¸‹çš„æ“ä½œï¼Œ</strong></p>
<ol>
<li>Alice å°†è‡ªå·±çš„å…¬é’¥ ğ¾ğ‘Kp æäº¤ç»™ ğ‘€Mï¼›</li>
<li>ğ‘€M ä½¿ç”¨ç­¾åç®—æ³•ï¼Œæ¯”å¦‚ MD5ï¼Œå¯¹ Alice çš„åŸç”Ÿå…¬é’¥ ğ¾ğ‘Kp è¿›è¡Œç­¾åå¾—åˆ° ğ‘†ğ‘Spï¼›</li>
<li>ç„¶åå†é€šè¿‡ ğ¾ğ‘ (ğ‘š)Ks(m) å¯¹ ğ‘†ğ‘Sp è¿›è¡ŒåŠ å¯†å¾—åˆ°åŠ å¯†åçš„ç­¾å ğ¸ğ‘ ğ‘Espï¼›</li>
<li>æœ€åå°† ğ¸ğ‘ ğ‘Esp é¢å‘ç»™ Aliceï¼›</li>
</ol>
<p><strong>Alice å¦‚ä½•å°†å…¬é’¥å‘é€ç»™ Bobï¼Ÿ</strong></p>
<ul>
<li>Alice å°†åŠ å¯†åçš„ç­¾å ğ¸ğ‘ ğ‘Esp å’Œå…¬é’¥ ğ¾ğ‘Kp ä¸€èµ·å‘é€ç»™ Bobï¼›
å¤‡æ³¨ï¼Œå…¶å®ç­¾å ğ¸ğ‘ ğ‘Esp å’Œå…¬é’¥ ğ¾ğ‘Kp è¢«çº³å…¥ä¸€å¼ <code>è¯ä¹¦</code>(Certificate)ä¸­ï¼ŒAlice å‘é€ç»™ Bob çš„å…¶å®å°±æ˜¯è¿™ä¹ˆä¸€å¼ è¯ä¹¦ï¼›ä½†æ˜¯ï¼Œæ•´æ•´ X.509 è¯ä¹¦åŒ…å«çš„å†…å®¹æ¯”è¿™ä¸ªå¤æ‚è®¸å¤šï¼Œä¸è¿‡æ¦‚å¿µä¸Šæ˜¯ç­‰ä»·çš„ï¼›è¿™é‡Œï¼Œä¹Ÿå°±æ˜¯è¯ä¹¦çš„ç”±æ¥äº†ã€‚ä¸ä»…è¦çŸ¥å…¶ç„¶ï¼Œæ›´è¦çŸ¥å…¶æ‰€ä»¥ç„¶..</li>
</ul>
<p><strong>Bob å¦‚ä½•ä¿è¯æ¥æ”¶åˆ°çš„ Alice çš„å…¬é’¥æ²¡æœ‰è¢«ç¯¡æ”¹è¿‡ï¼Ÿ</strong></p>
<p>Bob æ‹¿åˆ° Alice çš„è¯ä¹¦ä»¥åï¼Œåšå¦‚ä¸‹æ“ä½œï¼Œ(ä¸ºäº†åŒºåˆ†ï¼Œè¿™é‡Œå°†ä¼ è¾“è¿‡ç¨‹ä¸­ Alice çš„å…¬é’¥å‘½åä¸º ğ¾â€²ğ‘Kpâ€²)</p>
<ol>
<li>é€šè¿‡ ğ‘€M çš„å…¬é’¥ ğ¾ğ‘(ğ‘š)Kp(m) å¯¹ ğ¸ğ‘ ğ‘Esp è¿›è¡Œè§£å¯†ï¼Œå¾—åˆ° ğ‘†ğ‘Spï¼›
æ³¨æ„ï¼Œå¦‚æœ ğ¸ğ‘ ğ‘Esp è¢«ç¯¡æ”¹äº†ï¼Œè¿™é‡Œæ˜¯æ— æ³•è§£å¯†å¾—åˆ° ğ‘†ğ‘Spï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¦ä¿è¯è§£å¯†æˆåŠŸï¼Œğ¸ğ‘ ğ‘Esp ä¸€å®šæ˜¯æ²¡æœ‰è¢«ç¯¡æ”¹è¿‡çš„ï¼›</li>
<li>ç„¶åä½¿ç”¨åŒæ–¹æ‰€çº¦å®šå¥½çš„ç­¾åç®—æ³•ï¼Œæ¯”å¦‚ MD5ï¼Œå¯¹ ğ¾â€²ğ‘Kpâ€² è¿›è¡Œç­¾åï¼Œå¾—åˆ° ğ‘†â€²ğ‘Spâ€²</li>
<li>æœ€åæ¯”è¾ƒ ğ‘†ğ‘Sp ä¸ ğ‘†â€²ğ‘Spâ€² æ˜¯å¦ç›¸ç­‰ï¼Œè‹¥ç›¸ç­‰ï¼Œåˆ™è¡¨ç¤ºå‘é€è¿‡ç¨‹ä¸­çš„å…¬é’¥ ğ¾â€²ğ‘Kpâ€² æ²¡æœ‰è¢«ç¯¡æ”¹è¿‡ï¼Œå¦åˆ™ï¼Œåˆ™å¯ä»¥æ–­è¨€ï¼Œğ¾â€²ğ‘Kpâ€² è¢«ç¯¡æ”¹è¿‡ï¼Œäºæ˜¯æ•´ä¸ªé€šè®¯ä¸å®‰å…¨ã€ä¸å¯é ï¼›</li>
</ol>
<p>ï¼ˆå¤‡æ³¨ï¼Œè¿™é‡Œçš„æœºæ„ ğ‘€M æœ‰ä¸ªè¡Œä¸šç”¨è¯­å«åš ğ¶ğ´CA æ—¢æ˜¯ <em>Certification Authority</em>ï¼›ï¼‰</p>
<p>ç­‰ç­‰ï¼Œç¬¬ä¸‰æ–¹æœºæ„ CAï¼Œåœ¨ Bob ç«¯ä½¿ç”¨ CA çš„å…¬é’¥ ğ¾ğ‘(ğ‘ğ‘)Kp(ca) å¯¹ ğ¸ğ‘ ğ‘Esp è¿›è¡Œè§£å¯†ï¼Œå¾—åˆ°ç­¾å ğ‘†ğ‘Spï¼Œé‚£å¦‚æœ CA çš„å…¬é’¥ ğ¾ğ‘(ğ‘ğ‘)Kp(ca) åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ä¹Ÿè¢«ç¯¡æ”¹äº†å‘¢ï¼Ÿå¥½é—®é¢˜ï¼Œç¬¬ä¸‰æ–¹æœºæ„ CA è‡ªèº«å¦‚ä½•ä¿è¯å…¶å…¬é’¥çš„åˆæ³•æ€§ï¼Ÿå¦‚æœä¸èƒ½ä¿è¯ CA å…¬é’¥çš„åˆæ³•æ€§ï¼Œä¸Šè¿°åŸºäºç­¾åä¿è¯ Alice å…¬é’¥åˆæ³•æ€§çš„æªæ–½ä¹Ÿå°±æ˜¯æ˜¯ä¸€çº¸ç©ºè°ˆã€‚</p>
<p><strong>é‚£ä¹ˆï¼ŒCA åˆæ˜¯å¦‚ä½•ä¿è¯è‡ªå·±çš„å…¬é’¥çš„åˆæ³•æ€§çš„å‘¢ï¼Ÿ</strong></p>
<p>è¿™é‡Œå°†è°ˆåˆ°çš„å°±æ˜¯ KPI çš„åˆä¸€å¤§ç‰¹å¾ï¼ŒåŸºç¡€è®¾æ–½ï¼›</p>
<p>ä¸ºäº†ä¿è¯ CA å…¬é’¥çš„åˆæ³•æ€§ï¼Œé€šå¸¸ï¼ŒCA æœºæ„çš„å…¬é’¥æ˜¯éšç³»ç»Ÿã€æµè§ˆå™¨ç­‰<code>é¢„å®‰è£…</code>åˆ°å®¢æˆ·ç”µè„‘ä¸Šçš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä½ åœ¨è£…ç³»ç»Ÿçš„æ—¶å€™ï¼Œæˆ–è€…åœ¨å®‰è£…æµè§ˆå™¨çš„æ—¶å€™ï¼ŒCA æœºæ„çš„å…¬é’¥(ä¸€èˆ¬æ˜¯åŒ…å«åœ¨ CA è¯ä¹¦ä¸­çš„) è¢«é¢„è£…åˆ°äº†ä½ çš„ç³»ç»Ÿæˆ–è€…æ˜¯æµè§ˆå™¨ä¸­äº†ï¼›è¿™æ ·ï¼Œé»‘å®¢å°±æ²¡æœ‰åŠæ³•é€šè¿‡ç½‘ç»œæ‹¦æˆªçš„åŠæ³•å»ç¯¡æ”¹ CA æœºæ„çš„å…¬é’¥äº†ï¼›è¿™ä¹Ÿå°±æ˜¯<code>åŸºç¡€è®¾æ–½</code>å‘½åçš„ç”±æ¥ï¼Œæ—¢ <em>Infrastructure</em>ï¼›è¿™æ ·ï¼Œä¹Ÿå°±ä¿è¯äº†é€šè¿‡ CA æœºæ„ç­¾åçš„è¯ä¹¦å³ä½¿æ˜¯åœ¨ä¸å®‰å…¨çš„ç½‘ç»œç¯å¢ƒä¸­ä¼ æ’­ï¼Œä¾ç„¶æ˜¯<code>å¯é å¹¶ä¸”æ˜¯æœ‰æ•ˆçš„</code>ï¼›</p>
<h2 id="æ¦‚å¿µæµç¨‹å›¾">æ¦‚å¿µæµç¨‹å›¾</h2>
<p>çœŸå®è¿‡ç¨‹ä¸­ï¼Œç”¨æˆ·æ˜¯é€šè¿‡ ğ¶ğ‘†ğ‘…CSR è¯ä¹¦å‘ ğ¶ğ´CA æœºæ„ç”³è¯· ğ‘‹.509X.509 è¯ä¹¦ï¼Œç”³è¯·è¿‡ç¨‹ä¸­ä¼šåŒ…å«ç”³è¯·è€…çš„åœ°å€ï¼Œå•ä½ï¼Œé‚®ç®±ç­‰ä¿¡æ¯ï¼Œæ¯”ä¸‹å›¾è¦å¤æ‚ï¼›è¿™é‡Œï¼Œä¸»è¦æ˜¯åŒ–ç¹ä¸ºç®€ï¼Œé€šè¿‡å¦‚ä¸‹çš„æ¦‚å¿µå›¾ï¼Œå°†å…¶æ ¸å¿ƒé€»è¾‘é˜è¿°æ¸…æ¥šï¼Œä¸‹é¢çš„é€»è¾‘æµç¨‹å›¾ä¸€ä¸€å¯¹åº”<a
  href="https://www.shangyang.me/2017/05/25/encrypt-rsa-pki/#%e5%a6%82%e4%bd%95%e4%bf%9d%e8%af%81%e5%85%ac%e9%92%a5%e4%b8%8d%e8%a2%ab%e7%af%a1%e6%94%b9%e7%9a%84"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>å¦‚ä½•ä¿è¯å…¬é’¥ä¸è¢«ç¯¡æ”¹çš„</a>ä¸­æ‰€æè¿°çš„æ­¥éª¤ï¼›</p>
<p></p>
<p>æ³¨æ„ä¸¤ä¸ªå…³é”®æ­¥éª¤</p>
<ul>
<li><em>Step 6.1.1</em>: æ–­å®šç­¾å ğ¸ğ‘ ğ‘Esp è¢«ç¯¡æ”¹è¿‡ï¼›
è¦èƒ½å¤Ÿæ–­å®šè¿™ç§æƒ…å†µï¼Œä¿è¯ ğ¸ğ‘ ğ‘Esp ä¸€å®šæ²¡æœ‰è¢«ç¯¡æ”¹è¿‡ï¼Œéœ€è¦å…¬é’¥åŸºç¡€è®¾æ–½(æ—¢ PKI )çš„ä¿è¯ï¼Œä¿è¯ç­¾åé¢å‘æœºæ„ ğ‘€M çš„å…¬é’¥æ˜¯æ— æ³•è¢«ç¯¡æ”¹çš„</li>
<li><em>Step 8.1</em>: ğ‘†ğ‘!=ğ‘†â€²ğ‘Sp!=Spâ€²ï¼Œåˆ™å¯ä»¥æ–­å®šå…¬é’¥æ˜¯è¢«ç¯¡æ”¹è¿‡å¾—ï¼›
è¿™é‡Œé¢æ›´æ·±å±‚æ¬¡çš„åŸå› æ˜¯ï¼Œé€šè¿‡å…¬é’¥è®¤è¯æœºæ„å¾—åˆ°çš„ç­¾å ğ‘†ğ‘Sp ä¸ Bob è‡ªå·±å¾—åˆ°çš„å…¬é’¥ç­¾å ğ‘†ğ‘Sp ä¸åŒ¹é…ï¼Œåˆ™å¯æ–­å®šï¼ŒAlice çš„å…¬é’¥ ğ¾ğ‘Kp è¢«ç¯¡æ”¹è¿‡ï¼›</li>
</ul>
<h2 id="kpi-åŒ…å«å“ªäº›å…ƒç´ ">KPI åŒ…å«å“ªäº›å…ƒç´ </h2>
<p>åœ¨ç« èŠ‚<a
  href="https://www.shangyang.me/2017/05/25/encrypt-rsa-pki/#%e5%a6%82%e4%bd%95%e4%bf%9d%e8%af%81%e5%85%ac%e9%92%a5%e4%b8%8d%e8%a2%ab%e7%af%a1%e6%94%b9%e7%9a%84"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>å¦‚ä½•ä¿è¯å…¬é’¥ä¸è¢«ç¯¡æ”¹çš„</a>ä¸­ï¼Œä½œè€…ç”¨æœ€é€šä¿—æ˜“æ‡‚çš„è¨€è¯­æè¿°äº† KPI å…¬é’¥åŸºç¡€è®¾æ–½æ˜¯å¦‚ä½•ä¿è¯å…¬é’¥çš„åˆæ³•æ€§çš„ï¼Œä»¥åŠå…¶é‡è¦æ€§ï¼›ä¸è¿‡ï¼Œåœ¨å®˜æ–¹å®šä¹‰ä¸­ï¼Œä¸¥æ ¼çš„å®šä¹‰äº†å¦‚ä¸‹çš„è§’è‰²ï¼Œ</p>
<ol>
<li>
<p>CA (Certificate Authority)ï¼Œè¯ä¹¦è®¤è¯æœºæ„
å¯¹å…¬é’¥ã€ç”¨æˆ·èº«ä»½ä¿¡æ¯ã€åŸŸåç­‰ä¿¡æ¯è¿›è¡Œç­¾åï¼Œç”Ÿæˆç›¸å…³çš„ç”µå­è¯ä¹¦ï¼›å¹¶å°†ç”µå­è¯ä¹¦é¢å‘ç»™ç”³è¯·ç”¨æˆ·ï¼›
å¦å¤–è¿˜ä¼šé€šè¿‡å…¶ä¸“æœ‰çš„åè®®æ¥åˆ¤æ–­è¯ä¹¦æ˜¯å¦æœ‰æ•ˆï¼ˆæ˜¯å¦è¶…è¿‡ä½¿ç”¨æœ‰æ•ˆæœŸï¼‰,å¦‚æœè¯ä¹¦å¤±æ•ˆï¼Œå°†ä¼šç”Ÿæˆè¯ä¹¦å›æ”¶åˆ—è¡¨æ—¢æ˜¯ certificate revocation list ï¼Œè¯¥éƒ¨åˆ†å†…å®¹æ¶‰åŠåˆ° Authority revocation lists çš„ç›¸å…³å†…å®¹ï¼Œä» <a
  href="https://en.wikipedia.org/wiki/Certificate_authority"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>https://en.wikipedia.org/wiki/Certificate_authority</a> æ‘˜è¦å…¶æ ¸å¿ƒå†…å®¹å¦‚ä¸‹ï¼Œ</p>
<blockquote>
<p>An authority revocation list (ARL) is a form of certificate revocation list (CRL) containing certificates issued to certificate authorities, contrary to CRLs which contain revoked end-entity certificates.</p>
</blockquote>
<p><a
  href="https://tools.ietf.org/html/rfc5280#section-4.1.2.6"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>https://tools.ietf.org/html/rfc5280#section-4.1.2.6</a> æ ‡æ³¨ä¸­ä¹Ÿæè¿°äº†æœ‰å…³ CRL åè®®å’Œæ ‡å‡†ï¼›</p>
</li>
<li>
<p>RA (Registration Authority)ï¼Œæ³¨å†Œè®¤è¯æœºæ„
çœ‹ä¸‹ <a
  href="https://en.wikipedia.org/wiki/Public_key_infrastructure"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>https://en.wikipedia.org/wiki/Public_key_infrastructure</a> ä¸­çš„æè¿°ï¼Œ</p>
<blockquote>
<p>A registration authority which verifies the identity of entities requesting their digital certificates to be stored at the CA</p>
</blockquote>
<p>æ˜¯ç”¨æ¥éªŒè¯è¯ä¹¦ç”³è¯·æœºæ„çš„èº«ä»½çš„ï¼›ä¸è¿‡ç°åœ¨ CA å’Œ RA å¹¶æ²¡æœ‰å®Œå…¨åŒºåˆ†ï¼Œå¾€å¾€ä¸¤è€…è¡¨ç¤ºåŒä¸€ä¸ªè§’è‰²ï¼›
ç”¨æˆ·éœ€è¦åƒè¯¥æœºæ„æäº¤ä¸€å¼  CSR æ ¼å¼çš„è¯ä¹¦(è¯¥è¯ä¹¦çš„åç¼€åä¸º <em>.csr</em>)ï¼Œæ—¢æ˜¯ <a
  href="https://en.wikipedia.org/wiki/Certificate_signing_request"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>certificate signing request</a> æ¥ç”³è¯·ï¼Œé‡Œé¢éœ€è¦å¡«å†™è¯¸å¦‚ä½ çš„åŸŸåï¼Œå…¬å¸åï¼Œéƒ¨é—¨åç§°ï¼ŒåŸå¸‚åï¼Œåœ°åŒºåï¼Œå›½å®¶åï¼Œç”µå­é‚®ä»¶ç­‰ç­‰è¯æ˜ä½ èº«ä»½çš„ä¿¡æ¯ï¼›</p>
</li>
</ol>
<p>ä» #1 ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“ï¼ŒCA ä¸ä½†ä¼šå¯¹ç”¨æˆ·çš„èº«ä»½ä¿¡æ¯ä»¥åŠå…¬é’¥è¿›è¡Œç­¾åï¼Œè€Œä¸”ä¼šç”Ÿæˆç›¸åº”çš„ç”µå­è¯ä¹¦æ¥ä¿å­˜è¿™äº›ç­¾åä¿¡æ¯ï¼Œæœ€ç»ˆå°†è¯¥è¯ä¹¦é¢å‘ç»™ç”¨æˆ·ï¼›è€Œäº‹å®ä¸Šï¼Œè¯¥ç”µå­è¯ä¹¦ç»è¿‡æ•°ä¸ªç‰ˆæœ¬çš„å˜åŒ–ï¼Œç°åœ¨å·²ç»å½¢æˆäº†ä¸€ä¸ªäº‹å®æ ‡å‡†ï¼Œé‚£å°±æ˜¯ <em>X.509 è¯ä¹¦</em>ï¼›ä½œè€…ä¼šåœ¨åç»­çš„æ–‡ç« ä¸­å¯¹å…¶è¿›è¡Œè¯¦ç»†çš„ä»‹ç»ï¼›</p>
<h3 id="ca-æœºæ„">CA æœºæ„</h3>
<p>è¿™é‡Œæè¿°ä¸€ä¸‹å›½é™…çŸ¥åçš„ CA æœºæ„æœ‰å“ªäº›ï¼Œ</p>
<p>å¦‚ä¸‹å†…å®¹å¯ä»¥ä» <a
  href="https://en.wikipedia.org/wiki/Certificate_authority"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>https://en.wikipedia.org/wiki/Certificate_authority</a> è·å¾—</p>
<p></p>
]]></description>
</item><item>
  <title>RSA(å››) ç­¾å Signature</title>
  <link>https://ronin-zc.com/rsa%E5%9B%9B-%E7%AD%BE%E5%90%8D-signature/</link>
  <pubDate>Wed, 03 Mar 2021 13:44:25 &#43;0800</pubDate>
  <author>RoninZc</author>
  <guid>https://ronin-zc.com/rsa%E5%9B%9B-%E7%AD%BE%E5%90%8D-signature/</guid>
  <description><![CDATA[<h1 id="å‰è¨€">å‰è¨€</h1>
<p>ç”±<a
  href="https://www.shangyang.me/2017/05/19/encrypt-rsa-math/"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>RSA(ä¸€) èƒŒåçš„æ•°å­¦åŸç†</a>å¯çŸ¥ï¼ŒRSA æ—¢å…¬é’¥åŠ å¯†æŠ€æœ¯ä¸»è¦æ˜¯é€šè¿‡ç§é’¥åŠ å¯†ä¿¡æ¯ï¼Œç„¶åç”±å…¬é’¥æ¥è§£å¯†ä¿¡æ¯ï¼›ä½†æ˜¯ï¼Œä» RSA çš„æ•°å­¦åŸç†ä¸­æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œå…¶å®ç§é’¥åŠ å¯†ä¿¡æ¯ï¼Œç„¶åç”¨å…¬é’¥æ¥è§£å¯†ä¹Ÿæ˜¯å¯ä»¥çš„ï¼›è€Œå› ä¸ºå…¬é’¥æ˜¯å…¬å¼€çš„ï¼Œç§é’¥åŠ å¯†çš„ä¸œè¥¿è°éƒ½å¯ä»¥è¿›è¡Œè§£å¯†ï¼Œé‚£è¿™æ ·åšæœ‰ä»€ä¹ˆæ„ä¹‰å‘¢ï¼Ÿæœ¬ç« èŠ‚å°±æ˜¯æ¥æ¢è®¨è¿™æ ·åšçš„æ„ä¹‰ä½•åœ¨ï¼Ÿä¸€å¥è¯æ¦‚æ‹¬ï¼Œå®ƒçš„æ„ä¹‰å°±åœ¨äºç­¾å( sign )ï¼›</p>
<p>å¤‡æ³¨ï¼Œæœ¬æ–‡æ˜¯ä½œè€…çš„åŸåˆ›ä½œå“ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>
<blockquote>
<p>è½¬è½½è‡³<code>https://www.shangyang.me/2017/05/24/encrypt-rsa-signature/</code></p>
</blockquote>
<h1 id="åœºæ™¯">åœºæ™¯</h1>
<p>æ¥çœ‹è¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼ŒBob ç»™è‚¡ç¥¨ç»çºªäºº Alice å‘é€äº†ä¸€å°é‚®ä»¶ï¼Œè®© Alice å¸®ä»–å¤§é‡è´­ä¹°æŸæ”¯è‚¡ç¥¨ï¼›å¯æ˜¯åˆšä¹°ä¸ä¹…ï¼Œè‚¡ç¥¨å°±å¤§è·Œï¼Œäºæ˜¯ Bob è½¬è€Œå¦è®¤å‘è¿‡é‚£å°é‚®ä»¶ï¼Œå£°ç§°é‚£å°é‚®ä»¶æ˜¯ä¼ªé€ çš„ï¼›é‚£ä¹ˆä½œä¸ºæ³•å®˜çš„ä½ ï¼Œå¦‚ä½•æ¥éªŒè¯ä¹‹å‰å‘é€çš„é‚£å°é‚®ä»¶åˆ°åº•æ˜¯ä¸æ˜¯ Bob å‘é€çš„å‘¢ï¼Ÿ</p>
<p>è¦è§£å†³ä¸Šè¿°åœºæ™¯çš„é—®é¢˜ï¼Œå°±éœ€è¦ä½¿ç”¨åˆ° RSA ç­¾åæŠ€æœ¯äº†ï¼›</p>
<h1 id="ç­¾å-signature">ç­¾å Signature</h1>
<p>ä¸ºä¿è¯é‚®ä»¶æ˜¯ Bob å‘é€çš„ï¼Œåœ¨é‚®ä»¶æ”¶å‘åè®®ä¸Šåšäº†å¦‚ä¸‹çš„æ“ä½œçº¦å®šï¼Œ</p>
<ol>
<li>é¦–å…ˆåŒæ–¹é€šè¿‡é‚®ä»¶åè®®çº¦å®šå¥½ç­¾åçš„ç®—æ³•ï¼Œæ¯”å¦‚éƒ½æ˜¯ç”¨ MD5 æˆ–è€…æ˜¯å…¶å®ƒç­¾åç®—æ³•ã€‚</li>
<li>Bob åœ¨å‘é€é‚®ä»¶çš„åŒæ—¶ï¼Œé‚®ä»¶ç³»ç»Ÿå°†åšå¦‚ä¸‹çš„æ“ä½œ
<ul>
<li>é€šè¿‡ç­¾åç®—æ³• MD5 å°†é‚®ä»¶å†…å®¹<code>c</code>è¿›è¡Œ <em>hash</em>ï¼Œå¾—åˆ°é‚®ä»¶å†…å®¹çš„ç­¾å(Sign)ï¼Œè®°ä¸º ğ‘†1ï¼›</li>
<li>é€šè¿‡ Bob çš„ç§é’¥ ğ‘ƒ å¯¹ ğ‘†1 è¿›è¡ŒåŠ å¯†ï¼Œå¾—åˆ°åŠ å¯†åé‚®ä»¶å†…å®¹çš„ç­¾å(Encrypted Sign)ï¼Œè®°ä¸º ğ‘†1ğ‘’ï¼›</li>
<li>æœ€åï¼ŒBob é€šè¿‡é‚®ç®±ç³»ç»Ÿå°†ç­¾å ğ‘†1ğ‘’S1eï¼Œé‚®ä»¶å†…å®¹<code>c</code>ï¼Œä»¥åŠ Bob çš„å…¬é’¥ ğ‘ƒ ä¸‰éƒ¨åˆ†å†…å®¹å‘é€ç»™ Aliceï¼›
å¦‚ä½•ä¿è¯å…¬é’¥çš„å®‰å…¨æ€§å’Œå¯é æ€§ï¼Œä¸åœ¨æœ¬æ–‡æ¶‰åŠï¼›</li>
</ul>
</li>
<li>Alice æ”¶åˆ° Bob çš„é‚®ä»¶ä»¥åï¼Œé‚®ç®±ç³»ç»Ÿä¼šåšå¦‚ä¸‹çš„æ“ä½œ
<ul>
<li>ä½¿ç”¨ Bob çš„å…¬é’¥å¯¹ ğ‘†1ğ‘’ è¿›è¡Œè§£å¯†ï¼Œå¾—åˆ° ğ‘†1ï¼›</li>
<li>ä½¿ç”¨åŒæ–¹äº‹å…ˆçº¦å®šå¥½çš„ç­¾åç®—æ³• MD5 å¯¹<code>c</code>è¿›è¡Œ <em>hash</em> å¾—åˆ°ç­¾å ğ‘†2ï¼›</li>
<li>æ¯”è¾ƒç­¾å ğ‘†1 å’Œç­¾å ğ‘†2 æ˜¯å¦ç›¸ç­‰
å¦‚æœç›¸ç­‰ï¼Œåˆ™è¡¨ç¤ºé‚®ä»¶å†…å®¹æ²¡æœ‰è¢«ç¯¡æ”¹ï¼›
å¦‚æœä¸ç›¸ç­‰ï¼Œåˆ™è¡¨ç¤ºé‚®ä»¶å†…å®¹è¢«ä»–äººç¯¡æ”¹ï¼›</li>
</ul>
</li>
</ol>
<p>ä¸è¿‡ï¼Œè¦ä¿è¯ä¿¡æ¯çš„ç¡®æ²¡æœ‰è¢«ç¯¡æ”¹ï¼Œè¿˜æœ‰ä¸€æ¡åŸºæœ¬åŸåˆ™ï¼Œå°±æ˜¯ Bob çš„å…¬é’¥ ğ‘ƒ ä¸èƒ½è¢«ç¯¡æ”¹ï¼Œå¦‚æœå…¬é’¥ ğ‘ƒ åœ¨ Bob å‘é€ç»™ Alice çš„è¿‡ç¨‹è¢«äººç¯¡æ”¹äº†ï¼Œé‚£ä¹ˆ Attacker å°±å¯ä»¥è‡ªå·±æœæ’°ä¸€å°é‚®ä»¶ï¼Œå¹¶é€šè¿‡è‡ªå·±çš„ç§é’¥ç­¾åé‚®ä»¶ï¼Œå¹¶å°†è‡ªå·±ç¯¡æ”¹åçš„å…¬é’¥ ğ‘ƒğ‘Pc ä¸€åŒå‘é€ç»™ Aliceï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™ï¼ŒAlice æ˜¯æ²¡æœ‰åŠæ³•ç¡®è®¤é‚®ä»¶æ˜¯å¦æ˜¯è¢«ç¯¡æ”¹è¿‡çš„ï¼›æ‰€ä»¥ï¼Œç”¨ RSA ç­¾åçš„æ–¹å¼æ¥ä¿è¯ä¿¡æ¯æ²¡æœ‰è¢«ç¯¡æ”¹è¿‡ï¼Œä¸€ä¸ªåŸºæœ¬çš„å‰æå°±æ˜¯ Bob çš„å…¬é’¥ ğ‘ƒP ä¸èƒ½è¢«ç¬¬ä¸‰æ–¹ç¯¡æ”¹ï¼›è€Œè¦ä¿è¯å…¬é’¥ä¸èƒ½è¢«ç¬¬ä¸‰æ–¹ç¯¡æ”¹ï¼Œå°±éœ€è¦ PKI (Public Key Infrasture) å…¬é’¥åŸºç¡€è®¾æ–½æ¥ä¿è¯å…¬é’¥çš„åˆæ³•æ€§ï¼Œæ¶‰åŠåˆ° CAï¼ŒRoot Certificate æ ¹è¯ä¹¦ç›¸å…³çŸ¥è¯†ï¼›è¿™éƒ¨åˆ†çŸ¥è¯†ä¸æ‰“ç®—åœ¨æœ¬æ–‡è¿›è¡Œæè¿°ï¼›ç›¸å…³å†…å®¹å‚è€ƒ <a
  href="https://www.shangyang.me/2017/05/25/encrypt-rsa-pki/"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>RSA(äº”) PKI (Public Key Infrastructure) å…¬é’¥åŸºç¡€è®¾æ–½</a>ï¼›</p>
<p>å¤‡æ³¨ï¼šRoot Certificate æ ¹è¯ä¹¦å°±æ˜¯ CA è¯ä¹¦è®¤è¯æœºæ„ç”¨æ¥ç­¾åéªŒè¯å…¬é’¥ ğ‘ƒ çš„ï¼›</p>
<h1 id="æ€»ç»“">æ€»ç»“</h1>
<p><a
  href="https://www.shangyang.me/2017/05/24/encrypt-rsa-signature/#%e7%ad%be%e5%90%8d-sign"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>ç­¾å sign</a> å°èŠ‚ä¸­è¯¦ç»†çš„æè¿°äº† RSA é€šè¿‡ç§é’¥ç­¾åçš„è¿‡ç¨‹å’Œä½œç”¨ï¼›ä½†æ˜¯ä¹ŸçŸ¥é“ï¼Œç­¾åè‹¥è¦èƒ½èµ·ä½œç”¨ï¼Œå¿…é¡»å€ŸåŠ© PKI å…¬é’¥åŸºç¡€è®¾æ–½æ¥ä¿è¯å…¬é’¥çš„åˆæ³•æ€§ï¼›æ‰€ä»¥ï¼Œå¯è§ï¼ŒPKI å¯¹äºåŸºäº RSA çš„åŠ å¯†é€šè®¯åè®®èµ·åˆ°è‡³å…³é‡è¦çš„ä½œç”¨ï¼Œæ²¡æœ‰å®ƒï¼Œä¸€åˆ‡åŸºäº RSA çš„åŠ å¯†é€šè®¯ç†è®ºéƒ½ç™½æ­ï¼›åç»­ç« èŠ‚ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹ PKI æ˜¯ä»€ä¹ˆä¸œè¥¿ï¼›</p>
]]></description>
</item><item>
  <title>RSA(ä¸‰) å¯†é’¥çš„æ ¼å¼</title>
  <link>https://ronin-zc.com/rsa%E4%B8%89-%E5%AF%86%E9%92%A5%E7%9A%84%E6%A0%BC%E5%BC%8F/</link>
  <pubDate>Wed, 03 Mar 2021 13:43:25 &#43;0800</pubDate>
  <author>RoninZc</author>
  <guid>https://ronin-zc.com/rsa%E4%B8%89-%E5%AF%86%E9%92%A5%E7%9A%84%E6%A0%BC%E5%BC%8F/</guid>
  <description><![CDATA[<h1 id="å‰è¨€">å‰è¨€</h1>
<p>æœ¬ç¯‡åšæ–‡é‡ç‚¹æè¿°å¯†é’¥çš„ç§ç§æ ¼å¼ï¼›</p>
<p>å¤‡æ³¨ï¼Œæœ¬æ–‡æ˜¯ä½œè€…çš„åŸåˆ›ä½œå“ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>
<blockquote>
<p>è½¬è½½è‡³<code>https://www.shangyang.me/2017/05/24/encrypt-rsa-keyformat/</code></p>
</blockquote>
<h1 id="pem-å’Œ-der">PEM å’Œ DER</h1>
<p>é¦–å…ˆæˆ‘ä»¬æ¥çœ‹çœ‹ä»€ä¹ˆæ˜¯ PEM å’Œ DER</p>
<h2 id="ä»€ä¹ˆæ˜¯-der-æ ¼å¼">ä»€ä¹ˆæ˜¯ DER æ ¼å¼</h2>
<p>DER æ˜¯å¯†é’¥çš„äºŒè¿›åˆ¶è¡¨è¿°æ ¼å¼ï¼›</p>
<p><a
  href="http://fileformats.archiveteam.org/wiki/DER"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>http://fileformats.archiveteam.org/wiki/DER</a></p>
<blockquote>
<p><code>Distinguished Encoding Rules (DER)</code> is a <em>binary serialization</em> of ASN.1 format. It is often used for cryptographic data such as certificates, but has other uses.</p>
</blockquote>
<p>å¾ˆæ˜æ˜¾ï¼ŒDER å°±æ˜¯ ASN.1 çš„äºŒè¿›åˆ¶æ ¼å¼ï¼›</p>
<h2 id="ä»€ä¹ˆæ˜¯-pem-æ ¼å¼">ä»€ä¹ˆæ˜¯ PEM æ ¼å¼</h2>
<p>PEM æ ¼å¼æ—¢æ˜¯å¯¹ DER ç¼–ç è½¬ç ä¸º Base64 å­—ç¬¦æ ¼å¼ï¼›é€šè¿‡è§£ç ï¼Œå°†ä¼šè¿˜åŸä¸º DER æ ¼å¼ï¼›</p>
<p><a
  href="http://fileformats.archiveteam.org/wiki/PEM"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>http://fileformats.archiveteam.org/wiki/PEM</a></p>
<blockquote>
<p>A PEM file is plain text. It contain one or more objects, such as certificates or keys, which may not all be the same type. Each object is delimited by lines similar to â€œâ€”â€“BEGIN â€¦â€”â€“â€ and â€œâ€”â€“END â€¦â€”â€“â€. Data that is not between such lines is ignored, and is sometimes used for comments, or for a human-readable dump of the encoded data.</p>
</blockquote>
<p>Following the â€œBEGINâ€ and â€œENDâ€ keywords is a name (such as â€œCERTIFICATEâ€) that can be used as an identifier for the type of object.</p>
<blockquote>
<p>The data between the delimiter lines starts with an optional email-like header section, followed by base64-encoded payload data. After decoding, the payload data is in DER format.</p>
</blockquote>
<p>æ€»ä½“è€Œè¨€ï¼ŒPEM æ˜¯æ˜æ–‡æ ¼å¼ï¼Œå¯ä»¥åŒ…å«è¯ä¹¦æˆ–è€…æ˜¯å¯†é’¥ï¼›å…¶å†…å®¹é€šå¸¸æ˜¯ä»¥ç±»ä¼¼ â€œâ€”â€“BEGIN â€¦â€”â€“â€ å¼€å¤´ â€œâ€”â€“END â€¦â€”â€“â€ ä¸ºç»“å°¾çš„è¿™æ ·çš„æ ¼å¼è¿›è¡Œå±•ç¤ºçš„ï¼›åç»­å†…å®¹ä¹Ÿæè¿°åˆ°ï¼ŒPEM æ ¼å¼çš„å†…å®¹æ˜¯ Base64 æ ¼å¼ï¼›é€šè¿‡è§£ç ï¼Œè½¬æ¢ä¸º DER æ ¼å¼ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒPEM æ˜¯å»ºç«‹åœ¨ DER ç¼–ç ä¹‹ä¸Šçš„ï¼›</p>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>DER å®é™…ä¸Šå°±æ˜¯å¯†é’¥çš„æœ€åŸå§‹çš„äºŒè¿›åˆ¶æ ¼å¼ï¼›è€Œ PEM æ˜¯å¯¹ DER çš„ Base64 çš„ç¼–ç ï¼ŒPEM è§£ç åå¾—åˆ°çš„å°±æ˜¯ DER ç¼–ç æ ¼å¼ï¼›</p>
<h1 id="æ ¼å¼">æ ¼å¼</h1>
<p>ç”±äº DER æ˜¯äºŒè¿›åˆ¶æ ¼å¼ï¼Œä¸ä¾¿äºé˜…è¯»å’Œç†è§£ï¼Œä¸€èˆ¬è€Œè¨€ï¼Œå¯†é’¥éƒ½æ˜¯é€šè¿‡ PEM çš„æ ¼å¼è¿›è¡Œå­˜å‚¨çš„ï¼Œæ‰€ä»¥ï¼Œè¿™éƒ¨åˆ†å†…å®¹ä¸»è¦æ˜¯æ¢³ç†å‡ºå…¬é’¥å’Œå¯†é’¥ä»¥ PEM ç¼–ç å­˜å‚¨çš„æ ¼å¼ï¼›</p>
<h2 id="å…¬é’¥-pem-æ ¼å¼">å…¬é’¥ PEM æ ¼å¼</h2>
<h3 id="pkcs-1">PKCS #1</h3>
<p>PKCS #1 æ ‡å‡†æ˜¯ä¸“é—¨ä¸º RSA å¯†é’¥è¿›è¡Œå®šä¹‰çš„ï¼Œå…¶å¯¹åº”çš„ PEM æ–‡ä»¶æ ¼å¼å¦‚ä¸‹ï¼Œ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">-----BEGIN RSA PUBLIC KEY-----
</span></span><span class="line"><span class="cl">BASE64 ENCODED DATA
</span></span><span class="line"><span class="cl">-----END RSA PUBLIC KEY-----
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸Šé¢çš„å†…å®¹ <em>BASE64 ENCODED DATA</em> æŒ‡çš„å°±æ˜¯ ANS.1 çš„ DER çš„ Base64 ç¼–ç ï¼Œå…¶å†…å®¹ç±»ä¼¼äº</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQChHmaw+WUhWrStdxWBcAR39i2e  
</span></span><span class="line"><span class="cl">3yz+vfLiDALeTpWIH1jKiYtvw4nMg6453pXAJSvPn7mKaiGiC3USIt8qTL4eCPi9  
</span></span><span class="line"><span class="cl">yNRDpZ1JRHI8M87VYB4c9KMk6IuVFiYyZ4MBTP87t89yeL9EOrAD0eFgi5fPx3g8  
</span></span><span class="line"><span class="cl">b9QrmnyPhMVjP7ct+wIDAQAB
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸Šè¿°å†…å®¹ç¿»è¯‘æˆ ASN.1 çš„æ ¼å¼ä¸ºï¼Œæ­¤éƒ¨åˆ†å†…å®¹å‚è€ƒ <a
  href="https://www.shangyang.me/2017/05/21/encrypt-rsa-pkcs/#RSA-public-key-syntax-%e5%85%ac%e9%92%a5%e8%af%ad%e6%b3%95"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>RSA public key syntax å…¬é’¥è¯­æ³•</a> å°èŠ‚å†…å®¹ï¼›</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">RSAPublicKey ::= SEQUENCE {
</span></span><span class="line"><span class="cl">    modulus           INTEGER,  -- n
</span></span><span class="line"><span class="cl">    publicExponent    INTEGER   -- e
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="pkcs-8">PKCS #8</h3>
<p>æœ‰å‰é¢çš„åˆ†ææˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼ŒPKCS#8 æ ‡å‡†å®šä¹‰äº†ä¸€ä¸ªå¯†é’¥æ ¼å¼çš„é€šç”¨æ–¹æ¡ˆï¼Œå®ƒä¸ä»…ä»…ä¸º RSA æ‰€ä½¿ç”¨ï¼ŒåŒæ ·ä¹Ÿå¯ä»¥è¢«å…¶å®ƒå¯†é’¥æ‰€ä½¿ç”¨ï¼›å…·ä½“åˆ†æå‚è€ƒ <a
  href="https://www.shangyang.me/2017/05/21/encrypt-rsa-pkcs/#RFC5208-Private-Key-Information-Syntax-Specification"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>RFC5208 Private-Key Information Syntax Specification</a></p>
<p>å…¶æ‰€å¯¹åº”çš„ PEM æ ¼å¼å®šä¹‰å¦‚ä¸‹ï¼Œ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">-----BEGIN PUBLIC KEY-----
</span></span><span class="line"><span class="cl">BASE64 ENCODED DATA
</span></span><span class="line"><span class="cl">-----END PUBLIC KEY-----
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ³¨æ„ï¼Œè¿™é‡Œå°±æ²¡æœ‰ RSA å­—æ ·äº†ï¼Œå› ä¸º PKCS#8 æ˜¯ä¸€ä¸ªé€šç”¨å‹çš„ç§˜é’¥æ ¼å¼æ–¹æ¡ˆï¼›å…¶ä¸­çš„ <em>BASE64 ENCODED DATA</em> æ‰€æ ‡æ³¨çš„å†…å®¹ä¸º PEM æ ¼å¼ä¸­å¯¹ DER åŸå§‹äºŒè¿›åˆ¶è¿›è¡Œçš„ BASE64 ç¼–ç ï¼›</p>
<p>æ‰€å¯¹åº”çš„ DER åŸå§‹äºŒè¿›åˆ¶æ‰€è¡¨è¿°çš„å†…å®¹ä¸º</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">PublicKeyInfo ::= SEQUENCE {
</span></span><span class="line"><span class="cl">  algorithm       AlgorithmIdentifier,
</span></span><span class="line"><span class="cl">  PublicKey       BIT STRING
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">AlgorithmIdentifier ::= SEQUENCE {
</span></span><span class="line"><span class="cl">  algorithm       OBJECT IDENTIFIER,
</span></span><span class="line"><span class="cl">  parameters      ANY DEFINED BY algorithm OPTIONAL
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>é‡è¦è¡¥å……</strong></p>
<p>ä»è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼ŒPKCS#8 è™½ç„¶åå­—å«åš Private-Key Information Syntax Specificationï¼Œä½†æ˜¯å®é™…ä¸Šï¼Œå¯ä»¥çœ‹åˆ°ï¼Œå®ƒåŒæ ·å¯ä»¥ç”¨ä½œ Public Key çš„æ ¼å¼å®šä¹‰ï¼›è€Œ PKCS#8 æ˜¯ç«™åœ¨ PKCS#7 CMS çš„åŸºç¡€ä¹‹ä¸Šè¿›è¡Œç¼–ç æ ¼å¼å®šä¹‰çš„ï¼›</p>
<h2 id="ç§é’¥-pem-æ ¼å¼">ç§é’¥ PEM æ ¼å¼</h2>
<h3 id="pkcs-1-1">PKCS #1</h3>
<p>PKCS#1 æ˜¯ä¸“é—¨ä¸º RSA æ‰€æ¶‰åŠçš„ï¼Œå…¶å¯¹åº”çš„ PEM æ ¼å¼å¦‚ä¸‹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">-----BEGIN RSA PRIVATE KEY-----
</span></span><span class="line"><span class="cl">BASE64 ENCODED DATA
</span></span><span class="line"><span class="cl">-----END RSA PRIVATE KEY-----
</span></span></code></pre></td></tr></table>
</div>
</div><p>å…¶ä¸­çš„ <em>BASE64 ENCODED DATA</em> æ‰€æ ‡æ³¨çš„å†…å®¹ä¸º PEM æ ¼å¼ä¸­å¯¹ DER åŸå§‹äºŒè¿›åˆ¶è¿›è¡Œçš„ BASE64 ç¼–ç ï¼›</p>
<p>åŸå§‹çš„ DER æ ¼å¼ç»“æ„ï¼Œæ—¢æ˜¯ ASN.1 çš„æ•°æ®ç»“æ„ï¼Œæ­¤éƒ¨åˆ†å†…å®¹å‚è€ƒ <a
  href="https://www.shangyang.me/2017/05/21/encrypt-rsa-pkcs/#RSA-private-key-syntax-%e7%a7%81%e9%92%a5%e8%af%ad%e6%b3%95"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>RSA private key syntax ç§é’¥è¯­æ³•</a> å°èŠ‚å†…å®¹ï¼›</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">RSAPrivateKey ::= SEQUENCE {
</span></span><span class="line"><span class="cl">  version           Version,
</span></span><span class="line"><span class="cl">  modulus           INTEGER,  -- n
</span></span><span class="line"><span class="cl">  publicExponent    INTEGER,  -- e
</span></span><span class="line"><span class="cl">  privateExponent   INTEGER,  -- d
</span></span><span class="line"><span class="cl">  prime1            INTEGER,  -- p
</span></span><span class="line"><span class="cl">  prime2            INTEGER,  -- q
</span></span><span class="line"><span class="cl">  exponent1         INTEGER,  -- d mod (p-1)
</span></span><span class="line"><span class="cl">  exponent2         INTEGER,  -- d mod (q-1)
</span></span><span class="line"><span class="cl">  coefficient       INTEGER,  -- (inverse of q) mod p
</span></span><span class="line"><span class="cl">  otherPrimeInfos   OtherPrimeInfos OPTIONAL
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="pkcs-8-1">PKCS #8</h3>
<h4 id="æœªåŠ å¯†">æœªåŠ å¯†</h4>
<p>å…¶æ‰€å¯¹åº”çš„ PEM æ ¼å¼å®šä¹‰å¦‚ä¸‹ï¼Œ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">-----BEGIN PRIVATE KEY-----
</span></span><span class="line"><span class="cl">BASE64 ENCODED DATA
</span></span><span class="line"><span class="cl">-----END PRIVATE KEY-----
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ³¨æ„ï¼Œè¿™é‡Œå°±æ²¡æœ‰ RSA å­—æ ·äº†ï¼Œå› ä¸º PKCS#8 æ˜¯ä¸€ä¸ªé€šç”¨å‹çš„ç§˜é’¥æ ¼å¼æ–¹æ¡ˆï¼›å…¶ä¸­çš„ <em>BASE64 ENCODED DATA</em> æ‰€æ ‡æ³¨çš„å†…å®¹ä¸º PEM æ ¼å¼ä¸­å¯¹ DER åŸå§‹äºŒè¿›åˆ¶è¿›è¡Œçš„ BASE64 ç¼–ç ï¼›</p>
<p>æ‰€å¯¹åº”çš„ DER åŸå§‹äºŒè¿›åˆ¶æ‰€è¡¨è¿°çš„å†…å®¹ä¸º</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">PrivateKeyInfo ::= SEQUENCE {
</span></span><span class="line"><span class="cl">  version         Version,
</span></span><span class="line"><span class="cl">  algorithm       AlgorithmIdentifier,
</span></span><span class="line"><span class="cl">  PrivateKey      BIT STRING
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">AlgorithmIdentifier ::= SEQUENCE {
</span></span><span class="line"><span class="cl">  algorithm       OBJECT IDENTIFIER,
</span></span><span class="line"><span class="cl">  parameters      ANY DEFINED BY algorithm OPTIONAL
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="åŠ å¯†">åŠ å¯†</h4>
<p>ç”±äºç§é’¥æ˜¯éå¸¸ç§å¯†çš„ï¼Œæ‰€ä»¥åœ¨å­˜å‚¨åˆ°æ—¶å€™å¾€å¾€éœ€è¦å¯¹ç§é’¥çš„å†…å®¹ä¹Ÿè¿›è¡ŒåŠ å¯†ï¼Œ</p>
<p>PEM æ ¼å¼</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">-----BEGIN ENCRYPTED PRIVATE KEY-----
</span></span><span class="line"><span class="cl">BASE64 ENCODED DATA
</span></span><span class="line"><span class="cl">-----END ENCRYPTED PRIVATE KEY-----
</span></span></code></pre></td></tr></table>
</div>
</div><p>DER æ ¼å¼ï¼Œæ—¢æ˜¯æ ¹æ® ASN.1 æ ‡å‡†æ‰€å®šä¹‰çš„æ ¼å¼</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">EncryptedPrivateKeyInfo ::= SEQUENCE {
</span></span><span class="line"><span class="cl">  encryptionAlgorithm  EncryptionAlgorithmIdentifier,
</span></span><span class="line"><span class="cl">  encryptedData        EncryptedData
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">EncryptionAlgorithmIdentifier ::= AlgorithmIdentifier
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">EncryptedData ::= OCTET STRING
</span></span></code></pre></td></tr></table>
</div>
</div>]]></description>
</item><item>
  <title>RSA(äºŒ) PKCS å…¬é’¥åŠ å¯†æ ‡å‡†ç³»åˆ—</title>
  <link>https://ronin-zc.com/rsa%E4%BA%8C-pkcs-%E5%85%AC%E9%92%A5%E5%8A%A0%E5%AF%86%E6%A0%87%E5%87%86%E7%B3%BB%E5%88%97/</link>
  <pubDate>Wed, 03 Mar 2021 13:41:25 &#43;0800</pubDate>
  <author>RoninZc</author>
  <guid>https://ronin-zc.com/rsa%E4%BA%8C-pkcs-%E5%85%AC%E9%92%A5%E5%8A%A0%E5%AF%86%E6%A0%87%E5%87%86%E7%B3%BB%E5%88%97/</guid>
  <description><![CDATA[<h1 id="å‰è¨€">å‰è¨€</h1>
<p>æœ¬ç« ç€é‡æè¿° RSA PCKS(Public-Key Cryptography Standards Series å…¬é’¥åŠ å¯†æ ‡å‡†ç³»åˆ—)ï¼ŒRSA åˆç§°ä¸ºå…¬é’¥åŠ å¯†æŠ€æœ¯ï¼Œä¸»è¦çš„ä½¿ç”¨åœºæ™¯æ˜¯å…¬é’¥åŠ å¯†ã€ç§é’¥è§£å¯†ï¼ˆè¡¥å……ï¼Œå½“ç„¶ï¼Œç§é’¥åŠ å¯†ï¼Œå…¬é’¥æœºå¯†ä¹Ÿæ˜¯å¯è¡Œçš„ï¼Œä½†æ˜¯è¿™æ ·åšå¹¶ä¸å®‰å…¨ï¼Œå› ä¸ºå…¬é’¥æ˜¯å…¬å¼€çš„ï¼Œæ‰€æœ‰æ‹¿åˆ°å…¬é’¥çš„äººéƒ½å¯ä»¥è§£å¯†ï¼Œä¹Ÿå°±å¤±å»äº†åŠ å¯†çš„æœ¬è´¨ï¼›ä¸è¿‡ï¼Œå¯ä»¥ç”¨ç§é’¥æ¥è¿›è¡Œç­¾åï¼Œåç»­æœ‰ä¸“é—¨çš„åšæ–‡å¯¹æ­¤è¿›è¡Œæè¿°ï¼‰ï¼›</p>
<p>ä¸ºäº†å®šä¹‰ RSA åŠ å¯†çš„æ ‡å‡†ç³»åˆ—ï¼ŒIETF ç»„ç»‡æ€»å…±å®šä¹‰äº† 15 ä¸ªå­ç³»åˆ—æ ‡å‡†ï¼Œåˆ†åˆ«ç”¨åœ¨å®šä¹‰æ ‡å‡†æ ¼å¼ã€å¦‚ä½•å°è£…ã€å…¬é’¥åŠ å¯†å°è£…æ ‡å‡†ã€ç§é’¥åŠ å¯†å°è£…æ ‡å‡†ã€ç½‘ç»œä¼ è¾“åºåˆ—åŒ–æ ‡å‡†ç­‰ç­‰.. å…·ä½“å¯ä»¥å‚è€ƒ wikipedia PCKS çš„è§£é‡Š: <a
  href="https://en.wikipedia.org/wiki/PKCS"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>https://en.wikipedia.org/wiki/PKCS</a>ï¼›</p>
<p>ä¸‹é¢æˆ‘å°±å‡ ä¸ªæ ¸å¿ƒçš„ç³»åˆ—æ ‡å‡†è¿›è¡Œæè¿°ï¼Œ</p>
<p>é‡è¦ï¼šæœ¬æ–‡ä¸ºä½œè€…çš„åŸåˆ›ä½œå“ï¼Œè½¬è½½éœ€æ³¨æ˜å‡ºå¤„ï¼›</p>
<blockquote>
<p>è½¬è½½è‡³<code>https://www.shangyang.me/2017/05/24/encrypt-rsa-keyformat/</code></p>
</blockquote>
<p>æœªå®Œå¾…ç»­â€¦.</p>
<h1 id="pkcs-1-rsa-cryptography-standard">PKCS #1 RSA Cryptography Standard</h1>
<p>æ‘˜è¦ wikepedia ä¸­çš„ä¸€æ®µæ‘˜è¦ï¼Œ</p>
<blockquote>
<p>See <a
  href="https://tools.ietf.org/html/rfc3447"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>RFC 3447</a>. Defines the mathematical properties and format of RSA public and private keys (ASN.1-encoded in clear-text), and the basic algorithms and encoding/padding schemes for performing RSA encryption, decryption, and producing and verifying signatures.</p>
</blockquote>
<p>å®šä¹‰äº†å…¬é’¥åŠ å¯†æŠ€æœ¯(RSA)ç›¸å…³çš„æ•°å­¦å±æ€§ä»¥åŠç›¸å…³çš„å…¬é’¥å’Œå¯†é’¥çš„æ ¼å¼æ ‡å‡†ï¼ˆé€šè¿‡ ASN.1 çš„æ ¼å¼æ ‡å‡†æ¥å®šä¹‰å¹¶æ˜æ–‡å±•ç¤ºï¼‰ï¼Œä»¥åŠä¸º RSA è¿›è¡ŒåŠ å¯†ã€è§£å¯†ï¼Œç”Ÿæˆå’ŒéªŒè¯ç­¾åç­‰æ“ä½œå®šä¹‰äº†åŸºæœ¬çš„ç®—æ³•å’Œç¼–ç /è¡¥é›¶(padding)çš„æ–¹æ¡ˆï¼›</p>
<p>å¯ä»¥çœ‹åˆ°ï¼ŒPCKS #1 ä¸»è¦å®šä¹‰äº†å…¬é’¥åŠ å¯†æŠ€æœ¯ RSA æ˜¯å¦‚ä½•é€šè¿‡è®¡ç®—æœºæ¥æ¥å®šä¹‰å…¶ç¼–ç ã€é€šè®¯æ ¼å¼åŒ…æ‹¬å…¬é’¥ç§é’¥çš„æ–‡æœ¬æ ¼å¼(é€šè¿‡ ASN.1 æ¥å®šä¹‰)ç­‰ä¸€ç³»åˆ—èƒ½å¤Ÿä½¿ç”¨è®¡ç®—æœºæ¥è¿›è¡Œé€šè®¯å’Œè®¡ç®—çš„æ–¹æ¡ˆï¼›</p>
<p>è¦æ³¨æ„çš„æ˜¯ï¼ŒPCKS #1 å®šä¹‰çš„éƒ½æ˜¯æ˜æ–‡çš„æ ¼å¼ï¼›ä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹ ASN.1 æ˜¯å¦‚ä½•å®šä¹‰ç§é’¥å’Œå…¬é’¥çš„æ ¼å¼çš„ï¼Œæ¥åŠ æ·±æˆ‘ä»¬çš„è®¤çŸ¥ï¼›</p>
<h2 id="asn1">ASN.1</h2>
<p>ASN.1: <a
  href="https://en.wikipedia.org/wiki/Abstract_Syntax_Notation_One"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>https://en.wikipedia.org/wiki/Abstract_Syntax_Notation_One</a></p>
<blockquote>
<p>Abstract Syntax Notation One (ASN.1) is an interface description language for defining data structures that can be serialized and deserialized in a standard, cross-platform way. Itâ€™s broadly used in telecommunications and computer networking, and especially in cryptography.</p>
</blockquote>
<p>ASN.1 æ˜¯ä¸€ç§æ¥å£æè¿°æ€§è¯­è¨€ï¼Œè¯¥è¯­è¨€å®šä¹‰äº†èƒ½å¤Ÿè¿›è¡Œè·¨å¹³å°ã€åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„æ•°æ®æ ¼å¼ï¼›å®ƒè¢«å¹¿æ³›çš„ç”¨äºç”µå­é€šè®¯ä»¥åŠè®¡ç®—æœºç½‘ç»œä¸­ï¼Œç‰¹åˆ«æ˜¯ç”¨åœ¨<code>å¯†ç å­¦çš„é¢†åŸŸ</code>ï¼›ç”±æ­¤å¯çŸ¥ï¼ŒASN.1 å®šä¹‰äº†ä¸€ç§ä¸“ç”¨äºå¯†ç å­¦é¢†åŸŸçš„ä¸€ç§å¯ä»¥è¿›è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„æ•°æ®æ ¼å¼ï¼›</p>
<blockquote>
<p>ASN.1 is used in X.509, which defines the format of certificates used in the HTTPS protocol for securely browsing the web, and in many other cryptographic systems.</p>
</blockquote>
<p>ASN.1 ç”¨åœ¨ X.509 ä¸­ï¼Œç”¨æ¥å®šä¹‰å…¶è¯ä¹¦çš„æ ¼å¼ï¼Œè¯¥è¯ä¹¦ç”¨åœ¨ HTTPS å®‰å…¨é€šè®¯é¢†åŸŸï¼›</p>
<p>é‚£ä¹ˆ RSA æ˜¯å¦‚ä½•é€šè¿‡ ASN.1 æ¥å®šä¹‰å…¬é’¥å’Œç§é’¥çš„æ•°æ®æ ¼å¼çš„ï¼›çœ‹ä¸‹é¢çš„ç« èŠ‚ï¼Œä¸»è¦å‚è€ƒï¼Œhttps://tools.ietf.org/html/rfc3447#appendix-A</p>
<h3 id="rsa-public-key-syntax-å…¬é’¥è¯­æ³•">RSA public key syntax å…¬é’¥è¯­æ³•</h3>
<p><a
  href="https://tools.ietf.org/html/rfc3447#appendix-A.1.1"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>https://tools.ietf.org/html/rfc3447#appendix-A.1.1</a></p>
<blockquote>
<p>An RSA public key should be represented with the ASN.1 type
RSAPublicKey:</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">RSAPublicKey ::= SEQUENCE {
</span></span><span class="line"><span class="cl">    modulus           INTEGER,  -- n
</span></span><span class="line"><span class="cl">    publicExponent    INTEGER   -- e
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>The fields of type RSAPublicKey have the following meanings:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">* modulus is the RSA modulus n.
</span></span><span class="line"><span class="cl">* publicExponent is the RSA public exponent e.
</span></span></code></pre></td></tr></table>
</div>
</div></blockquote>
<p>ä¸Šé¢é€šè¿‡ ASN.1 å®šä¹‰äº†å…¬é’¥çš„æ ¼å¼ï¼Œé€šè¿‡ä¸€ä¸ª ASN.1 çš„ SEQUENCE å…ƒç´ åˆ†åˆ«å®šä¹‰äº† modules å’Œ publicExponentï¼Œè€Œ modules æ­£æ˜¯ä»£è¡¨çš„ <a
  href="https://www.shangyang.me/2017/05/19/encrypt-rsa-math/#%e6%a8%a1-N"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>æ¨¡ N</a>ï¼Œè€Œ publicExponent æ­£å¼ä»£è¡¨çš„<a
  href="https://www.shangyang.me/2017/05/19/encrypt-rsa-math/#%e9%9a%8f%e6%9c%ba%e6%95%b0-e"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>éšæœºæ•° e</a>ï¼Œè€Œ {ğ‘,ğ‘’}{N,e} æ­£å¥½è¡¨ç¤ºäº†å…¬é’¥ï¼›</p>
<p>å¯è§ï¼Œé€šè¿‡ ASN.1 çš„ <em>SEQUENCE</em> å…ƒç´ <code>RSAPublicKey</code>å®šä¹‰äº†å…¬é’¥çš„æ•°æ®æ ¼å¼ï¼Œè¯¥æ ¼å¼ä¾¿å¯ä»¥åœ¨ç½‘ç»œé€šè®¯ä¸­è¿›è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼›</p>
<h3 id="rsa-private-key-syntax-ç§é’¥è¯­æ³•">RSA private key syntax ç§é’¥è¯­æ³•</h3>
<p><a
  href="https://tools.ietf.org/html/rfc3447#appendix-A.1.2"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>https://tools.ietf.org/html/rfc3447#appendix-A.1.2</a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">RSAPrivateKey ::= SEQUENCE {
</span></span><span class="line"><span class="cl">          version           Version,
</span></span><span class="line"><span class="cl">          modulus           INTEGER,  -- n
</span></span><span class="line"><span class="cl">          publicExponent    INTEGER,  -- e
</span></span><span class="line"><span class="cl">          privateExponent   INTEGER,  -- d
</span></span><span class="line"><span class="cl">          prime1            INTEGER,  -- p
</span></span><span class="line"><span class="cl">          prime2            INTEGER,  -- q
</span></span><span class="line"><span class="cl">          exponent1         INTEGER,  -- d mod (p-1)
</span></span><span class="line"><span class="cl">          exponent2         INTEGER,  -- d mod (q-1)
</span></span><span class="line"><span class="cl">          coefficient       INTEGER,  -- (inverse of q) mod p
</span></span><span class="line"><span class="cl">          otherPrimeInfos   OtherPrimeInfos OPTIONAL
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯è§ï¼ŒASN.1 åŒæ ·é€šè¿‡ä¸€ä¸ª <em>SEQUENCE</em> å…ƒç´ <code>RSAPrivateKey</code>å®šä¹‰äº†ç§é’¥çš„æ•°æ®æ ¼å¼ï¼Œd æ—¢æ˜¯æ¨¡åå…ƒç´ ï¼Œpã€q ä¸¤è´¨æ•°ï¼Œexponent1 å’Œ exponent2 åˆ†åˆ«è¡¨ç¤º d ä¸ (p-1) å’Œ (p-2) çš„ä½™æ•°ï¼›</p>
<p>å¯ä»¥çœ‹åˆ° ASN.1 å®šä¹‰äº† private key çš„æ•°æ®æ ¼å¼ï¼›</p>
<h2 id="è¡¥å……">è¡¥å……</h2>
<p>è¦æŸ¥çœ‹æ˜æ–‡çš„ public key / private key çš„ ASN.1 çš„æºæ•°æ®æ ¼å¼ï¼Œå¯ä»¥é€šè¿‡å·¥å…· <a
  href="http://phpseclib.sourceforge.net/x509/asn1parse.php"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>http://phpseclib.sourceforge.net/x509/asn1parse.php</a> æŸ¥çœ‹ï¼›</p>
<h1 id="pkcs-7-cryptographic-message-syntax-standard">PKCS #7 Cryptographic Message Syntax Standard</h1>
<p>Cryptographic Message Syntax Standard è¢«åŠ å¯†æ¶ˆæ¯çš„æ ¼å¼æ ‡å‡†ï¼Œä¸ PKCS #1 ä¸åŒï¼ŒPKCS #7 æè¿°çš„æ˜¯å¦‚ä½•å¯¹å…¬é’¥å’Œç§é’¥ ASN.1 çš„æ–‡æœ¬è¿›è¡ŒåŠ å¯†çš„æ ‡å‡†ï¼›PKCS #1 æ ‡å‡†æè¿°çš„æ˜¯ RSA åŠ å¯†æŠ€æœ¯ç›¸å…³æ ‡å‡†çš„å®šä¹‰ï¼›å…ˆæ¥çœ‹ Wikipedia ä¸Šçš„ä¸€æ®µæ‘˜è¦ï¼Œ</p>
<blockquote>
<p>See <a
  href="https://tools.ietf.org/html/rfc2315"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>RFC 2315</a>. Used to sign and/or encrypt messages under a <a
  href="https://en.wikipedia.org/wiki/Public_key_infrastructure"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>PKI</a>. Used also for certificate dissemination (for instance as a response to a PKCS #10 message). Formed the basis for S/MIME, which is as of 2010 based on RFC 5652, an updated <a
  href="https://en.wikipedia.org/wiki/Cryptographic_Message_Syntax"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>Cryptographic Message Syntax Standard (CMS)</a>. Often used for single sign-on.</p>
</blockquote>
<p>PKCS #7 é€šå¸¸åœ¨ä¸€ä¸ª PKI ä¸­ç”¨æ¥ç­¾åæˆ–è€…åŠ å¯†ä¿¡æ¯ï¼Œä¹Ÿé€šå¸¸ç”¨äºè¯ä¹¦çš„ä¼ é€’ï¼›PKCS #7 çš„æ›´æ–°ç‰ˆæœ¬å‚è€ƒ<a
  href="https://en.wikipedia.org/wiki/Cryptographic_Message_Syntax"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>Cryptographic Message Syntax Standard (CMS)</a>ï¼›</p>
<p>ä»ä¸Šè¿°çš„æè¿°ä¸­å¯ä»¥çŸ¥é“ï¼ŒPKCS #7 ä¸»è¦å®šä¹‰äº†æ¶ˆæ¯çš„åŠ å¯†è¯­æ³•æ ‡å‡†ï¼›</p>
<p>æ‘˜è¦<a
  href="https://tools.ietf.org/html/rfc5652#section-3"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>CMS</a>ä»‹ç»ä¸­çš„ç›¸å…³é‡è¦éƒ¨åˆ†,</p>
<blockquote>
<p>The CMS describes an encapsulation syntax for data protection.</p>
<p>The CMS can support a variety of architectures for certificate-based
key management, such as the one defined by the PKIX (Public Key
Infrastructure using X.509) working group [PROFILE].</p>
</blockquote>
<p>CMS ç”¨æ¥æè¿°æ•°æ®åŠ å¯†çš„ä¸€ç§å°è£…è¯­æ³•ï¼›</p>
<p>CMS å¯ä»¥ç”¨äºæ”¯æŒå¤šç§å¤šæ ·çš„è¯ä¹¦ç®¡ç†å®ç°ï¼Œæ¯”å¦‚ PKIX (X.509 ä¸­çš„å…¬é’¥ç®¡ç†çš„å†…éƒ¨å®ç°)ï¼›</p>
<p>Okï¼Œä»ä¸Šè¿°çš„æè¿°ä¸­å¯ä»¥çœ‹åˆ°ï¼ŒPKCS #7 ä¸»è¦ç”¨åœ¨ PKI/PKIX é¢†åŸŸä¸­ï¼Œä¸»è¦æ˜¯ç”¨æ¥è¿›è¡Œå…¬é’¥åŠ å¯†ä¿å­˜ã€ä¼ è¾“ç­‰ï¼›</p>
<h2 id="pkcs-7-format">PKCS #7 Format</h2>
<p><a
  href="https://crypto.stackexchange.com/questions/37084/is-pkcs7-a-signature-format-or-a-certificate-format"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>https://crypto.stackexchange.com/questions/37084/is-pkcs7-a-signature-format-or-a-certificate-format</a> è¿™ç¯‡æ–‡ç« å¯¹ PKCS #7 è¿›è¡Œäº†æ¯”è¾ƒè¯¦ç»†çš„è®¨è®ºï¼›æ‘˜è¦éƒ¨åˆ†å¦‚ä¸‹ï¼Œ</p>
<blockquote>
<p>The <em>.p7b</em> or <em>.p7c</em> format is a special case of PKCS#7/CMS: a SignedData structure containing no â€œcontentâ€ and zero SignerInfos, but one or more certificates (usually) and/or CRLs (rarely).</p>
</blockquote>
<p>å¯ä»¥çŸ¥é“ï¼Œå¦‚æœä½¿ç”¨ PKCS#7 åŸç”Ÿæ ¼å¼ï¼Œå°†ä¼šä½¿ç”¨ <em>.p7c</em> åç¼€åï¼Œå¦‚æœä½¿ç”¨çš„æ˜¯ CMSï¼Œé‚£ä¹ˆä½¿ç”¨çš„æ˜¯ <em>.p7b</em> åç¼€ï¼›</p>
<p>ä» <a
  href="https://tools.ietf.org/html/rfc5652#section-12.1"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>https://tools.ietf.org/html/rfc5652#section-12.1</a> å¯ä»¥çœ‹åˆ°è¯¦ç»†çš„ ASN.1 ä¸­æœ‰å…³ CMS çš„æ ‡å‡†å®šä¹‰ï¼Œ</p>
<p>æ‘˜è¦éƒ¨åˆ†ä¿¡æ¯å¦‚ä¸‹ï¼Œ</p>
<ol>
<li>
<p>æ•°æ®å†…å®¹ä¿¡æ¯</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ContentInfo ::= SEQUENCE {
</span></span><span class="line"><span class="cl">  contentType ContentType,
</span></span><span class="line"><span class="cl">  content [0] EXPLICIT ANY DEFINED BY contentType }
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ContentType ::= OBJECT IDENTIFIER
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>æ•°æ®ç­¾åä¿¡æ¯</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">SignedData ::= SEQUENCE {
</span></span><span class="line"><span class="cl">  version CMSVersion,
</span></span><span class="line"><span class="cl">  digestAlgorithms DigestAlgorithmIdentifiers,
</span></span><span class="line"><span class="cl">  encapContentInfo EncapsulatedContentInfo,
</span></span><span class="line"><span class="cl">  certificates [0] IMPLICIT CertificateSet OPTIONAL,
</span></span><span class="line"><span class="cl">  crls [1] IMPLICIT RevocationInfoChoices OPTIONAL,
</span></span><span class="line"><span class="cl">  signerInfos SignerInfos }
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>ç­¾åè€…ä¿¡æ¯</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">SignerInfo ::= SEQUENCE {
</span></span><span class="line"><span class="cl">  version CMSVersion,
</span></span><span class="line"><span class="cl">  sid SignerIdentifier,
</span></span><span class="line"><span class="cl">  digestAlgorithm DigestAlgorithmIdentifier,
</span></span><span class="line"><span class="cl">  signedAttrs [0] IMPLICIT SignedAttributes OPTIONAL,
</span></span><span class="line"><span class="cl">  signatureAlgorithm SignatureAlgorithmIdentifier,
</span></span><span class="line"><span class="cl">  signature SignatureValue,
</span></span><span class="line"><span class="cl">  unsignedAttrs [1] IMPLICIT UnsignedAttributes OPTIONAL }
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>å¯†é’¥åŠ å¯†ç®—æ³•ä¿¡æ¯</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">KeyTransRecipientInfo ::= SEQUENCE {
</span></span><span class="line"><span class="cl">  version CMSVersion,  -- always set to 0 or 2
</span></span><span class="line"><span class="cl">  rid RecipientIdentifier,
</span></span><span class="line"><span class="cl">  keyEncryptionAlgorithm KeyEncryptionAlgorithmIdentifier,
</span></span><span class="line"><span class="cl">  encryptedKey EncryptedKey }
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>è¢«åŠ å¯†æ•°æ®çš„ä¿¡æ¯</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">EncryptedData ::= SEQUENCE {
</span></span><span class="line"><span class="cl">  version CMSVersion,
</span></span><span class="line"><span class="cl">  encryptedContentInfo EncryptedContentInfo,
</span></span><span class="line"><span class="cl">  unprotectedAttrs [1] IMPLICIT UnprotectedAttributes OPTIONAL }
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ol>
<p>å¯è§ï¼ŒPKCS#7 å®šä¹‰å®Œæ•´çš„ä¸€æ•´å¥—çš„ç”¨äºåŠ å¯†æ•°æ®ï¼Œç­¾åï¼Œç­¾åè€…ï¼ŒåŠ å¯†ç®—æ³•ç­‰ç­‰ä¸€ç³»åˆ—ä¿¡æ¯ï¼›ç”±æ­¤ï¼Œå¥ å®šäº†å…¶ä½œä¸º PKI çš„åŸºç¡€ï¼›</p>
<h2 id="pkcs-7-çš„ç”¨é€”">PKCS #7 çš„ç”¨é€”</h2>
<p><a
  href="http://stackoverflow.com/questions/3344527/what-for-are-the-commonly-used-pkcs-standards-pkcs7-pkcs10-and-pkcs12"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>http://stackoverflow.com/questions/3344527/what-for-are-the-commonly-used-pkcs-standards-pkcs7-pkcs10-and-pkcs12</a></p>
<p>æ‘˜æŠ„éƒ¨åˆ†å¦‚ä¸‹ï¼Œ</p>
<blockquote>
<p>PKCS#7 lets you sign and encrypt generic data using X.509 certificates. Also PKCS#7 format can be used to store one or more certificates without private keys (private keys can be put as a data payload and encrypted this way).</p>
</blockquote>
<p>PKCS#7 ä½¿å¾—ä½ å¯ä»¥é€šè¿‡ä½¿ç”¨ X.509 è¯ä¹¦å¯¹æ™®é€šçš„æ•°æ®è¿›è¡Œç­¾åå’ŒåŠ å¯†ï¼›PKCS#7 ä¹Ÿå¯ä»¥ç”¨æ¥å­˜æ”¾ä¸åŒ…å«ç§é’¥çš„ä¸€ä¸ªæˆ–è€…å¤šä¸ªè¯ä¹¦ï¼›</p>
<h2 id="pki">PKI</h2>
<p>å‰æ–‡æåˆ°äº†ï¼ŒPKCS#7 ç”¨æ¥ä¿è¯ PKI çš„åŠ å¯†æ ¼å¼æ ‡å‡†ï¼Œä¿è¯å…¬é’¥è¯ä¹¦çš„å®‰å…¨æ€§ï¼›</p>
<p>Public key infrastructureï¼šhttps://en.wikipedia.org/wiki/Public_key_infrastructure</p>
<p>å…¬é’¥åŸºç¡€è®¾æ–½ï¼ŒåŸºç¡€è®¾æ–½åŒ…å« CA(certificate authority)ã€RAã€VA ç­‰ï¼Œä» wikipedia çš„æè¿°ä¸Šæ¥çœ‹ï¼Œä¸»è¦æ˜¯ä¸ºäº†ä¿è¯å…¬é’¥è¯ä¹¦é¢å‘é€”å¾„ä¸­çš„å®‰å…¨æ€§ã€ä¿å¯†æ€§.. ç­‰ç­‰ç›¸å…³æªæ–½ï¼Œç›®çš„å°±æ˜¯ä¸ºäº†åœ¨å…¬é’¥è¯ä¹¦ä¼ é€’è¿‡ç¨‹ä¸­ï¼Œé¿å…å…¬é’¥è¢«ä¸²æ”¹ä»¥åä¿¡æ¯çš„ä¸å®‰å…¨æ€§..</p>
<p>TODOï¼Œå°†æ¥å‡†å¤‡å•ç‹¬å†™ä¸€ç« å…³äº PKI çš„åšæ–‡æ¥è¯¦ç»†çš„æè¿°æ­¤ç±»ç›¸å…³å†…å®¹ã€‚</p>
<h1 id="pkcs-8-private-key-information-syntax-standard">PKCS #8 Private-Key Information Syntax Standard</h1>
<p>Private-Key Information Syntax Standard ç§é’¥ä¿¡æ¯æ ¼å¼æ ‡å‡†ï¼Œçœ‹ Wikipedia çš„æè¿°ï¼Œ</p>
<blockquote>
<p>See <a
  href="https://tools.ietf.org/html/rfc5958"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>RFC 5958</a>. Used to carry private certificate keypairs (encrypted or unencrypted).</p>
</blockquote>
<p>ç”¨æ¥æºå¸¦<code>åŠ å¯†</code>çš„æˆ–è€…<code>æœªåŠ å¯†</code>çš„ç§é’¥è¯ä¹¦ï¼›ä¹Ÿå°±æ˜¯è¯´ï¼ŒPKCS#8 å®šä¹‰äº†ç§é’¥çš„åŠ å¯†å’ŒæœªåŠ å¯†çš„æ ¼å¼ï¼›</p>
<p>å¤‡æ³¨ï¼Œæœ€å¼€å§‹ PKCS#8 æ ‡å‡†æ˜¯ç”± RFC5208 æ ‡å‡†å®šä¹‰ï¼Œä½†æ˜¯åæ¥ä¸ºäº†æ›´å¥½çš„æ”¯æŒ PKI åŸºç¡€è®¾æ–½ï¼Œç”±æ–°çš„æ ‡å‡† RFC 5958 æ›¿æ¢äº†åŸæ¥çš„ RFC5208 æ ‡å‡†ï¼Œè¿™éƒ¨åˆ†å†…å®¹å¯ä»¥ä»åç»­éƒ¨åˆ† <a
  href="https://www.shangyang.me/2017/05/21/encrypt-rsa-pkcs/#RFC5958-Asymmetric-Key-Packages"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>RFC5958 Asymmetric Key Packages</a>ä¸­äº†è§£ï¼›ä½†å› ä¸º RFC5208 æ›´ç®€æ˜ï¼Œæ‰€ä»¥ï¼Œè¿™é‡Œé¦–å…ˆä»‹ç» RFC5208 çš„æ ‡å‡†å†…å®¹ï¼›</p>
<h2 id="rfc5208-private-key-information-syntax-specification">RFC5208 Private-Key Information Syntax Specification</h2>
<p>è¯¥æ–‡æ¡£ä¸­ä¸»è¦åŒ…å«äº†ä¸¤ä¸ªéƒ¨åˆ†ï¼Œprivate key çš„åŸå§‹æ ¼å¼ <a
  href="https://www.shangyang.me/2017/05/21/encrypt-rsa-pkcs/#private-key-info"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>private key info</a> å’Œ private key çš„åŠ å¯†æ ¼å¼ <a
  href="https://www.shangyang.me/2017/05/21/encrypt-rsa-pkcs/#encrypted-private-key-info"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>encrypted private key info</a>ï¼›</p>
<p><a
  href="https://tools.ietf.org/html/rfc5208"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>https://tools.ietf.org/html/rfc5208</a></p>
<h3 id="private-key-info">private key info</h3>
<p>Private-key information shall have ASN.1 type PrivateKeyInfo:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">PrivateKeyInfo ::= SEQUENCE {
</span></span><span class="line"><span class="cl">  version                   Version,
</span></span><span class="line"><span class="cl">  privateKeyAlgorithm       PrivateKeyAlgorithmIdentifier,
</span></span><span class="line"><span class="cl">  privateKey                PrivateKey,
</span></span><span class="line"><span class="cl">  attributes           [0]  IMPLICIT Attributes OPTIONAL }
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Version ::= INTEGER
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">PrivateKeyAlgorithmIdentifier ::= AlgorithmIdentifier
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">PrivateKey ::= OCTET STRING
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Attributes ::= SET OF Attribute
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡ ASN.1 æ ¼å¼å°è£…äº†ç§é’¥ï¼Œé‡è¦çš„æœ‰ä¸¤ä¸ªå­—æ®µï¼ŒprivateKeyAlgorithm å’Œ privateKeyï¼›</p>
<ul>
<li>
<p>privateKeyAlgorithm
è¡¨ç¤ºé‡‡ç”¨çš„æ˜¯ä»€ä¹ˆç®—æ³•ï¼Œå¯ä»¥æ˜¯ RSAï¼Œä¹Ÿå¯ä»¥æ˜¯å…¶å®ƒçš„ç®—æ³•ï¼Œæ¯”å¦‚ DESã€AES ç­‰å¯¹ç§°åŠ å¯†ç®—æ³•ç­‰ã€‚</p>
</li>
<li>
<p>privateKey
é€šè¿‡å…¶ç±»å‹å¯ä»¥çŸ¥é“ï¼Œæ˜¯ä¸€ä¸ª</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">PrivateKey ::= OCTET STRING
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯è§ï¼Œå…¶ç”±ä¸€ä¸ªå…«ä½å­—èŠ‚å­—ç¬¦ä¸²ç»„æˆï¼›è¿™å°±æ˜¯ç§é’¥çš„å†…å®¹ï¼Œå¦‚æœé‡‡ç”¨çš„æ˜¯ RSAï¼Œé‚£ä¹ˆè‡ªç„¶å­˜å‚¨çš„å°±æ˜¯ {N,d} ç­‰ç›¸å…³çš„ç§é’¥ä¿¡æ¯ï¼Œè¯¦æƒ…å‚è€ƒ<a
  href="https://www.shangyang.me/2017/05/21/encrypt-rsa-pkcs/#RSA-private-key-syntax-%e7%a7%81%e9%92%a5%e8%af%ad%e6%b3%95"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>RSA private key syntax</a>ï¼Œå¦‚æœé‡‡ç”¨çš„æ˜¯ DES ç®—æ³•å‘¢ï¼Œé‚£ä¹ˆå­˜å‚¨çš„å°±æ˜¯ DES key ç›¸å…³çš„ä¿¡æ¯â€¦</p>
</li>
</ul>
<p>æ‘˜æŠ„ä¸¤ç«¯æ ¸å¿ƒçš„å†…å®¹å¦‚ä¸‹</p>
<blockquote>
<p><strong>privateKeyAlgorithm</strong> identifies the private-key algorithm. One example of a private-key algorithm is PKCS #1â€™s rsaEncryption [PKCS#1].</p>
</blockquote>
<p>privateKeyAlgorithm è¡¨ç¤ºç§é’¥æ‰€ä½¿ç”¨çš„ç®—æ³•ï¼Œä¸€ä¸ªä¾‹å­å°±æ˜¯ PKCS#1 æ‰€è¡¨è¿°çš„ PKCS#1 çš„ rsa åŠ å¯†æŠ€æœ¯ï¼›</p>
<blockquote>
<p><strong>privateKey</strong> is an octet string whose contents are the value of the private key. The interpretation of the contents is defined in the registration of the private-key algorithm. For an RSA private key, for example, the contents are a BER encoding of a value of type RSAPrivateKey.</p>
</blockquote>
<p>privateKey æ˜¯ä¸€ä¸ªåŒ…å«ç§é’¥å†…å®¹çš„å…«ä½å­—èŠ‚å­—ç¬¦ä¸² octet stringï¼Œè¯¥å†…å®¹ç”±å…¶åŠ å¯†ç®—æ³•æ‰€æè¿°å’Œè§£é‡Šï¼›æ¯”å¦‚ RSA ç§é’¥ï¼Œå…¶å†…å®¹è¡¨ç¤ºä¸€ä¸ªé€šè¿‡ BER ç¼–ç çš„ç§é’¥ï¼›</p>
<p>æ€»ç»“ä¸€ä¸‹ï¼Œ</p>
<p>å¯ä»¥çœ‹åˆ°ï¼ŒPKCS #8 åœ¨åŸæ¥ç§é’¥çš„æ ¼å¼ä¸Šåšäº†ä¸€å±‚æŠ½è±¡å°è£…ï¼Œè¿™æ ·ä½¿å¾—å®ƒå¯ä»¥å…¼å®¹ä»»ä½•çš„ç§é’¥æ ¼å¼ï¼›ä½¿å¾— PKCS çš„ç§é’¥æ ‡å‡†å¯ä»¥ä½¿ç”¨åˆ°ä»»ä½•åŠ å¯†ç®—æ³•ï¼Œè¿™ä¸ªåŒ PKCS#1 ä¸­å®šä¹‰çš„ RSA <a
  href="https://www.shangyang.me/2017/05/21/encrypt-rsa-pkcs/#RSA-private-key-syntax-%e7%a7%81%e9%92%a5%e8%af%ad%e6%b3%95"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>ç§é’¥è¯­æ³•</a>æ˜¯ä¸åŒçš„ï¼ŒPKCS #1 å®šä¹‰çš„åªæ˜¯ç‰¹å®šçš„ RSA ç§é’¥çš„è¯­æ³•æ ¼å¼ï¼›</p>
<p>Okï¼Œä»è¿™é‡Œå°±å¯ä»¥æ¸…æ™°çš„çœ‹åˆ° PKCS çš„å‘å±•æ–¹å‘äº†ï¼ŒPKCS ä½“ç³»å·²ç»çªç ´äº†å•çº¯çš„ RSA åŠ å¯†ç®—æ³•ï¼Œè€Œæ˜¯æ‰©å±•åˆ°äº†å¯ä»¥é€‚é…ä»»ä½•çš„åŠ å¯†ç®—æ³•ï¼Œæ‰€ä»¥ï¼ŒPKCS å·²ç»æˆä¸ºäº†ä¸€ç§é€šç”¨çš„å¯†ç å­¦æ ¼å¼æ ‡å‡†ã€‚å½“ç„¶ï¼ŒCMS åœ¨æ­¤åŸºç¡€ä¸Šæ›´è¿›ä¸€æ­¥ï¼Œå»ºç«‹äº† PKI ä½“ç³»ä¸­æ‰€éœ€çš„å…¶å®ƒç±»å‹ä¿¡æ¯ï¼ŒåŒ…æ‹¬åŠ å¯†æ•°æ®ï¼Œç­¾åï¼Œç­¾åè€…ï¼ŒåŠ å¯†ç®—æ³•ç­‰ç­‰å…¬é’¥åŠ å¯†æŠ€æœ¯åŸºç¡€è®¾æ–½ç›¸å…³çš„ä¸œè¥¿ï¼Œè¯¦æƒ…å‚è€ƒ<a
  href="https://www.shangyang.me/2017/05/21/encrypt-rsa-pkcs/#PKCS-7-Format"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>PKCS #7 Format</a>éƒ¨åˆ†ï¼Œè€Œè¿™éƒ¨åˆ†æ­£æ˜¯ RFC5958 æ ‡å‡†æ·˜æ±°å½“å‰ RFC5208 æ ‡å‡†çš„åœ°æ–¹ï¼Œä¸è¿‡ç²¾åå…¶å®è¿˜æ˜¯åœ¨ RFC5208ï¼›</p>
<h3 id="encrypted-private-key-info">encrypted private key info</h3>
<p><a
  href="https://tools.ietf.org/html/rfc5208#section-6"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>https://tools.ietf.org/html/rfc5208#section-6</a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">EncryptedPrivateKeyInfo ::= SEQUENCE {
</span></span><span class="line"><span class="cl">  encryptionAlgorithm  EncryptionAlgorithmIdentifier,
</span></span><span class="line"><span class="cl">  encryptedData        EncryptedData }
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">EncryptionAlgorithmIdentifier ::= AlgorithmIdentifier
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç›¸å…³æ ¸å¿ƒå†…å®¹æ‘˜æŠ„å¦‚ä¸‹ï¼Œ</p>
<blockquote>
<p>The fields of type EncryptedPrivateKeyInfo have the following meanings:</p>
</blockquote>
<p><strong>encryptionAlgorithm</strong> identifies the algorithm under which the private-key information is encrypted. Two examples are <em>PKCS #5â€™s pbeWithMD2AndDES-CBC</em> and <em>pbeWithMD5AndDES-CBC [PKCS#5]</em>.</p>
<p><strong>encryptionAlgorithm</strong> å­—æ®µè¡¨ç¤ºç§é’¥ä½¿ç”¨ä»€ä¹ˆç®—æ³•è¿›è¡ŒåŠ å¯†çš„ï¼›é€šå¸¸ä½¿ç”¨ PKCS#5 çš„ <em>MD2AndDES</em> æˆ–è€… <em>MD5AndDES</em> ä¸¤ç§åŠ å¯†ç®—æ³•ï¼›</p>
<blockquote>
<p><strong>encryptedData</strong> is the result of encrypting the private-key information.</p>
</blockquote>
<p><strong>encryptedData</strong> æ˜¯ç§é’¥é€šè¿‡åŠ å¯†ç®—æ³• <strong>encryptionAlgorithm</strong> åŠ å¯†ä»¥åçš„å†…å®¹ï¼›</p>
<blockquote>
<p>The encryption process involves the following two steps:</p>
<ol>
<li>The private-key information is BER encoded, yielding an octet string.</li>
<li>The result of step 1 is encrypted with the secret key to give an octet string, the result of the encryption process.</li>
</ol>
</blockquote>
<p>åŠ å¯†è¿‡ç¨‹åŒ…å«ä¸¤ä¸ªæ­¥éª¤ï¼Œ</p>
<ol>
<li>ç§é’¥çš„å†…å®¹é€šè¿‡ BER ç¼–ç ï¼Œå¹¶äº§ç”Ÿç›¸å…³çš„å…«ä½å­—èŠ‚å­—ç¬¦ä¸² octet string</li>
<li>ç¬¬ä¸€æ­¥äº§ç”Ÿçš„ç»“æœå°†ä¼šé€šè¿‡å¯†é’¥(secret key)è¿›è¡ŒåŠ å¯†å¹¶å†äº§ç”Ÿä¸€ä¸ª octet stringï¼Œè¯¥ octet string ä¾¿æ˜¯è¿™ä¸ªåŠ å¯†è¿‡ç¨‹çš„ç»“æœï¼›</li>
</ol>
<p>å¯ä»¥çœ‹åˆ°ï¼Œç§é’¥çš„æ•´ä¸ªå†…å®¹éƒ½è¢« <em>encryptionAlgorithm</em> æ‰€æŒ‡æ˜çš„åŠ å¯†ç®—æ³•è¿›è¡Œäº†åŠ å¯†ï¼›</p>
<h2 id="rfc5958-asymmetric-key-packages">RFC5958 Asymmetric Key Packages</h2>
<p>çœ‹çœ‹ RFC5958 çš„ Introduction ç« èŠ‚ï¼Œ</p>
<blockquote>
<p>This document defines the syntax for private-key information and a
Cryptographic Message Syntax (CMS) [RFC5652] content type for it. Private-key information includes a private key for a specified public-key algorithm and a set of attributes. The CMS can be used to digitally sign, digest, authenticate, or encrypt the asymmetric key format content type. This document obsoletes PKCS #8 v1.2 [RFC5208].</p>
</blockquote>
<p>å¯è§ RFC5958 å®šä¹‰äº†ä¸ä½†ç§é’¥çš„è¯­æ³•è¿˜å®šä¹‰äº†ç›¸å…³çš„ CMS çš„æ–‡æœ¬ç±»å‹(content type)ï¼›Private-key information åŒ…å«äº†ä¸€ä¸ªç‰¹å®šå…¬é’¥ç®—æ³•çš„ç§é’¥ä»¥åŠä¸€äº›åˆ—çš„å±æ€§ï¼›CMS å¯ä»¥ç”¨æ¥è¿›è¡Œæ•°å­—ç­¾åï¼Œdigestï¼ŒéªŒè¯æˆ–è€…ç”¨æ¥åŠ å¯†éå¯¹ç§°å¯†é’¥çš„å†…å®¹å’Œæ ¼å¼ï¼›è¯¥æ–‡æ¡£æ·˜æ±°äº†è¿‡æ—¶çš„ PKCS #8 v1.2 [RFC5208]ï¼›</p>
<p>RFC5958 Asymmetric Key Packages: <a
  href="https://tools.ietf.org/html/rfc5958"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>https://tools.ietf.org/html/rfc5958</a> æ·˜æ±°äº†è¿‡æ—¶çš„ RFC5208 PKCS #8: Private-Key Information Syntax Specification Version 1.2 <a
  href="https://tools.ietf.org/html/rfc5208"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>https://tools.ietf.org/html/rfc5208</a>ï¼›</p>
<p>è™½ç„¶æ˜¯æ·˜æ±°äº† RFC5208ï¼Œä¸è¿‡ç¬”è€…åœ¨é˜…è§ˆå®Œ RFC5208 ä»¥åï¼Œå‘ç° RFC5208 å†…å®¹æ›´ä¸ºæ¸…æ™°æ˜“æ‡‚ï¼Œæ‰€ä»¥ï¼Œè¿˜æ˜¯æ‰“ç®—ä» RFC5208 å…¥æ‰‹è¿›è¡Œæ¢³ç†ï¼›è¿™éƒ¨åˆ†å†…å®¹å‚è€ƒ <a
  href="https://www.shangyang.me/2017/05/21/encrypt-rsa-pkcs/#RFC5208-Private-Key-Information-Syntax-Specification"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>RFC5208 Private-Key Information Syntax Specification</a></p>
<p>åç»­ RFC5958 éå¸¸è¯¦ç»†çš„æè¿°äº†æœ‰å…³ CMS çš„å†…å®¹å®šä¹‰ï¼Œä»¥åŠç§é’¥åŠ å¯† ASN.1 æ ¼å¼çš„å®šä¹‰ï¼Œè¿™é‡Œå°±ä¸å†ä¸€ä¸€èµ˜è¿°äº†ï¼›</p>
<h3 id="ç§é’¥æ–‡ä»¶çš„æ ¼å¼">ç§é’¥æ–‡ä»¶çš„æ ¼å¼</h3>
<p>RFC5958 ç”¨ä¸å¤šçš„ç¯‡å¹…æ¥æè¿°äº†ç§é’¥çš„æ–‡ä»¶å­˜å‚¨æ ¼å¼ï¼›ä¸è¿‡ä»¥ä¸‹å†…å®¹æ¯”è¾ƒé›¶æ•£ï¼Œä¸»è¦æ˜¯ç¿»è¯‘å®˜æ–¹æ–‡æ¡£å¹¶åšä¸€äº›ä¸ªäººçš„ç†è§£ï¼›</p>
<p>è¯¥å°èŠ‚ä¸»è¦æ¥è®²è§£ç§é’¥çš„å­˜å‚¨æ ¼å¼ï¼Œçœ‹ä¸‹ RFC5958 ä¸­çš„ä¸€æ®µ<a
  href="https://tools.ietf.org/html/rfc5958#section-5"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>æè¿°</a>ï¼Œ</p>
<blockquote>
<p>To extract the private-key information from the AsymmetricKeyPackage, the encapsulating layers need to be removed. At a minimum, the outer ContentInfo [RFC5652] layer needs to be removed. If the AsymmetricKeyPackage is encapsulated in a SignedData [RFC5652], then the SignedData and EncapsulatedContentInfo layers [RFC5652] also need to be removed. The same is true for EnvelopedData, EncryptedData, and AuthenticatedData all from [RFC5652] as well as AuthEnvelopedData from [RFC5083].</p>
</blockquote>
<p>è¿™æ®µè¯çš„æ„æ€å°±æ˜¯è¯´ï¼Œè¦æå–é€šè¿‡ AsymmetricKeyPackage æ ¼å¼æ‰€å°è£…çš„ç§é’¥ï¼Œå¿…é¡»å‰¥ç¦»å…¶å¤–éƒ¨çš„å°è£…å±‚ï¼›è‡³å°‘ï¼Œå¤–éƒ¨çš„ ContentInfo[RFC5652] æ˜¯éœ€è¦è¢«å‰¥ç¦»å‡ºå»çš„ï¼›å¦‚æœå°è£…äº†ç­¾åï¼ŒåŒæ ·è¯¥ç­¾åéœ€è¦è¢«å‰¥ç¦»ï¼›åŒæ ·çš„ï¼Œå¦‚æœæœ‰å…¶å®ƒçš„å°è£…æ•°æ®ï¼Œæ¯”å¦‚åŠ å¯†çš„æ•°æ®ï¼ŒéªŒè¯çš„æ•°æ®ç­‰åŒæ ·éœ€è¦å‰¥ç¦»å‡ºå»ï¼›</p>
<blockquote>
<p>Once all the outer layers are removed, there are as many sets of private-key information as there are OneAsymmetricKey structures. OneAsymmetricKey and PrivateKeyInfo are the same structure; therefore, either can be saved as a <code>.p8</code> file or copied in to the <code>P12</code> KeyBag BAG-TYPE. Removing encapsulating security layers will invalidate any signature and may expose the key to unauthorized disclosure.</p>
</blockquote>
<p>å½“æ‰€æœ‰çš„å¤–éƒ¨å±‚æ¬¡éƒ½è¢«å‰¥ç¦»ä»¥åï¼Œæ‰€å‰©ä¸‹çš„ä¹Ÿå°±æ˜¯æœ€ç»ˆç§é’¥çš„ä¿¡æ¯ç»“æ„äº†ï¼›è¯¥ç§é’¥çš„ä¿¡æ¯å¯ä»¥é€šè¿‡<code>.p8</code>æ ¼å¼æ–‡ä»¶æˆ–è€…æ˜¯é€šè¿‡<code>P12</code> KeyBag BAG-TYPE æ ¼å¼è¿›è¡Œå­˜å‚¨ï¼›ä¸è¿‡æ³¨æ„çš„æ˜¯ï¼Œé€šè¿‡ä¹‹å‰çš„æ­¥éª¤å±‚å±‚å‰¥ç¦»ï¼Œè‹¥å°†å®‰å…¨å±‚ä¹Ÿå‰¥ç¦»ä»¥åï¼Œå°†ä¼šä½¿å¾—ä»»ä½•ç­¾åæ— æ•ˆå¹¶ä¸”ä¼šå°†ç§é’¥æš´éœ²ç»™éæˆæƒæœºæ„ï¼›</p>
<p>ä¸‹é¢è¿™æ®µæœ‰æ„æ€äº†ï¼ŒåŸºæœ¬ä¸Šé˜è¿°äº†é€šè¿‡<code>.p8</code>æ ¼å¼å­˜å‚¨çš„ç§é’¥çš„æ ¼å¼ï¼Œä¸è¿‡å°±æ˜¯ä¸å¤Ÿç»†è‡´ï¼Œä¹Ÿä¸å¤Ÿç”ŸåŠ¨å½¢è±¡ï¼Œå®˜ç½‘çš„å†…å®¹å°±æ˜¯è¿™æ ·ï¼Œç‚¹åˆ°ä¸ºæ­¢ï¼Œçœ‹å¾—äººç—›ä¸æ¬²ç”Ÿï¼›</p>
<blockquote>
<p><code>.p8</code> files are sometimes <code>PEM</code>-encoded. When .p8 files are <code>PEM</code> encoded they use the <code>.pem</code> file extension. <code>PEM</code> encoding is</p>
<ul>
<li>either the <code>Base64</code> encoding, from Section 4 of [RFC4648], of the <code>DER</code>-encoded <code>EncryptedPrivateKeyInfo</code> sandwiched between:</li>
</ul>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">-----BEGIN ENCRYPTED PRIVATE KEY-----
</span></span><span class="line"><span class="cl">-----END ENCRYPTED PRIVATE KEY-----
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<ul>
<li>
<p>or the Base64 encoding, see Section 4 of [RFC4648], of the</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">DER
</span></span></code></pre></td></tr></table>
</div>
</div><p>-encoded</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">PrivateKeyInfo
</span></span></code></pre></td></tr></table>
</div>
</div><p>sandwiched between:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">-----BEGIN PRIVATE KEY-----
</span></span><span class="line"><span class="cl">-----END PRIVATE KEY-----
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</blockquote>
<p>ä¸Šé¢è¿™æ®µæ¯”è¾ƒé‡è¦äº†ï¼Œé˜è¿°äº†å¯†é’¥é€šè¿‡<code>.p8</code>åŠ å¯†å­˜å‚¨çš„æ ¼å¼ï¼Œ<code>.p8</code>æ–‡ä»¶æ˜¯ä¸€ç§é€šè¿‡<code>PEM</code>ç¼–ç çš„æ–‡ä»¶ï¼Œå½“<code>.p8</code>æ–‡ä»¶é€šè¿‡<code>PEM</code>è¿›è¡Œç¼–ç çš„æ—¶å€™ï¼Œå®ƒä»¬çš„æ–‡ä»¶åç¼€ä¸º<code>.pem</code>ï¼›<code>PEM</code>ç¼–ç æ ¼å¼æœ‰ä¸¤ç§æ–¹å¼</p>
<ol>
<li>
<p>ä½¿ç”¨<code>DER</code>ç¼–ç çš„<code>EncryptedPrivateKeyInfo</code>é€šè¿‡<code>Base64</code>è½¬ç åè¢«åŒ…è£¹ä¸‹é¢çš„ä¸¤æ®µæ ‡è¯†ç¬¦ä¸­</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">-----BEGIN ENCRYPTED PRIVATE KEY-----
</span></span><span class="line"><span class="cl">-----END ENCRYPTED PRIVATE KEY-----
</span></span></code></pre></td></tr></table>
</div>
</div><p>çœ‹è¿‡å®˜ç½‘è§£é‡Šï¼Œä½ æ­¤æ—¶çš„çŠ¶æ€åº”è¯¥æ˜¯äº‘é‡Œé›¾é‡Œçš„ï¼›è¿™é‡Œä½œè€…æƒ³è¡¨è¾¾çš„æ˜¯ä»€ä¹ˆæ„æ€å‘¢â€¦ è¿™é‡Œå°±æ˜¯è¡¨ç¤ºçš„å¦‚æœç§é’¥æœ¬èº«æ˜¯ç»è¿‡åŠ å¯†å­˜å‚¨çš„ï¼Œæ—¢æ˜¯ RFC5208 ä¸­æ‰€å®šä¹‰çš„ <a
  href="https://www.shangyang.me/2017/05/21/encrypt-rsa-pkcs/#encrypted-private-key-info"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>EncryptedPrivateKeyInfo</a> æ‰€è¡¨è¿°çš„ä¿¡æ¯ï¼Œé‚£ä¹ˆä¼šä½¿ç”¨å¦‚ä¸Šçš„æ ¼å¼æ¥è¿›è¡Œå­˜å‚¨ï¼›</p>
</li>
<li>
<p>ä½¿ç”¨<code>DER</code>ç¼–ç çš„<code>PrivateKeyInfo</code>é€šè¿‡<code>Base64</code>è½¬ç åè¢«åŒ…è£¹ä¸‹é¢çš„ä¸¤æ®µæ ‡è¯†ç¬¦ä¸­</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">-----BEGIN PRIVATE KEY-----
</span></span><span class="line"><span class="cl">-----END PRIVATE KEY-----
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>PrivateKeyInfo</code>è¿™é‡Œè¡¨ç¤ºçš„å°±æ˜¯æ˜æ–‡ï¼Œæ—¢æ˜¯å¯†é’¥æ²¡æœ‰ç»è¿‡åŠ å¯†ï¼Œæ˜¯é€šè¿‡<code>Base64</code>æ‰€å­˜å‚¨çš„æ˜æ–‡æ ¼å¼ï¼›</p>
</li>
</ol>
<p>æ›´å¤šæœ‰å…³æ­¤éƒ¨åˆ†çš„ä»‹ç»æŸ¥çœ‹ <a
  href="https://www.shangyang.me/2017/05/24/encrypt-rsa-keyformat/"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>RSA(ä¸‰) å¯†é’¥çš„æ ¼å¼</a>éƒ¨åˆ†å†…å®¹ï¼›</p>
]]></description>
</item><item>
  <title>RSA(ä¸€) èƒŒåçš„æ•°å­¦åŸç†</title>
  <link>https://ronin-zc.com/rsa%E4%B8%80-%E8%83%8C%E5%90%8E%E7%9A%84%E6%95%B0%E5%AD%A6%E5%8E%9F%E7%90%86/</link>
  <pubDate>Wed, 03 Mar 2021 13:40:25 &#43;0800</pubDate>
  <author>RoninZc</author>
  <guid>https://ronin-zc.com/rsa%E4%B8%80-%E8%83%8C%E5%90%8E%E7%9A%84%E6%95%B0%E5%AD%A6%E5%8E%9F%E7%90%86/</guid>
  <description><![CDATA[<h1 id="å‰è¨€">å‰è¨€</h1>
<p>æœ¬ç¯‡æ–‡ç« å°†è¯•å›¾ä»æ•°å­¦åŸç†ä¸Šç†æ¸… RSA çš„åŠ å¯†è§£å¯†çš„åŸç†ï¼›å¹¶å†™ä¸€ä¸ªç®€å•çš„åŠ å¯†è§£å¯†çš„ç”¨ä¾‹æ¥ä½¿ç”¨ï¼›</p>
<p>å¤‡æ³¨ï¼Œæœ¬æ–‡æ˜¯ä½œè€…çš„åŸåˆ›ä½œå“ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>
<blockquote>
<p>è½¬è½½è‡³<code>https://www.shangyang.me/2017/05/24/encrypt-rsa-keyformat/</code></p>
</blockquote>
<h1 id="æ•°è®ºç›¸å…³">æ•°è®ºç›¸å…³</h1>
<h2 id="æ¨¡-n">æ¨¡ N</h2>
<p>éšæœºé€‰æ‹©ä¸¤ä¸ªå¤§çš„è´¨æ•° p å’Œ qï¼Œp ä¸ç­‰äº q, è®¡ç®—å¾—åˆ° ğ‘=ğ‘ğ‘N=pq</p>
<h2 id="æ¬§æ‹‰å‡½æ•°çš„å€¼-r--ğœ‘pq">æ¬§æ‹‰å‡½æ•°çš„å€¼ r = ğœ‘(pq)</h2>
<p>ğ‘Ÿ=ğœ‘(ğ‘ğ‘)=ğœ‘(ğ‘)ğœ‘(ğ‘)=(ğ‘âˆ’1)(ğ‘âˆ’1)r=ğœ‘(pq)=ğœ‘(p)ğœ‘(q)=(pâˆ’1)(qâˆ’1)</p>
<p>æ¬§æ‹‰å‡½æ•°å€¼æ±‚çš„æ˜¯æœ‰å¤šå°‘ä¸ªå°äº N çš„æ•°ä¸ N äº’è´¨ï¼Œå¦‚æœ N æœ¬èº«ä¸ºè´¨æ•°ï¼Œé‚£ä¹ˆå°±æœ‰ N-1 ä¸ªæ•°ä¸ N äº’è´¨ï¼›</p>
<h2 id="éšæœºæ•°-e">éšæœºæ•° e</h2>
<p>é€‰æ‹©ä¸€ä¸ªæ•´æ•° e ä¸” 1&lt;ğ‘’&lt;ğ‘Ÿ1&lt;e&lt;rï¼Œä½¿å¾— e ä¸ r äº’è´¨(ä¸¤ä¸ªæ•°çš„å…¬çº¦æ•°ä¸º 1)ï¼›å– e çš„ç›®çš„æ˜¯ä¸ºäº†æ±‚å¾— e å…³äº r çš„<a
  href="https://www.shangyang.me/2017/05/19/encrypt-rsa-math/"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>æ¨¡åå…ƒç´ </a> dï¼›</p>
<h2 id="æ¨¡åå…ƒç´ -d">æ¨¡åå…ƒç´  d</h2>
<h3 id="ä»€ä¹ˆæ˜¯æ¨¡åå…ƒç´ -d">ä»€ä¹ˆæ˜¯æ¨¡åå…ƒç´  d</h3>
<p>ç”±<a
  href="https://www.shangyang.me/2017/05/19/encrypt-rsa-math/#%e9%9a%8f%e6%9c%ba%e6%95%b0-e"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>e</a>å°èŠ‚å¯çŸ¥ï¼Œæ¨¡åå…ƒç´  d æ˜¯ e å…³äº r çš„æ¨¡åå…ƒç´ ä¸”è‹¥æ¨¡åå…ƒç´  d å­˜åœ¨ï¼Œå½“ä¸”ä»…å½“ e ä¸ r äº’è´¨ï¼›</p>
<p>æ¨¡åå…ƒç´ çš„æ•°å­¦æ„ä¹‰</p>
<p>ğ‘’ğ‘‘â‰¡1(modğ‘Ÿ)edâ‰¡1(modr)</p>
<p>è‹¥ e ä¸ r äº’è´¨ï¼Œé‚£ä¹ˆæ€»ä¼šæ‰¾åˆ°è¿™ä¹ˆä¸€ä¸ªæ•° dï¼Œä½¿å¾— ed å’Œ 1 ä¸æ¨¡ r åŒä½™ï¼›é€šä¿—çš„è¯´æ³•æ—¢æ˜¯ï¼Œed é™¤ä»¥ r çš„ä½™æ•°ä¸ 1 é™¤ä»¥ r çš„ä½™æ•°ç›¸ç­‰ï¼Œå› ä¸º 1 é™¤ä»¥ r çš„ä½™æ•°æ’ç­‰äº 1ï¼Œæ‰€ä»¥ ed é™¤ä»¥ r çš„ä½™æ•°ä¸º 1ï¼Œä¹Ÿå°±æ¨å‡º</p>
<p>ğ‘’ğ‘‘âˆ’1=ğ‘˜ğ‘Ÿedâˆ’1=kr</p>
<p>ï¼Œè¯¥è¡¨è¾¾å¼çš„æ„æ€å°±æ˜¯ ed - 1 æ˜¯ r çš„å€æ•°ï¼›</p>
<h3 id="å¦‚ä½•è®¡ç®—å¾—åˆ°-d">å¦‚ä½•è®¡ç®—å¾—åˆ° d</h3>
<p>é‚£ä¹ˆå¦‚ä½•è®¡ç®—å¾—å‡ºæ­¤æ¨¡åå…ƒç´  d å‘¢ï¼Ÿ</p>
<p>æ ¹æ®<a
  href="https://zh.wikipedia.org/wiki/%e6%89%a9%e5%b1%95%e6%ac%a7%e5%87%a0%e9%87%8c%e5%be%97%e7%ae%97%e6%b3%95"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•</a>çš„å…¬å¼æœ‰ï¼Œåœ¨(modğ‘Ÿ)(modr)ä¹‹ä¸‹ï¼Œ</p>
<p>ğ‘’ğ‘¥+ğ‘Ÿğ‘¦=1ex+ry=1</p>
<p>ï¼Œæ­¤æ—¶ x çš„è§£æ—¢æ˜¯ e å…³äºæ¨¡ r çš„ä¸€ä¸ªæ¨¡åå…ƒç´ ï¼›è®¤çœŸçš„è¯»è€…è¯»åˆ°è¿™é‡Œï¼Œè‚¯å®šä¼šäº§ç”Ÿç–‘é—®ï¼Œä¸Šé¢çš„å…¬å¼ ğ‘’ğ‘‘âˆ’1=ğ‘˜ğ‘Ÿedâˆ’1=kr æ€ä¹ˆçœ‹èµ·æ¥ä¸ ğ‘’ğ‘¥+ğ‘Ÿğ‘¦=1ex+ry=1 æ€ä¹ˆè¿™ä¹ˆåƒå‘¢ï¼Œä½†æ˜¯åˆæœ‰å·®åˆ«ï¼Œæˆ‘ä»¬å°†å…¬å¼ ğ‘’ğ‘‘âˆ’1=ğ‘˜ğ‘Ÿedâˆ’1=kr è°ƒæ•´ä¸€ä¸‹ï¼Œå¾—åˆ°</p>
<p>ğ‘’ğ‘‘âˆ’ğ‘˜ğ‘Ÿ=1â€¦â‘ edâˆ’kr=1â€¦â‘ </p>
<p>å°†æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•çš„å…¬å¼ ğ‘’ğ‘¥+ğ‘Ÿğ‘¦=1ex+ry=1 çš„ xã€y å€¼è¿›è¡Œæ›¿æ¢ï¼Œx = d, y = kï¼Œå¾—åˆ°</p>
<p>ğ‘’ğ‘‘+ğ‘˜ğ‘Ÿ=1â€¦â‘¡ed+kr=1â€¦â‘¡</p>
<p>ä»€ä¹ˆï¼Œä¸¤ä¸ªçœ‹ä¼¼å¦‚æ­¤çŸ›ç›¾çš„ä¸¤ä¸ªä¸åŒçš„æ–¹ç¨‹(å…¬å¼ â‘  å’Œå…¬å¼ â‘¡)â€¦ ä»€ä¹ˆæ„æ€ï¼Ÿè°æ˜¯å¯¹çš„ï¼Ÿè°æ˜¯é”™çš„ï¼Ÿ</p>
<p>æ‘˜æŠ„<a
  href="https://zh.wikipedia.org/wiki/%e6%a8%a1%e5%8f%8d%e5%85%83%e7%b4%a0"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>æ¨¡åå…ƒç´ </a>ä¸­çš„ä¸€æ®µå†…å®¹å¦‚ä¸‹ï¼Œ</p>
<blockquote>
<p>äº‹å®ä¸Šï¼Œ ğ‘¥+ğ‘˜ğ‘›(ğ‘˜âˆˆâ„¤)x+kn(kâˆˆâ„¤)éƒ½æ˜¯aå…³äºæ¨¡nçš„æ¨¡é€†å…ƒï¼Œè¿™é‡Œæˆ‘ä»¬å–æœ€å°çš„æ­£æ•´æ•°è§£ ğ‘¥(modğ‘›)(ğ‘¥&lt;ğ‘›)x(modn)(x&lt;n)</p>
</blockquote>
<p>å¯¹åº”åˆ°æˆ‘ä»¬çš„ä¾‹å­ä¸­æ¥ï¼Œä¹Ÿå°±æ˜¯ ğ‘‘+ğ‘˜ğ‘Ÿ(ğ‘˜âˆˆâ„¤)d+kr(kâˆˆâ„¤) éƒ½æ˜¯ e å…³äºæ¨¡ r çš„æ¨¡é€†å…ƒï¼Œè¿™é‡Œæˆ‘ä»¬å–æœ€å°çš„æ­£æ•´æ•°è§£ ğ‘‘(modğ‘Ÿ)(ğ‘‘&lt;ğ‘Ÿ)d(modr)(d&lt;r)ï¼›ç”±æ­¤å¯çŸ¥ï¼Œd çš„è§£å®é™…ä¸Šæœ‰æ— é™å¤šä¸ªï¼Œæ»¡è¶³ ğ‘‘+ğ‘˜ğ‘Ÿ(ğ‘˜âˆˆâ„¤)d+kr(kâˆˆâ„¤)ï¼›k æ˜¯æ•´æ•°é›†åˆï¼ŒåŒ…å«æ­£æ•´æ•°ã€è´Ÿæ•´æ•°å’Œé›¶ï¼›</p>
<p>å…¶å®ï¼Œå…¬å¼â‘ å’Œå…¬å¼â‘¡å…¶å®å¯ä»¥ç†è§£ä¸ºåŒä¸€ä¸ªæ–¹ç¨‹ï¼Œåªæ˜¯ Y è½´ï¼ˆè¿™é‡ŒæŒ‡ K è½´ï¼‰çš„æ–¹å‘å‘ç”Ÿäº†å˜åŒ–è€Œå·²ï¼›</p>
<h1 id="åŠ å¯†å’Œè§£å¯†">åŠ å¯†å’Œè§£å¯†</h1>
<p>å‡è®¾ Bob æƒ³ç»™ Alice é€ä¸€ä¸ªæ¶ˆæ¯ mï¼›</p>
<h2 id="å…¬é’¥å’Œå¯†é’¥">å…¬é’¥å’Œå¯†é’¥</h2>
<p>åœ¨ Alice ç«¯ï¼Œç»è¿‡ä¸Šè¿°çš„æ­¥éª¤ï¼Œæˆ‘ä»¬æ€»å…±å¾—åˆ°äº† 6 ä¸ªæ•°å­—ï¼Œpã€qã€Nã€rã€eã€dï¼›å¹¶ç”Ÿæˆå…¬é’¥å’Œå¯†é’¥ï¼Œå…¬é’¥å°±æ˜¯(ğ‘ã€ğ‘’)(Nã€e)ç»„åˆï¼›ç§˜é’¥å°±æ˜¯(ğ‘ã€ğ‘‘)(Nã€d)ç»„åˆï¼›å¹¶ä¸” Alice å°†å…¬é’¥å‘é€ç»™ Bobï¼›</p>
<h2 id="åŠ å¯†è¿‡ç¨‹">åŠ å¯†è¿‡ç¨‹</h2>
<p>Bob æƒ³ç»™ Alice é€ä¸€ä¸ªæ¶ˆæ¯ Mï¼Œä»–æ‹¥æœ‰ Alice çš„å…¬é’¥ï¼Œæ—¢æ˜¯ (ğ‘ã€ğ‘’)(Nã€e) ã€‚ä»–ä½¿ç”¨èµ·å…ˆä¸ Alice çº¦å¥½çš„ç¼–ç æ ¼å¼å°† M è½¬æ¢ä¸ºä¸€ä¸ª<code>å°äº</code> æ¨¡ <a
  href="https://www.shangyang.me/2017/05/19/encrypt-rsa-math/#%e6%a8%a1-N"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>N</a>ï¼Œä¸”ä¸ N äº’è´¨çš„æ•´æ•° mï¼›é€šå¸¸ï¼Œæˆ‘ä»¬ä¼ é€’çš„æ˜¯å­—ç¬¦ä¸²ï¼Œä½†æ˜¯å­—ç¬¦å¯ä»¥è½¬æ¢ä¸ºå¯¹åº”çš„ ASCII ç å€¼æˆ–è€… UNICODE ç­‰æ•´æ•°æ•°å€¼ï¼›ç”±äºè½¬æ¢åçš„æ•°å­—å¿…é¡»è¦å°äº Nï¼Œæ‰€ä»¥ï¼Œä¸€èˆ¬çš„åšæ³•æ˜¯ï¼Œå°†åŸæ¥çš„æ–‡æœ¬åˆ‡å‰²ä¸ºå¾ˆå¤šå°ä»½ï¼Œç„¶ååˆ†åˆ«åŠ å¯†ï¼Œå°†æ¯ä¸€æ®µè½¬æ¢ä¸º m åå†ä¼ è¾“ï¼›</p>
<p>åŠ å¯†å…¬å¼ï¼Œ</p>
<p>ğ‘â‰¡ğ‘šğ‘’(modğ‘)câ‰¡me(modN)</p>
<p>å°† m è½¬æ¢ä¸ºåŠ å¯†æ•°å€¼<code>c</code>ï¼Œç„¶å Bob å°†<code>c</code>ä¼ è¾“ç»™ Aliceï¼›é‚£ä¹ˆ<code>c</code>æ˜¯å¦‚ä½•è®¡ç®—å¾—åˆ°çš„ï¼Ÿå…¶å®è¿™ä¸ªæ±‚<code>c</code>çš„è¿‡ç¨‹éå¸¸çš„ç®€å•ï¼Œç›´æ¥æ˜¯</p>
<p>ğ‘=ğ‘šğ‘’%ğ‘c=me%N</p>
<p>æ¨å¯¼è¿‡ç¨‹ï¼Œğ‘¢=ğ‘šğ‘’%ğ‘u=me%Nï¼Œå› ä¸º ğ‘¢&lt;ğ‘u&lt;N å¯¼å‡º ğ‘¢=ğ‘¢%ğ‘u=u%N å¯¼å‡º ğ‘=ğ‘¢c=u å¯¼å‡º <strong>ä½™æ•° u</strong> æ—¢æ˜¯<code>c</code></p>
<p><a
  href="https://l2x.gitbooks.io/understanding-cryptography/docs/chapter-3/rsa.html"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>https://l2x.gitbooks.io/understanding-cryptography/docs/chapter-3/rsa.html</a></p>
<h2 id="è§£å¯†è¿‡ç¨‹">è§£å¯†è¿‡ç¨‹</h2>
<p>Alice æ‹¿åˆ° Bob çš„åŠ å¯†ä¿¡æ¯<code>c</code>ä»¥åï¼Œå¥¹ä½¿ç”¨ä¸‹é¢çš„å…¬å¼æ¥å°†<code>c</code>è§£å¯†å¾—åˆ° mï¼š</p>
<p>ğ‘ğ‘‘â‰¡ğ‘š(modğ‘)cdâ‰¡m(modN)</p>
<p>åŒ<a
  href="https://www.shangyang.me/2017/05/19/encrypt-rsa-math/#%e5%8a%a0%e5%af%86%e8%bf%87%e7%a8%8b"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>åŠ å¯†è¿‡ç¨‹</a>æ±‚<code>c</code>ä¸€æ ·ï¼Œè¿™é‡Œï¼Œå¾—å‡º</p>
<p>ğ‘š=ğ‘ğ‘‘%ğ‘m=cd%N</p>
<p>è¿™é‡Œçš„å…³é”®é—®é¢˜æ˜¯ï¼Œå¦‚ä½•å¾—åˆ°çš„è§£å¯†æ–¹ç¨‹å¼ ğ‘ğ‘‘â‰¡ğ‘š(modğ‘)cdâ‰¡m(modN)ï¼Ÿ</p>
<h3 id="å…¬å¼æ¨å¯¼">å…¬å¼æ¨å¯¼</h3>
<p>ç”±åŠ å¯†å…¬å¼ï¼Œ</p>
<p>ğ‘â‰¡ğ‘šğ‘’(modğ‘)câ‰¡me(modN)</p>
<p>é€šè¿‡<a
  href="https://zh.wikipedia.org/wiki/%e5%90%8c%e9%a4%98"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>åŒä½™</a>çš„åŸºæœ¬è¿ç®—è§„åˆ™
</p>
<p>é‚£ä¹ˆå¯ä»¥å¾—å‡º</p>
<p>ğ‘ğ‘‘â‰¡ğ‘šğ‘’ğ‘‘(modğ‘)cdâ‰¡med(modN)</p>
<p>ä¸‹é¢ç›¸å…³éƒ¨åˆ†æ‘˜è¦è‡ª wikipediaï¼Œç¨æœ‰ä¸åŒçš„æ˜¯ï¼Œä¸Šè¿°è¿‡ç¨‹çš„åŸå§‹æ¶ˆæ¯æ˜¯ mï¼Œä¸‹é¢è¿‡ç¨‹çš„åŸå§‹æ¶ˆæ¯æ˜¯ n</p>
<p></p>
<p>ä¸Šé¢æ¨è®ºçš„é‡ç‚¹åœ¨äºï¼Œğ‘›(ğ‘›Ï†(ğ‘))â„â‰¡ğ‘›(1)â„(modğ‘)n(nÏ†(N))hâ‰¡n(1)h(modN) æ˜¯æ€ä¹ˆå¯¼å‡ºæ¥çš„ï¼Ÿå‚è€ƒ<a
  href="https://zh.wikipedia.org/wiki/%e6%ac%a7%e6%8b%89%e5%87%bd%e6%95%b0"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>æ¬§æ‹‰å®šç†</a>
</p>
<p>æ‰€ä»¥ï¼Œæœ‰ ğ‘›Ï†(ğ‘)â‰¡1(modğ‘)nÏ†(N)â‰¡1(modN)ï¼Œéš¾é“æ˜¯å°† ğ‘›Ï†(ğ‘)â‰¡1(modğ‘)nÏ†(N)â‰¡1(modN) ç›´æ¥ä»£å…¥ ğ‘›(ğ‘›Ï†(ğ‘))â„n(nÏ†(N))hï¼Œæ‰€ä»¥å¾—åˆ° ğ‘›(ğ‘›Ï†(ğ‘))â„â‰¡ğ‘›(1)â„(modğ‘)n(nÏ†(N))hâ‰¡n(1)h(modN)ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œæƒ³ä¸åˆ°åŸå› äº†â€¦ ä½†æ˜¯åœ¨<a
  href="https://zh.wikipedia.org/wiki/%e5%90%8c%e9%a4%98"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>åŒä½™</a>ä¸­æ²¡æ‰¾åˆ°è¿™ç§å‚æ•°ä»£å…¥æ³•.. æ‰€ä»¥ä¼šæœ‰äº›æ€€ç–‘ï¼›å¥½å§ï¼Œå§‘ä¸”ç»™è‡ªå·±æœ‰ä¸€ä¸ªæ‚¬å¿µå§..</p>
<p>æœ€ç»ˆï¼Œç»è¿‡ä¸Šè¿°çš„è®ºè¯ï¼Œæˆ‘ä»¬å¾—åˆ°äº†è§£å¯†è¦ç”¨åˆ°çš„å…¬å¼ï¼Œ</p>
<p>ğ‘ğ‘‘â‰¡ğ‘š(modğ‘)cdâ‰¡m(modN)</p>
<p><a
  href="https://l2x.gitbooks.io/understanding-cryptography/docs/chapter-3/rsa.html"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>https://l2x.gitbooks.io/understanding-cryptography/docs/chapter-3/rsa.html</a></p>
<h1 id="ä¾‹è¯">ä¾‹è¯</h1>
<p>ä¸Šé¢çš„åŸç†æ€§çš„ä¸œè¥¿è¯´äº†ä¸€å †ï¼Œè¿™é‡Œé€šè¿‡ä¸€ä¸ªå®é™…çš„ä¾‹å­æ¥çœ‹çœ‹ RSA æ˜¯å¦‚ä½•åšåˆ°åŠ å¯†è§£å¯†çš„ï¼Ÿ</p>
<p>Bob è¯•å›¾é€šè¿‡ RSA çš„åŠ å¯†çš„æ–¹å¼å‘ Alice å‘é€æ•°æ®ï¼Œ</p>
<h2 id="ç”Ÿæˆå¯†é’¥">ç”Ÿæˆå¯†é’¥</h2>
<p>å¦‚ä¸‹æ­¥éª¤æè¿°äº† Alice å¦‚ä½•é€šè¿‡ RSA ç®—æ³•ç”Ÿæˆè‡ªå·±çš„å¯†é’¥(å…¬é’¥å’Œå…¬é’¥)ï¼›</p>
<ol>
<li>
<p>æ¨¡ Nï¼ŒAlice é€‰æ‹©ä¸¤ä¸ªè´¨æ•° 5ã€13ï¼Œå¾—åˆ°</p>
<p>ğ‘=5Ã—13=65N=5Ã—13=65</p>
<p>å¤‡æ³¨ï¼Œè¿™é‡Œé€‰æ‹©çš„æ—¶å€™ä¸€å®šè¦æ³¨æ„ï¼Œä¹‹å‰å°±æ˜¯å› ä¸ºé”™é€‰äº†ä¸æ˜¯è´¨æ•°çš„ 9ï¼Œå¯¼è‡´å…¥å‘å¾ˆä¹…æ²¡çˆ¬å‡ºæ¥ï¼›</p>
</li>
<li>
<p>æ¬§æ‹‰å‡½æ•°å€¼ r</p>
<p>ğ‘Ÿ=Ï†(ğ‘)=Ï†(5)Ï†(13)=(5âˆ’1)(13âˆ’1)=48r=Ï†(N)=Ï†(5)Ï†(13)=(5âˆ’1)(13âˆ’1)=48</p>
</li>
<li>
<p>éšæœºæ•° eï¼Œéšæœºé€‰æ‹© e ä¸” (1&lt;ğ‘’&lt;ğ‘Ÿ)(1&lt;e&lt;r)ï¼Œe å¿…é¡»ä¸ r äº’è´¨ï¼Œè¿™é‡Œï¼Œæˆ‘éšæœºé€‰æ‹©ä¸€ä¸ª</p>
<p>ğ‘’=5e=5</p>
</li>
<li>
<p>æ±‚ e å…³äº r çš„æ¨¡åå…ƒç´  dï¼Œæœ‰å…¬å¼ ğ‘’ğ‘‘â‰¡1(modğ‘Ÿ)edâ‰¡1(modr) ç­‰ä»·äºæ±‚è§£</p>
<p>5Ã—ğ‘‘â‰¡1(mod48)5Ã—dâ‰¡1(mod48)</p>
<p>æŒ‰ç…§</p>
<p>å¦‚ä½•è®¡ç®—å¾—åˆ° d</p>
<p>ä¸­æ‰€ä»‹ç»çš„æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼Œå¾—åˆ°å…¬å¼</p>
<p>5Ã—ğ‘‘+48ğ‘˜=15Ã—d+48k=1</p>
<p>ï¼ŒåŒæ ·ä¹Ÿå¯ä»¥æŒ‰ç…§å…¬å¼</p>
<p>5Ã—ğ‘‘âˆ’48ğ‘˜=15Ã—dâˆ’48k=1</p>
<p>æ¥è¿›è¡Œæ±‚è§£ï¼Œä¸¤è€…ä¹‹é—´çš„ç›¸äº’åŒºåˆ«åœ¨</p>
<p>å¦‚ä½•è®¡ç®—å¾—åˆ° d</p>
<p>æœ‰è¯¦ç»†çš„æè¿°ï¼›</p>
<p>ä¸ºäº†è®¡ç®—å‡º dï¼Œæˆ‘æŒ‰ç…§æ±‚è§£çš„å…¬å¼ 5Ã—ğ‘‘âˆ’48ğ‘˜=15Ã—dâˆ’48k=1 å†™äº†ä¸€æ®µç¨‹åºæ¥æ±‚è§£ dï¼Œä» k = -20 å¼€å§‹ï¼Œä¸æ–­çš„è¯•æ¢å‡º d çš„å–å€¼ï¼Œ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">int k = -20;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">int e = 5;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">int r = 48;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">while( true ){
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   int d_mod = (r*k + 1)%e;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   if( d_mod == 0 ){
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      int d = ( (r*k + 1)/e );
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      System.out.println(&#34;=====&gt; k=&#34;+k+&#34;; d=&#34; + d );
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      //break;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   }
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   //System.out.println(&#34;tried k=&#34;+k);       
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   k ++;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   if( k &gt; 10 ) break;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ±‚å¾—å–å€¼èŒƒå›´å¦‚ä¸‹ï¼Œ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">=====&gt; k=-17; d=-163
</span></span><span class="line"><span class="cl">=====&gt; k=-12; d=-115
</span></span><span class="line"><span class="cl">=====&gt; k=-7; d=-67
</span></span><span class="line"><span class="cl">=====&gt; k=-2; d=-19
</span></span><span class="line"><span class="cl">=====&gt; k=3; d=29
</span></span><span class="line"><span class="cl">=====&gt; k=8; d=77
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™é‡Œè¦æ±‚å–æœ€å°æ­£æ•´æ•°çš„æ¨¡åå…ƒç´ ï¼Œæ‰€ä»¥å–å¾— d = 29ï¼Œk = 3ï¼›å› ä¸ºè¿™é‡Œæ˜¯æŒ‰ç…§ğ‘’ğ‘‘âˆ’ğ‘˜ğ‘Ÿ=1edâˆ’kr=1çš„é€»è¾‘è¿›è¡Œæ±‚è§£ï¼Œæ‰€ä»¥ï¼Œè¿™é‡Œ k çš„å€¼ä¸ºæ­£æ•´æ•° 3ï¼Œå¦‚æœæ˜¯æŒ‰ç…§æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•çš„æ–¹å¼ğ‘’ğ‘‘+ğ‘˜ğ‘Ÿ=1ed+kr=1æ±‚è§£ï¼Œé‚£ä¹ˆ k = -3</p>
</li>
</ol>
<p>Okï¼Œè‡³æ­¤ï¼Œé‡è¦çš„ 6 ä¸ªå…ƒç´ å·²ç»é›†åˆå®Œæ¯•ï¼Œä»–ä»¬åˆ†åˆ«æ˜¯ ğ‘=5,ğ‘=13,ğ‘=65,ğ‘Ÿ=48,ğ‘’=5,ğ‘‘=29p=5,q=13,N=65,r=48,e=5,d=29</p>
<p>äºæ˜¯ï¼Œå¾—åˆ°<code>å…¬é’¥</code>ä¸º 65,565,5ï¼›å¾—åˆ°<code>ç§é’¥</code>ä¸º 65,2965,29ï¼›æœ€å Alice é€šè¿‡æŸç§æ–¹å¼å°†<code>å…¬é’¥</code>å‘é€ç»™ Bobï¼›</p>
<h2 id="ä¼ è¾“åŠ å¯†ä¿¡æ¯">ä¼ è¾“åŠ å¯†ä¿¡æ¯</h2>
<p>Bob é€šè¿‡ RSA åŠ å¯†æ–¹å¼å‘ Alice å‘é€å­—ç¬¦æ„Ÿå¹å· !ï¼Œ</p>
<p>é¦–å…ˆï¼Œå°†å­—ç¬¦ ! è½¬æ¢æˆå…¶å¯¹åº”çš„ ASCII ç å€¼ï¼Œå¯¹åº”ä¸º 41ï¼Œè®°ä¸º ğ‘šm</p>
<p>å†æ¬¡ï¼Œé€šè¿‡<a
  href="https://www.shangyang.me/2017/05/19/encrypt-rsa-math/#%e5%8a%a0%e5%af%86%e8%bf%87%e7%a8%8b"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>åŠ å¯†å…¬å¼</a> ğ‘=ğ‘šğ‘’%ğ‘c=me%N æ—¢ ğ‘=415%65=6c=415%65=6ï¼Œç”±æ­¤å¾—åˆ° m çš„åŠ å¯†åçš„æ•°å­—ä¸º ğ‘=6c=6ï¼›æ³¨æ„ï¼Œè¿‡ç¨‹ä¸­ä½¿ç”¨åˆ°äº† (N,e)ï¼›å¤‡æ³¨ï¼Œè¿™é‡Œå¯ç”¨ç¼–ç¨‹çš„æ–¹å¼æ±‚è§£ï¼Œ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">System.out.println( Math.pow(41,5) % 65);
</span></span></code></pre></td></tr></table>
</div>
</div><p>æœ€åï¼ŒBob å°†åŠ å¯†æ•°å­— c = 6 å‘é€ç»™äº† Aliceï¼›</p>
<h2 id="è§£å¯†åŠ å¯†ä¿¡æ¯">è§£å¯†åŠ å¯†ä¿¡æ¯</h2>
<p>Alice æ¥æ”¶åˆ°äº† Bob å‘é€çš„åŠ å¯†æ•°å­— c (6)ï¼Œä¹‹åä½¿ç”¨ç§é’¥(65, 29)è¿›è¡Œè§£å¯†ï¼Œ</p>
<p>é¦–å…ˆï¼Œæ ¹æ®<a
  href="https://www.shangyang.me/2017/05/19/encrypt-rsa-math/#%e8%a7%a3%e5%af%86%e8%bf%87%e7%a8%8b"
  
  
    
    
    target="_blank"
  
  
    rel="external nofollow noopener noreferrer"
  
  
  
>è§£å¯†å…¬å¼</a> ğ‘š=ğ‘ğ‘‘%ğ‘m=cd%N æ—¢ ğ‘š=629%65m=629%65ï¼Œè§£å‡º ğ‘š=41m=41ï¼Œæ­£å¥½å¾—åˆ° Bob æœªåŠ å¯†ä¹‹å‰çš„å­—ç¬¦ ! çš„ ASCII ç ï¼Œå› æ­¤ï¼Œè¿™é‡ŒæˆåŠŸå°†å…¶è§£å¯†ï¼›å¤‡æ³¨ï¼Œè¿™é‡Œå¯ä»¥é€šè¿‡ç¼–ç¨‹çš„æ–¹å¼æ±‚è§£ï¼Œ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">System.out.println( Math.pow(6,29) % 65);
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="ä¸ºä»€ä¹ˆ-rsa-å¾ˆéš¾è¢«ç ´è§£">ä¸ºä»€ä¹ˆ RSA å¾ˆéš¾è¢«ç ´è§£</h1>
<p>å› ä¸ºè¦é€šè¿‡å¯†æ–‡ c åæ¨å¾—åˆ°æ˜æ–‡ mï¼Œæ ¹æ®è§£å¯†æ–¹ç¨‹å¼ ğ‘š=ğ‘ğ‘‘%ğ‘m=cd%N æˆ‘ä»¬çŸ¥é“ï¼Œ</p>
<ol>
<li>åœ¨å…¬é’¥å…¬å¼€çš„å‰æä¸‹ï¼Œæ—¢æ˜¯çŸ¥é“ Nã€e çš„å‰æä¸‹ï¼Œå¿…é¡»è¦çŸ¥é“ dï¼Œæ‰èƒ½è§£å¯†å‡ºæ˜æ–‡ mï¼›</li>
<li>è€Œè¦çŸ¥é“ dï¼Œé‚£ä¹ˆå°±å¿…é¡»å¯¹ç´ æ•°æ¨¡ N è¿›è¡Œ<code>å› å¼åˆ†è§£</code>ï¼Œå¾—åˆ° p å’Œ qï¼Œ</li>
<li>å†é€šè¿‡æ¬§æ‹‰å‡½æ•°çš„è®¡ç®— ğœ‘(ğ‘ğ‘)=ğœ‘(ğ‘)ğœ‘(ğ‘)ğœ‘(pq)=ğœ‘(p)ğœ‘(q) å¾—åˆ° rï¼Œ</li>
<li>æœ€åé€šè¿‡ r å’Œ eï¼Œæ±‚å‡º e äº r çš„æ¨¡åå…ƒç´ çš„è®¡ç®—æ‰èƒ½æœ€ç»ˆæ¨å¯¼å‡º dï¼›</li>
</ol>
<p>è€Œä¸€åˆ‡çš„ä¸€åˆ‡çš„å‰æéƒ½å¿…é¡»å¯¹ N è¿›è¡Œå› å¼åˆ†è§£ï¼Œè€Œå¦‚æœ N æ˜¯ä¸€ä¸ªéå¸¸å¤§çš„ç´ æ•°ï¼Œå› å¼åˆ†è§£å‡ ä¹æ˜¯ä¸å¯èƒ½çš„ï¼›è¿™æ ·ï¼Œä¹Ÿå°±ä¿è¯äº† RSA çš„åŠ å¯†æŠ€æœ¯çš„å¯é æ€§ï¼›</p>
<h1 id="ä½¿ç”¨æ³¨æ„">ä½¿ç”¨æ³¨æ„</h1>
<p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨åŠ å¯†å’Œè§£å¯†è¿‡ç¨‹ä¸­éƒ½ä¼šæ¶‰åŠåˆ°<code>ç‰¹å¤§æŒ‡æ•°çº§åˆ«</code>çš„è¿ç®—ï¼Œæ‰€ä»¥ï¼Œè¿ç®—è¿‡ç¨‹æ˜¯éå¸¸è€—è´¹è®¡ç®—æœºèµ„æºå’Œæ—¶é—´çš„ï¼›æ‰€ä»¥ä¸€èˆ¬çš„é€šè®¯ä¸­ä¸ç›´æ¥ä½¿ç”¨ RSA æ¥è¿›è¡ŒåŠ å¯†é€šè®¯ï¼›è€Œæ˜¯é€šè¿‡å…¬é’¥åŠ å¯†ä¸€æ®µ DES å¯†é’¥æ¥è¿›è¡Œé€šè®¯ï¼Œæ¯”å¦‚ Bob ä½¿ç”¨ Alice çš„<code>å…¬é’¥</code>ç”Ÿæˆä¸€ä¸ª DES å¯¹ç§°å¯†é’¥ï¼Œç„¶åå‘é€ç»™ Aliceï¼Œç„¶å Alice å†ä½¿ç”¨<code>å¯†é’¥</code>è§£å¯†å¾—åˆ° DES å¯†é’¥ï¼Œè¿™æ ·åŒå‘æœ€åå®é™…ä¸Šæ˜¯é€šè¿‡ DES å¯†é’¥åœ¨è¿›è¡Œé€šè®¯ï¼›</p>
]]></description>
</item></channel>
</rss>
