# RSA(å››) ç­¾å Signature


# å‰è¨€

ç”±[RSA(ä¸€) èƒŒåŽçš„æ•°å­¦åŽŸç†](https://www.shangyang.me/2017/05/19/encrypt-rsa-math/)å¯çŸ¥ï¼ŒRSA æ—¢å…¬é’¥åŠ å¯†æŠ€æœ¯ä¸»è¦æ˜¯é€šè¿‡ç§é’¥åŠ å¯†ä¿¡æ¯ï¼Œç„¶åŽç”±å…¬é’¥æ¥è§£å¯†ä¿¡æ¯ï¼›ä½†æ˜¯ï¼Œä»Ž RSA çš„æ•°å­¦åŽŸç†ä¸­æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œå…¶å®žç§é’¥åŠ å¯†ä¿¡æ¯ï¼Œç„¶åŽç”¨å…¬é’¥æ¥è§£å¯†ä¹Ÿæ˜¯å¯ä»¥çš„ï¼›è€Œå› ä¸ºå…¬é’¥æ˜¯å…¬å¼€çš„ï¼Œç§é’¥åŠ å¯†çš„ä¸œè¥¿è°éƒ½å¯ä»¥è¿›è¡Œè§£å¯†ï¼Œé‚£è¿™æ ·åšæœ‰ä»€ä¹ˆæ„ä¹‰å‘¢ï¼Ÿæœ¬ç« èŠ‚å°±æ˜¯æ¥æŽ¢è®¨è¿™æ ·åšçš„æ„ä¹‰ä½•åœ¨ï¼Ÿä¸€å¥è¯æ¦‚æ‹¬ï¼Œå®ƒçš„æ„ä¹‰å°±åœ¨äºŽç­¾å( sign )ï¼›

å¤‡æ³¨ï¼Œæœ¬æ–‡æ˜¯ä½œè€…çš„åŽŸåˆ›ä½œå“ï¼Œè½¬è½½è¯·æ³¨æ˜Žå‡ºå¤„ã€‚

> è½¬è½½è‡³`https://www.shangyang.me/2017/05/24/encrypt-rsa-signature/`

# åœºæ™¯

æ¥çœ‹è¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼ŒBob ç»™è‚¡ç¥¨ç»çºªäºº Alice å‘é€äº†ä¸€å°é‚®ä»¶ï¼Œè®© Alice å¸®ä»–å¤§é‡è´­ä¹°æŸæ”¯è‚¡ç¥¨ï¼›å¯æ˜¯åˆšä¹°ä¸ä¹…ï¼Œè‚¡ç¥¨å°±å¤§è·Œï¼ŒäºŽæ˜¯ Bob è½¬è€Œå¦è®¤å‘è¿‡é‚£å°é‚®ä»¶ï¼Œå£°ç§°é‚£å°é‚®ä»¶æ˜¯ä¼ªé€ çš„ï¼›é‚£ä¹ˆä½œä¸ºæ³•å®˜çš„ä½ ï¼Œå¦‚ä½•æ¥éªŒè¯ä¹‹å‰å‘é€çš„é‚£å°é‚®ä»¶åˆ°åº•æ˜¯ä¸æ˜¯ Bob å‘é€çš„å‘¢ï¼Ÿ

è¦è§£å†³ä¸Šè¿°åœºæ™¯çš„é—®é¢˜ï¼Œå°±éœ€è¦ä½¿ç”¨åˆ° RSA ç­¾åæŠ€æœ¯äº†ï¼›

# ç­¾å Signature

ä¸ºä¿è¯é‚®ä»¶æ˜¯ Bob å‘é€çš„ï¼Œåœ¨é‚®ä»¶æ”¶å‘åè®®ä¸Šåšäº†å¦‚ä¸‹çš„æ“ä½œçº¦å®šï¼Œ

1. é¦–å…ˆåŒæ–¹é€šè¿‡é‚®ä»¶åè®®çº¦å®šå¥½ç­¾åçš„ç®—æ³•ï¼Œæ¯”å¦‚éƒ½æ˜¯ç”¨ MD5 æˆ–è€…æ˜¯å…¶å®ƒç­¾åç®—æ³•ã€‚
2. Bob åœ¨å‘é€é‚®ä»¶çš„åŒæ—¶ï¼Œé‚®ä»¶ç³»ç»Ÿå°†åšå¦‚ä¸‹çš„æ“ä½œ
   * é€šè¿‡ç­¾åç®—æ³• MD5 å°†é‚®ä»¶å†…å®¹`c`è¿›è¡Œ *hash*ï¼Œå¾—åˆ°é‚®ä»¶å†…å®¹çš„ç­¾å(Sign)ï¼Œè®°ä¸º ð‘†1ï¼›
   * é€šè¿‡ Bob çš„ç§é’¥ ð‘ƒ å¯¹ ð‘†1 è¿›è¡ŒåŠ å¯†ï¼Œå¾—åˆ°åŠ å¯†åŽé‚®ä»¶å†…å®¹çš„ç­¾å(Encrypted Sign)ï¼Œè®°ä¸º ð‘†1ð‘’ï¼›
   * æœ€åŽï¼ŒBob é€šè¿‡é‚®ç®±ç³»ç»Ÿå°†ç­¾å ð‘†1ð‘’S1eï¼Œé‚®ä»¶å†…å®¹`c`ï¼Œä»¥åŠ Bob çš„å…¬é’¥ ð‘ƒ ä¸‰éƒ¨åˆ†å†…å®¹å‘é€ç»™ Aliceï¼›
     å¦‚ä½•ä¿è¯å…¬é’¥çš„å®‰å…¨æ€§å’Œå¯é æ€§ï¼Œä¸åœ¨æœ¬æ–‡æ¶‰åŠï¼›
3. Alice æ”¶åˆ° Bob çš„é‚®ä»¶ä»¥åŽï¼Œé‚®ç®±ç³»ç»Ÿä¼šåšå¦‚ä¸‹çš„æ“ä½œ
   * ä½¿ç”¨ Bob çš„å…¬é’¥å¯¹ ð‘†1ð‘’ è¿›è¡Œè§£å¯†ï¼Œå¾—åˆ° ð‘†1ï¼›
   * ä½¿ç”¨åŒæ–¹äº‹å…ˆçº¦å®šå¥½çš„ç­¾åç®—æ³• MD5 å¯¹`c`è¿›è¡Œ *hash* å¾—åˆ°ç­¾å ð‘†2ï¼›
   * æ¯”è¾ƒç­¾å ð‘†1 å’Œç­¾å ð‘†2 æ˜¯å¦ç›¸ç­‰
     å¦‚æžœç›¸ç­‰ï¼Œåˆ™è¡¨ç¤ºé‚®ä»¶å†…å®¹æ²¡æœ‰è¢«ç¯¡æ”¹ï¼›
     å¦‚æžœä¸ç›¸ç­‰ï¼Œåˆ™è¡¨ç¤ºé‚®ä»¶å†…å®¹è¢«ä»–äººç¯¡æ”¹ï¼›

ä¸è¿‡ï¼Œè¦ä¿è¯ä¿¡æ¯çš„ç¡®æ²¡æœ‰è¢«ç¯¡æ”¹ï¼Œè¿˜æœ‰ä¸€æ¡åŸºæœ¬åŽŸåˆ™ï¼Œå°±æ˜¯ Bob çš„å…¬é’¥ ð‘ƒ ä¸èƒ½è¢«ç¯¡æ”¹ï¼Œå¦‚æžœå…¬é’¥ ð‘ƒ åœ¨ Bob å‘é€ç»™ Alice çš„è¿‡ç¨‹è¢«äººç¯¡æ”¹äº†ï¼Œé‚£ä¹ˆ Attacker å°±å¯ä»¥è‡ªå·±æœæ’°ä¸€å°é‚®ä»¶ï¼Œå¹¶é€šè¿‡è‡ªå·±çš„ç§é’¥ç­¾åé‚®ä»¶ï¼Œå¹¶å°†è‡ªå·±ç¯¡æ”¹åŽçš„å…¬é’¥ ð‘ƒð‘Pc ä¸€åŒå‘é€ç»™ Aliceï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™ï¼ŒAlice æ˜¯æ²¡æœ‰åŠžæ³•ç¡®è®¤é‚®ä»¶æ˜¯å¦æ˜¯è¢«ç¯¡æ”¹è¿‡çš„ï¼›æ‰€ä»¥ï¼Œç”¨ RSA ç­¾åçš„æ–¹å¼æ¥ä¿è¯ä¿¡æ¯æ²¡æœ‰è¢«ç¯¡æ”¹è¿‡ï¼Œä¸€ä¸ªåŸºæœ¬çš„å‰æå°±æ˜¯ Bob çš„å…¬é’¥ ð‘ƒP ä¸èƒ½è¢«ç¬¬ä¸‰æ–¹ç¯¡æ”¹ï¼›è€Œè¦ä¿è¯å…¬é’¥ä¸èƒ½è¢«ç¬¬ä¸‰æ–¹ç¯¡æ”¹ï¼Œå°±éœ€è¦ PKI (Public Key Infrasture) å…¬é’¥åŸºç¡€è®¾æ–½æ¥ä¿è¯å…¬é’¥çš„åˆæ³•æ€§ï¼Œæ¶‰åŠåˆ° CAï¼ŒRoot Certificate æ ¹è¯ä¹¦ç›¸å…³çŸ¥è¯†ï¼›è¿™éƒ¨åˆ†çŸ¥è¯†ä¸æ‰“ç®—åœ¨æœ¬æ–‡è¿›è¡Œæè¿°ï¼›ç›¸å…³å†…å®¹å‚è€ƒ [RSA(äº”) PKI (Public Key Infrastructure) å…¬é’¥åŸºç¡€è®¾æ–½](https://www.shangyang.me/2017/05/25/encrypt-rsa-pki/)ï¼›

å¤‡æ³¨ï¼šRoot Certificate æ ¹è¯ä¹¦å°±æ˜¯ CA è¯ä¹¦è®¤è¯æœºæž„ç”¨æ¥ç­¾åéªŒè¯å…¬é’¥ ð‘ƒ çš„ï¼›

# æ€»ç»“

[ç­¾å sign](https://www.shangyang.me/2017/05/24/encrypt-rsa-signature/#ç­¾å-sign) å°èŠ‚ä¸­è¯¦ç»†çš„æè¿°äº† RSA é€šè¿‡ç§é’¥ç­¾åçš„è¿‡ç¨‹å’Œä½œç”¨ï¼›ä½†æ˜¯ä¹ŸçŸ¥é“ï¼Œç­¾åè‹¥è¦èƒ½èµ·ä½œç”¨ï¼Œå¿…é¡»å€ŸåŠ© PKI å…¬é’¥åŸºç¡€è®¾æ–½æ¥ä¿è¯å…¬é’¥çš„åˆæ³•æ€§ï¼›æ‰€ä»¥ï¼Œå¯è§ï¼ŒPKI å¯¹äºŽåŸºäºŽ RSA çš„åŠ å¯†é€šè®¯åè®®èµ·åˆ°è‡³å…³é‡è¦çš„ä½œç”¨ï¼Œæ²¡æœ‰å®ƒï¼Œä¸€åˆ‡åŸºäºŽ RSA çš„åŠ å¯†é€šè®¯ç†è®ºéƒ½ç™½æ­ï¼›åŽç»­ç« èŠ‚ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹ PKI æ˜¯ä»€ä¹ˆä¸œè¥¿ï¼›

---

> ä½œè€…: RoninZc  
> URL: https://ronin-zc.com/rsa%E5%9B%9B-%E7%AD%BE%E5%90%8D-signature/  

